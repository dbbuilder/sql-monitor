{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": null,
  "links": [],
  "liveNow": true,
  "panels": [
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 100,
      "panels": [],
      "title": "\ud83d\udcca Counter Metrics (Performance Indicators)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "SQL Server CPU utilization percentage",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 70
              },
              {
                "color": "red",
                "value": 90
              }
            ]
          },
          "unit": "percent",
          "min": 0,
          "max": 100
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 8,
        "x": 0,
        "y": 1
      },
      "id": 1,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT\n  CollectionTime AS time,\n  MetricValue AS value,\n  s.ServerName + ' - ' + MetricName AS metric\nFROM dbo.PerformanceMetrics pm\nINNER JOIN dbo.Servers s ON pm.ServerID = s.ServerID\nWHERE pm.MetricCategory = 'Performance'\n  AND pm.MetricName LIKE '%CPU%'\n  AND pm.ServerID = $ServerID\n  AND pm.CollectionTime >= $__timeFrom()\n  AND pm.CollectionTime <= $__timeTo()\nORDER BY pm.CollectionTime",
          "refId": "A"
        }
      ],
      "title": "CPU Utilization (%)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Memory usage and buffer cache metrics",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 80
              },
              {
                "color": "red",
                "value": 95
              }
            ]
          },
          "unit": "percent",
          "min": 0,
          "max": 100
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 8,
        "x": 8,
        "y": 1
      },
      "id": 2,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT\n  CollectionTime AS time,\n  MetricValue AS value,\n  MetricName AS metric\nFROM dbo.PerformanceMetrics pm\nINNER JOIN dbo.Servers s ON pm.ServerID = s.ServerID\nWHERE pm.MetricCategory = 'Memory'\n  AND pm.MetricName IN ('BufferCacheHitRatio', 'MemoryUtilization')\n  AND pm.ServerID = $ServerID\n  AND pm.CollectionTime >= $__timeFrom()\n  AND pm.CollectionTime <= $__timeTo()\nORDER BY pm.CollectionTime",
          "refId": "A"
        }
      ],
      "title": "Memory Utilization (%)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Active database connections",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 8,
        "x": 16,
        "y": 1
      },
      "id": 3,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT\n  CollectionTime AS time,\n  MetricValue AS value,\n  MetricName AS metric\nFROM dbo.PerformanceMetrics pm\nWHERE pm.MetricCategory = 'Connections'\n  AND pm.MetricName IN ('Total', 'Active', 'Sleeping')\n  AND pm.ServerID = $ServerID\n  AND pm.CollectionTime >= $__timeFrom()\n  AND pm.CollectionTime <= $__timeTo()\nORDER BY pm.CollectionTime",
          "refId": "A"
        }
      ],
      "title": "Database Connections",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Disk read and write IOPS",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "iops"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 8,
        "x": 0,
        "y": 7
      },
      "id": 4,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "WITH MetricsWithPrevious AS (\n  SELECT\n    CollectionTime,\n    MetricName,\n    MetricValue,\n    LAG(MetricValue) OVER (PARTITION BY MetricName ORDER BY CollectionTime) AS PrevValue,\n    LAG(CollectionTime) OVER (PARTITION BY MetricName ORDER BY CollectionTime) AS PrevTime\n  FROM dbo.PerformanceMetrics\n  WHERE ServerID = $ServerID\n    AND MetricCategory = 'Disk'\n    AND MetricName IN ('ReadIOPS', 'WriteIOPS')\n    AND CollectionTime >= $__timeFrom()\n    AND CollectionTime <= $__timeTo()\n)\nSELECT\n  CollectionTime AS time,\n  CASE\n    WHEN PrevValue IS NOT NULL AND DATEDIFF(SECOND, PrevTime, CollectionTime) > 0\n    THEN (MetricValue - PrevValue) / DATEDIFF(SECOND, PrevTime, CollectionTime)\n    ELSE 0\n  END AS value,\n  CASE MetricName\n    WHEN 'ReadIOPS' THEN 'Read IOPS'\n    WHEN 'WriteIOPS' THEN 'Write IOPS'\n  END AS metric\nFROM MetricsWithPrevious\nWHERE PrevValue IS NOT NULL\nORDER BY CollectionTime",
          "refId": "A"
        }
      ],
      "title": "Read/Write IOPS",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Disk read and write throughput",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "MBs"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 8,
        "x": 8,
        "y": 7
      },
      "id": 5,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "WITH MetricsWithPrevious AS (\n  SELECT\n    CollectionTime,\n    MetricName,\n    MetricValue,\n    LAG(MetricValue) OVER (PARTITION BY MetricName ORDER BY CollectionTime) AS PrevValue,\n    LAG(CollectionTime) OVER (PARTITION BY MetricName ORDER BY CollectionTime) AS PrevTime\n  FROM dbo.PerformanceMetrics\n  WHERE ServerID = $ServerID\n    AND MetricCategory = 'Disk'\n    AND MetricName IN ('ReadMB', 'WriteMB')\n    AND CollectionTime >= $__timeFrom()\n    AND CollectionTime <= $__timeTo()\n)\nSELECT\n  CollectionTime AS time,\n  CASE\n    WHEN PrevValue IS NOT NULL AND DATEDIFF(SECOND, PrevTime, CollectionTime) > 0\n    THEN (MetricValue - PrevValue) / DATEDIFF(SECOND, PrevTime, CollectionTime)\n    ELSE 0\n  END AS value,\n  CASE MetricName\n    WHEN 'ReadMB' THEN 'Read MB/s'\n    WHEN 'WriteMB' THEN 'Write MB/s'\n  END AS metric\nFROM MetricsWithPrevious\nWHERE PrevValue IS NOT NULL\nORDER BY CollectionTime",
          "refId": "A"
        }
      ],
      "title": "Read/Write Throughput (MB/s)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Disk read and write latency",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "none",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "line"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 15
              },
              {
                "color": "red",
                "value": 25
              }
            ]
          },
          "unit": "ms"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 8,
        "x": 16,
        "y": 7
      },
      "id": 6,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "none"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT\n  CollectionTime AS time,\n  MetricValue AS value,\n  CASE MetricName\n    WHEN 'AvgReadLatencyMs' THEN 'Read Latency'\n    WHEN 'AvgWriteLatencyMs' THEN 'Write Latency'\n  END AS metric\nFROM dbo.PerformanceMetrics pm\nWHERE pm.MetricCategory = 'Disk'\n  AND pm.MetricName IN ('AvgReadLatencyMs', 'AvgWriteLatencyMs')\n  AND pm.ServerID = $ServerID\n  AND pm.CollectionTime >= $__timeFrom()\n  AND pm.CollectionTime <= $__timeTo()\nORDER BY pm.CollectionTime",
          "refId": "A"
        }
      ],
      "title": "Disk Latency (ms)",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Buffer cache hit ratio - higher is better",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "yellow",
                "value": 90
              },
              {
                "color": "green",
                "value": 95
              }
            ]
          },
          "unit": "percent",
          "min": 0,
          "max": 100
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 4,
        "x": 0,
        "y": 13
      },
      "id": 7,
      "options": {
        "orientation": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": [
            "lastNotNull"
          ],
          "fields": ""
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT TOP 1\n  CollectionTime AS time,\n  MetricValue AS value\nFROM dbo.PerformanceMetrics\nWHERE MetricCategory = 'Memory'\n  AND MetricName = 'BufferCacheHitRatio'\n  AND ServerID = $ServerID\n  AND CollectionTime >= $__timeFrom()\n  AND CollectionTime <= $__timeTo()\nORDER BY CollectionTime DESC",
          "refId": "A"
        }
      ],
      "title": "Buffer Cache Hit Ratio",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Page Life Expectancy - higher is better (>300 recommended)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": null
              },
              {
                "color": "yellow",
                "value": 300
              },
              {
                "color": "green",
                "value": 1000
              }
            ]
          },
          "unit": "s"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 4,
        "x": 4,
        "y": 13
      },
      "id": 8,
      "options": {
        "orientation": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": [
            "lastNotNull"
          ],
          "fields": ""
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT TOP 1\n  CollectionTime AS time,\n  MetricValue AS value\nFROM dbo.PerformanceMetrics\nWHERE MetricCategory = 'Memory'\n  AND MetricName = 'PageLifeExpectancy'\n  AND ServerID = $ServerID\n  AND CollectionTime >= $__timeFrom()\n  AND CollectionTime <= $__timeTo()\nORDER BY CollectionTime DESC",
          "refId": "A"
        }
      ],
      "title": "Page Life Expectancy",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Batch requests per second",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 1000
              },
              {
                "color": "red",
                "value": 5000
              }
            ]
          },
          "unit": "reqps"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 4,
        "x": 8,
        "y": 13
      },
      "id": 9,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": [
            "lastNotNull"
          ],
          "fields": ""
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT TOP 1\n  CollectionTime AS time,\n  MetricValue AS value\nFROM dbo.PerformanceMetrics\nWHERE MetricCategory = 'Performance'\n  AND MetricName = 'BatchRequestsPerSec'\n  AND ServerID = $ServerID\n  AND CollectionTime >= $__timeFrom()\n  AND CollectionTime <= $__timeTo()\nORDER BY CollectionTime DESC",
          "refId": "A"
        }
      ],
      "title": "Batch Requests/sec",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Transactions per second",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              },
              {
                "color": "yellow",
                "value": 500
              },
              {
                "color": "red",
                "value": 2000
              }
            ]
          },
          "unit": "tps"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 4,
        "x": 12,
        "y": 13
      },
      "id": 10,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "reduceOptions": {
          "values": false,
          "calcs": [
            "lastNotNull"
          ],
          "fields": ""
        },
        "textMode": "auto"
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "SELECT\n  CollectionTime AS time,\n  MetricValue AS value\nFROM dbo.PerformanceMetrics\nWHERE MetricCategory = 'Performance'\n  AND MetricName = 'Transactions'\n  AND ServerID = $ServerID\n  AND CollectionTime >= $__timeFrom()\n  AND CollectionTime <= $__timeTo()\nORDER BY CollectionTime",
          "refId": "A"
        }
      ],
      "title": "Transactions/sec",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 19
      },
      "id": 200,
      "panels": [],
      "title": "\ud83d\udcc8 Database Load (Active Sessions by Wait Type)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Database load shows active sessions stacked by wait type. The Max vCPU line represents the server's capacity.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "Active Sessions",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "drawStyle": "line",
            "fillOpacity": 80,
            "gradientMode": "opacity",
            "hideFrom": {
              "tooltip": false,
              "viz": false,
              "legend": false
            },
            "lineInterpolation": "smooth",
            "lineWidth": 1,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "never",
            "spanNulls": true,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          },
          "unit": "short"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Max vCPU"
            },
            "properties": [
              {
                "id": "custom.lineWidth",
                "value": 2
              },
              {
                "id": "custom.fillOpacity",
                "value": 0
              },
              {
                "id": "custom.lineStyle",
                "value": {
                  "dash": [
                    10,
                    10
                  ],
                  "fill": "dash"
                }
              },
              {
                "id": "color",
                "value": {
                  "mode": "fixed",
                  "fixedColor": "red"
                }
              },
              {
                "id": "custom.stacking",
                "value": {
                  "group": "A",
                  "mode": "none"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 12,
        "w": 24,
        "x": 0,
        "y": 20
      },
      "id": 11,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "sortBy": "Max",
          "sortDesc": true
        },
        "tooltip": {
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "time_series",
          "rawSql": "-- Database Load by Wait Type (Active Sessions)\nSELECT\n  CollectionTime AS time,\n  MetricValue AS value,\n  MetricName AS metric\nFROM dbo.PerformanceMetrics\nWHERE MetricCategory = 'WaitStats'\n  AND ServerID = $ServerID\n  AND MetricName IN (\n    'PAGEIOLATCH_SH', 'PAGEIOLATCH_EX',\n    'LCK_M_S', 'LCK_M_X', 'LCK_M_U',\n    'WRITELOG', 'LOGBUFFER',\n    'CXPACKET', 'CXCONSUMER',\n    'SOS_SCHEDULER_YIELD',\n    'ASYNC_NETWORK_IO',\n    'BROKER_RECEIVE_WAITFOR'\n  )\n  AND CollectionTime >= $__timeFrom()\n  AND CollectionTime <= $__timeTo()\n\nUNION ALL\n\n-- Add Max vCPU line (logical CPU count)\nSELECT\n  CollectionTime AS time,\n  MetricValue AS value,\n  'Max vCPU' AS metric\nFROM dbo.PerformanceMetrics\nWHERE MetricCategory = 'CPU'\n  AND MetricName = 'LogicalProcessors'\n  AND ServerID = $ServerID\n  AND CollectionTime >= $__timeFrom()\n  AND CollectionTime <= $__timeTo()\n\nORDER BY time, metric",
          "refId": "A"
        }
      ],
      "title": "Database Load (Active Sessions by Wait Type)",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 32
      },
      "id": 300,
      "panels": [],
      "title": "\ud83d\udd0d Top Dimensions (SQL, Waits, Hosts, Users, Databases)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Top hosts by connection count",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Connections"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 150
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-BlYlRd"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 41
      },
      "id": 14,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Connections"
          }
        ]
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "table",
          "rawSql": "-- Top Hosts by Connection Count\nSELECT TOP 10\n  host_name AS [Host Name],\n  COUNT(*) AS [Connections],\n  SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) AS [Active],\n  SUM(CASE WHEN status = 'sleeping' THEN 1 ELSE 0 END) AS [Sleeping]\nFROM sys.dm_exec_sessions\nWHERE host_name IS NOT NULL\n  AND host_name <> ''\nGROUP BY host_name\nORDER BY [Connections] DESC",
          "refId": "A"
        }
      ],
      "title": "Top Hosts (by Connection Count)",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Top users by connection count",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Connections"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 150
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-BlYlRd"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 49
      },
      "id": 15,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Connections"
          }
        ]
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "table",
          "rawSql": "-- Top Users by Connection Count\nSELECT TOP 10\n  login_name AS [User Name],\n  COUNT(*) AS [Connections],\n  SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) AS [Active],\n  SUM(CASE WHEN status = 'sleeping' THEN 1 ELSE 0 END) AS [Sleeping]\nFROM sys.dm_exec_sessions\nWHERE login_name IS NOT NULL\n  AND is_user_process = 1\nGROUP BY login_name\nORDER BY [Connections] DESC",
          "refId": "A"
        }
      ],
      "title": "Top Users (by Connection Count)",
      "type": "table"
    },
    {
      "datasource": {
        "type": "mssql",
        "uid": "${DS_MONITORINGDB}"
      },
      "description": "Top databases by connection count",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "custom": {
            "align": "left",
            "cellOptions": {
              "type": "auto"
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": null
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Connections"
            },
            "properties": [
              {
                "id": "custom.width",
                "value": 150
              },
              {
                "id": "color",
                "value": {
                  "mode": "continuous-BlYlRd"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 49
      },
      "id": 16,
      "options": {
        "cellHeight": "sm",
        "footer": {
          "countRows": false,
          "fields": "",
          "reducer": [
            "sum"
          ],
          "show": false
        },
        "showHeader": true,
        "sortBy": [
          {
            "desc": true,
            "displayName": "Connections"
          }
        ]
      },
      "pluginVersion": "10.2.0",
      "targets": [
        {
          "datasource": {
            "type": "mssql",
            "uid": "${DS_MONITORINGDB}"
          },
          "format": "table",
          "rawSql": "-- Top Databases by Connection Count\nSELECT TOP 10\n  DB_NAME(database_id) AS [Database Name],\n  COUNT(*) AS [Connections],\n  SUM(CASE WHEN status = 'running' THEN 1 ELSE 0 END) AS [Active],\n  SUM(CASE WHEN status = 'sleeping' THEN 1 ELSE 0 END) AS [Sleeping]\nFROM sys.dm_exec_sessions\nWHERE database_id > 0\n  AND is_user_process = 1\nGROUP BY database_id\nORDER BY [Connections] DESC",
          "refId": "A"
        }
      ],
      "title": "Top Databases (by Connection Count)",
      "type": "table"
    }
  ],
  "refresh": "30s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": [
    "sql-server",
    "performance-insights",
    "rds-equivalent"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "selected": false,
          "text": "MonitoringDB",
          "value": "MonitoringDB"
        },
        "hide": 0,
        "includeAll": false,
        "label": "Datasource",
        "multi": false,
        "name": "DS_MONITORINGDB",
        "options": [],
        "query": "mssql",
        "queryValue": "",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "type": "datasource"
      },
      {
        "current": {
          "selected": false,
          "text": "1",
          "value": "1"
        },
        "datasource": {
          "type": "mssql",
          "uid": "${DS_MONITORINGDB}"
        },
        "definition": "SELECT ServerID AS __value, ServerName AS __text FROM dbo.Servers WHERE IsActive = 1 ORDER BY ServerName",
        "hide": 0,
        "includeAll": false,
        "label": "Server",
        "multi": false,
        "name": "ServerID",
        "options": [],
        "query": "SELECT ServerID AS __value, ServerName AS __text FROM dbo.Servers WHERE IsActive = 1 ORDER BY ServerName",
        "refresh": 1,
        "regex": "",
        "skipUrlSync": false,
        "sort": 0,
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "now-1h",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "10s",
      "30s",
      "1m",
      "5m",
      "15m",
      "30m",
      "1h"
    ],
    "time_options": [
      "5m",
      "15m",
      "1h",
      "6h",
      "12h",
      "24h",
      "2d",
      "7d",
      "30d"
    ]
  },
  "timezone": "browser",
  "title": "AWS RDS Performance Insights (SQL Server)",
  "uid": "aws-rds-performance-insights",
  "version": 1,
  "weekStart": ""
}