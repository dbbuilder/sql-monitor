<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SQL Server Health Report - SVWeb\CLUBTRACK</title>
    <style>
        body {
            font-family: "Segoe UI", Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .header {
            background-color: #0078d4;
            color: white;
            padding: 20px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .header h1 {
            margin: 0 0 10px 0;
            font-size: 24px;
        }
        .header p {
            margin: 5px 0;
            font-size: 14px;
        }
        .section {
            background-color: white;
            margin-bottom: 20px;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        .section-header {
            background-color: #e8e8e8;
            padding: 12px 15px;
            font-weight: bold;
            font-size: 16px;
            border-bottom: 2px solid #ccc;
        }
        .field-guide {
            background-color: #f9f9f9;
            border-left: 4px solid #0078d4;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th {
            background-color: #f0f0f0;
            padding: 10px;
            text-align: left;
            font-weight: 600;
            font-size: 13px;
            border-bottom: 2px solid #ddd;
        }
        td {
            padding: 8px 10px;
            border-bottom: 1px solid #eee;
            font-size: 13px;
        }
        tr:hover {
            background-color: #fafafa;
        }
        .severity-INFO {
            background-color: #e7f3ff;
            border-left: 4px solid #0078d4;
        }
        .severity-ATTENTION {
            background-color: #fff8e1;
            border-left: 4px solid #ffc107;
        }
        .severity-WARNING {
            background-color: #fff3e0;
            border-left: 4px solid #ff9800;
        }
        .severity-CRITICAL {
            background-color: #ffebee;
            border-left: 4px solid #f44336;
        }
        .metric-value {
            font-weight: 600;
            color: #0078d4;
        }
        .analysis {
            font-style: italic;
            color: #555;
        }
        .recommendation {
            color: #d32f2f;
            font-weight: 500;
        }
        .null-value {
            color: #999;
            font-style: italic;
        }
        .db-group-header {
            background-color: #e8e8e8;
            font-weight: bold;
            border-top: 2px solid #0078d4;
        }
        .footer {
            text-align: center;
            padding: 20px;
            color: #666;
            font-size: 12px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>SQL Server Daily Health Report</h1>
        <p><strong>Server:</strong> SVWeb\CLUBTRACK</p>
        <p><strong>Report Generated:</strong> 2025-10-28 01:18:17 UTC</p>
        <p><strong>Parameters:</strong> Top 20 Slow Queries, Top 20 Missing Indexes, 48 hours lookback</p>
    </div>
<div class="section">
    <div class="section-header">Report Header</div>
    <table><tr><th>Field</th><th>Value</th></tr><tr><td>Server Name</td><td>SVWeb\CLUBTRACK</td></tr><tr><td>Snapshot Date (UTC)</td><td>2025-10-28 01:15:00</td></tr><tr><td>SQL Version</td><td>15.0.4445.1</td></tr><tr><td>Total Sessions</td><td class="metric-value">84</td></tr><tr><td>Total Requests</td><td class="metric-value">56</td></tr></table></div><div class="section">
    <div class="section-header">Current System Health</div>
    <table>
        <tr>
            <th>Metric</th>
            <th>Value</th>
            <th>Status</th>
        </tr><tr class="severity-INFO"><td>CPU Signal Wait %</td><td class="metric-value">1.1361%</td><td>INFO - Normal</td></tr><tr class="severity-CRITICAL"><td>Blocking Sessions</td><td class="metric-value">56</td><td>CRITICAL - Severe blocking</td></tr><tr class="severity-INFO"><td>Recent Deadlocks (last 10 min)</td><td class="metric-value">0</td><td>INFO - None detected</td></tr><tr class="severity-INFO"><td>Memory Grant Warnings</td><td class="metric-value">0</td><td>INFO - None detected</td></tr><tr><td>Top Wait Type</td><td class="metric-value">SOS_WORK_DISPATCHER</td><td>82499.0000 ms/sec</td></tr></table></div><div class="section">
    <div class="section-header">Summary Statistics (Last 48 Hours)</div>
    <table>
        <tr>
            <th>Metric</th>
            <th>Value</th>
        </tr><tr><td>Total Snapshots</td><td class="metric-value">88</td></tr><tr><td>Avg CPU Signal Wait %</td><td class="metric-value">1.11%</td></tr><tr><td>Max CPU Signal Wait %</td><td class="metric-value">1.14%</td></tr><tr><td>Total Deadlocks</td><td class="metric-value">0</td></tr><tr><td>Snapshots with Blocking</td><td class="metric-value">88</td></tr><tr><td>Avg Sessions</td><td class="metric-value">81</td></tr><tr><td>Max Sessions</td><td class="metric-value">99</td></tr></table></div><div class="section">
        <div class="section-header">Top 10 Slow Queries per Database (by Total CPU)</div>
        <table>
            <tr>
                <th>Rank</th>
                <th>Database</th>
                <th>SQL Text</th>
                <th>Total CPU (ms)</th>
                <th>Avg Duration (ms)</th>
                <th>Execution Count</th>
                <th>Avg Reads</th>
            </tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: LogDB</td></tr><tr><td>1</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%Long%Duration%' OR DURATION &gt; 20000 THEN 1 ELSE 0 END), 
               @DeadlockCount = SUM(CASE WHEN EventName like '%Deadlock%' THEN 1 ELSE 0 END), 
               @LockTimeoutCount = SUM(CASE WHEN EventName like '%Lock%Timeout%' THEN 1 ELSE 0 END)
        FROM svdb_Wiley_Trace_PreviousDay">SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%...</td><td class="metric-value">6,564</td><td class="metric-value">2,575.05</td><td>4</td><td>114,487</td></tr><tr><td>2</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%Long%Duration%' OR DURATION &gt; 20000 THEN 1 ELSE 0 END), 
               @DeadlockCount = SUM(CASE WHEN EventName like '%Deadlock%' THEN 1 ELSE 0 END), 
               @LockTimeoutCount = SUM(CASE WHEN EventName like '%Lock%Timeout%' THEN 1 ELSE 0 END)
        FROM TruckTrack_Fleet001_Trace_PreviousDay">SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%...</td><td class="metric-value">1,178</td><td class="metric-value">397.72</td><td>3</td><td>172,405</td></tr><tr><td>3</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%Long%Duration%' OR DURATION &gt; 20000 THEN 1 ELSE 0 END), 
               @DeadlockCount = SUM(CASE WHEN EventName like '%Deadlock%' THEN 1 ELSE 0 END), 
               @LockTimeoutCount = SUM(CASE WHEN EventName like '%Lock%Timeout%' THEN 1 ELSE 0 END)
        FROM SVDB_AHEC_Conversion_Trace_PreviousDay">SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%...</td><td class="metric-value">432</td><td class="metric-value">135.27</td><td>4</td><td>53,462</td></tr><tr><td>4</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%Long%Duration%' OR DURATION &gt; 20000 THEN 1 ELSE 0 END), 
               @DeadlockCount = SUM(CASE WHEN EventName like '%Deadlock%' THEN 1 ELSE 0 END), 
               @LockTimeoutCount = SUM(CASE WHEN EventName like '%Lock%Timeout%' THEN 1 ELSE 0 END)
        FROM SVDB_HOPE_Trace_PreviousDay">SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%...</td><td class="metric-value">367</td><td class="metric-value">199.54</td><td>2</td><td>79,311</td></tr><tr><td>5</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%Long%Duration%' OR DURATION &gt; 20000 THEN 1 ELSE 0 END), 
               @DeadlockCount = SUM(CASE WHEN EventName like '%Deadlock%' THEN 1 ELSE 0 END), 
               @LockTimeoutCount = SUM(CASE WHEN EventName like '%Lock%Timeout%' THEN 1 ELSE 0 END)
        FROM SVDB_Windermere_Trace_PreviousDay">SELECT @TotalCount = COUNT(*), 
               @LongDurationCount = SUM(CASE WHEN EventName like '%...</td><td class="metric-value">190</td><td class="metric-value">96.80</td><td>2</td><td>4,018</td></tr><tr><td>6</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_wait_stats WHERE plan_id IN (SELECT plan_id FROM sys.plan_persist_plan WHERE query_id = @query_id)">DELETE sys.plan_persist_wait_stats WHERE plan_id IN (SELECT plan_id FROM sys.plan_persist_plan WHERE...</td><td class="metric-value">92</td><td class="metric-value">2.58</td><td>48</td><td>7</td></tr><tr><td>7</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
(SELECT SUM(CAST(df.size as float)) FROM sys.database_files AS df WHERE df.type in ( 0, 2, 4 ) ) AS [DbSize],
(SUM(a.total_pages) + (SELECT ISNULL(SUM(CAST(df.size as bigint)), 0) FROM sys.database_files AS df WHERE df.type = 2 )) AS [SpaceUsed],
(SELECT SUM(CAST(df.size as float)) FROM sys.database_files AS df WHERE df.type in (1, 3)) AS [LogSize],
SUM(CASE When it.internal_type IN (202,204,207,211,212,213,214,215,216) Then 0 When a.type &lt;&gt; 1 Then a.used_pages	When p.index_id &lt; 2 Then a.data_pages	Else 0	END) AS [DataSpaceUsage],
SUM(a.used_pages) AS [IndexSpaceTotal],
(select count(1) from sys.services where name ='InternalMailService') AS [IsMailHost],
(select top 1 ds.name from sys.data_spaces as ds where ds.is_default = 1 and ds.type = 'FG' ) AS [DefaultFileGroup]
FROM
sys.partitions p join sys.allocation_units a on p.partition_id = a.container_id left join sys.internal_tables it on p.object_id = it.object_id">SELECT
(SELECT SUM(CAST(df.size as float)) FROM sys.database_files AS df WHERE df.type in ( 0, 2, 4 ...</td><td class="metric-value">38</td><td class="metric-value">12.80</td><td>3</td><td>4,350</td></tr><tr><td>8</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT SUM(DATALENGTH(query_plan)) AS ShowplanSize FROM sys.plan_persist_plan WHERE query_id = @query_id">SELECT SUM(DATALENGTH(query_plan)) AS ShowplanSize FROM sys.plan_persist_plan WHERE query_id = @quer...</td><td class="metric-value">13</td><td class="metric-value">2.25</td><td>95</td><td>6</td></tr><tr><td>9</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_plan WHERE query_id = @query_id">DELETE sys.plan_persist_plan WHERE query_id = @query_id</td><td class="metric-value">13</td><td class="metric-value">2.84</td><td>95</td><td>14</td></tr><tr><td>10</td><td style="font-weight: bold;">LogDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
isnull((select convert(decimal(18,2),(sum(tms.memory_allocated_for_table_kb) + sum(tms.memory_allocated_for_indexes_kb))) 
                                                                                from [sys].[dm_db_xtp_table_memory_stats] tms), 0.00) AS [MemoryAllocatedToMemoryOptimizedObjectsInKB],
isnull((select convert(decimal(18,2),(sum(tms.memory_used_by_table_kb) + sum(tms.memory_used_by_indexes_kb))) 
                                                                           from [sys].[dm_db_xtp_table_memory_stats] tms), 0.00) AS [MemoryUsedByMemoryOptimizedObjectsInKB]">SELECT
isnull((select convert(decimal(18,2),(sum(tms.memory_allocated_for_table_kb) + sum(tms.memory...</td><td class="metric-value">8</td><td class="metric-value">2.87</td><td>3</td><td>372</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: MonitoringDB</td></tr><tr><td>1</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
udf.name AS [Name],
udf.object_id AS [ID],
udf.create_date AS [CreateDate],
udf.modify_date AS [DateLastModified],
ISNULL(sudf.name, N'') AS [Owner],
CAST(case when udf.principal_id is null then 1 else 0 end AS bit) AS [IsSchemaOwned],
SCHEMA_NAME(udf.schema_id) AS [Schema],
CAST(
 case 
    when udf.is_ms_shipped = 1 then 1
    when (
        select 
            major_id 
        from 
            sys.extended_properties 
        where 
            major_id = udf.object_id and 
            minor_id = 0 and 
            class = 1 and 
            name = N'microsoft_database_tools_support') 
        is not null then 1
    else 0
end          
             AS bit) AS [IsSystemObject],
usrt.name AS [DataType],
s1ret_param.name AS [DataTypeSchema],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND ret_param.max_length &lt;&gt; -1 THEN ret_param.max_length/2 ELSE ret_param.max_length END AS int) AS [Length],
CAST(ret_param.precision AS int) AS [NumericPrecision],
CAST(ret_param.scale AS int) AS [NumericScale],
ISNULL(xscret_param.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2ret_param.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case ret_param.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
CASE WHEN usrt.is_table_type = 1 THEN N'structured' ELSE N'' END AS [UserType],
CAST(ISNULL(OBJECTPROPERTYEX(udf.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS [AnsiNullsStatus],
CAST(ISNULL(OBJECTPROPERTYEX(udf.object_id, N'IsSchemaBound'),0) AS bit) AS [IsSchemaBound],
CAST(CASE WHEN ISNULL(smudf.definition, ssmudf.definition) IS NULL THEN 1 ELSE 0 END AS bit) AS [IsEncrypted],
case when amudf.object_id is null then N'' else asmbludf.name end AS [AssemblyName],
case when amudf.object_id is null then N'' else amudf.assembly_class end AS [ClassName],
case when amudf.object_id is null then N'' else amudf.assembly_method end AS [MethodName],
CAST(case when amudf.object_id is null then CAST(smudf.null_on_null_input AS bit) else amudf.null_on_null_input end AS bit) AS [ReturnsNullOnNullInput],
case when amudf.object_id is null then case isnull(smudf.execute_as_principal_id, -1) when -1 then 1 when -2 then 2 else 3 end else case isnull(amudf.execute_as_principal_id, -1) when -1 then 1 when -2 then 2 else 3 end end AS [ExecutionContext],
case when amudf.object_id is null then ISNULL(user_name(smudf.execute_as_principal_id),N'') else ISNULL(user_name(amudf.execute_as_principal_id), N'') end AS [ExecutionContextPrincipal],
CAST(OBJECTPROPERTYEX(udf.object_id, N'IsDeterministic') AS bit) AS [IsDeterministic],
(case when 'FN' = udf.type then 1 when 'FS' = udf.type then 1 when 'IF' = udf.type then 3 when 'TF' = udf.type then 2 when 'FT' = udf.type then 2 else 0 end) AS [FunctionType],
CASE WHEN udf.type IN ('FN','IF','TF') THEN 1 WHEN udf.type IN ('FS','FT') THEN 2 ELSE 1 END AS [ImplementationType],
CAST(ISNULL(OBJECTPROPERTYEX(udf.object_id,N'ExecIsQuotedIdentOn'),0) AS bit) AS [QuotedIdentifierStatus],
ret_param.name AS [TableVariableName],
ISNULL(sm.uses_native_compilation,0) AS [IsNativelyCompiled],
CAST(ISNULL(sm.inline_type,0) AS bit) AS [InlineType],
CAST(ISNULL(sm.is_inlineable,0) AS bit) AS [IsInlineable],
ISNULL(smudf.definition, ssmudf.definition) AS [Definition]
FROM
sys.all_objects AS udf
LEFT OUTER JOIN sys.database_principals AS sudf ON sudf.principal_id = ISNULL(udf.principal_id, (OBJECTPROPERTY(udf.object_id, 'OwnerId')))
LEFT OUTER JOIN sys.all_parameters AS ret_param ON ret_param.object_id = udf.object_id and ret_param.is_output = @_msparam_0
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = ret_param.user_type_id
LEFT OUTER JOIN sys.schemas AS s1ret_param ON s1ret_param.schema_id = usrt.schema_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = ret_param.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = ret_param.system_type_id) and (baset.user_type_id = ret_param.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscret_param ON xscret_param.xml_collection_id = ret_param.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2ret_param ON s2ret_param.schema_id = xscret_param.schema_id
LEFT OUTER JOIN sys.sql_modules AS smudf ON smudf.object_id = udf.object_id
LEFT OUTER JOIN sys.system_sql_modules AS ssmudf ON ssmudf.object_id = udf.object_id
LEFT OUTER JOIN sys.assembly_modules AS amudf ON amudf.object_id = udf.object_id
LEFT OUTER JOIN sys.assemblies AS asmbludf ON asmbludf.assembly_id = amudf.assembly_id
LEFT OUTER JOIN sys.all_sql_modules AS sm ON sm.object_id = udf.object_id
WHERE
(udf.type in ('TF', 'FN', 'IF', 'FS', 'FT'))and(udf.name=@_msparam_1 and SCHEMA_NAME(udf.schema_id)=@_msparam_2)">SELECT
udf.name AS [Name],
udf.object_id AS [ID],
udf.create_date AS [CreateDate],
udf.modify_date A...</td><td class="metric-value">157</td><td class="metric-value">51.56</td><td>4</td><td>137</td></tr><tr><td>2</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
SCHEMA_NAME(udf.schema_id) AS [Schema],
udf.name AS [Name],
udf.object_id AS [ID],
(case when 'FN' = udf.type then 1 when 'FS' = udf.type then 1 when 'IF' = udf.type then 3 when 'TF' = udf.type then 2 when 'FT' = udf.type then 2 else 0 end) AS [FunctionType],
CASE WHEN udf.type IN ('FN','IF','TF') THEN 1 WHEN udf.type IN ('FS','FT') THEN 2 ELSE 1 END AS [ImplementationType],
CAST(
 case 
    when udf.is_ms_shipped = 1 then 1
    when (
        select 
            major_id 
        from 
            sys.extended_properties 
        where 
            major_id = udf.object_id and 
            minor_id = 0 and 
            class = 1 and 
            name = N'microsoft_database_tools_support') 
        is not null then 1
    else 0
end          
             AS bit) AS [IsSystemObject],
CAST(CASE WHEN ISNULL(smudf.definition, ssmudf.definition) IS NULL THEN 1 ELSE 0 END AS bit) AS [IsEncrypted],
CAST(ISNULL(OBJECTPROPERTYEX(udf.object_id, N'IsSchemaBound'),0) AS bit) AS [IsSchemaBound],
usrt.name AS [DataType]
FROM
sys.all_objects AS udf
LEFT OUTER JOIN sys.sql_modules AS smudf ON smudf.object_id = udf.object_id
LEFT OUTER JOIN sys.system_sql_modules AS ssmudf ON ssmudf.object_id = udf.object_id
LEFT OUTER JOIN sys.all_parameters AS ret_param ON ret_param.object_id = udf.object_id and ret_param.is_output = @_msparam_0
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = ret_param.user_type_id
WHERE
(udf.type in ('TF', 'FN', 'IF', 'FS', 'FT'))
ORDER BY
[Schema] ASC,[Name] ASC">SELECT
SCHEMA_NAME(udf.schema_id) AS [Schema],
udf.name AS [Name],
udf.object_id AS [ID],
(case when...</td><td class="metric-value">124</td><td class="metric-value">62.45</td><td>2</td><td>6,420</td></tr><tr><td>3</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
i.name AS [Name],
CAST(i.index_id AS int) AS [ID],
CAST(OBJECTPROPERTY(i.object_id,N'IsMSShipped') AS bit) AS [IsSystemObject],
ISNULL(s.no_recompute,0) AS [NoAutomaticRecomputation],
i.fill_factor AS [FillFactor],
CAST(CASE i.index_id WHEN 1 THEN 1 ELSE 0 END AS bit) AS [IsClustered],
i.is_primary_key + 2*i.is_unique_constraint AS [IndexKeyType],
i.is_unique AS [IsUnique],
i.ignore_dup_key AS [IgnoreDuplicateKeys],
~i.allow_row_locks AS [DisallowRowLocks],
~i.allow_page_locks AS [DisallowPageLocks],
CAST(ISNULL(INDEXPROPERTY(i.object_id, i.name, N'IsPadIndex'), 0) AS bit) AS [PadIndex],
i.is_disabled AS [IsDisabled],
CAST(ISNULL(k.is_system_named, 0) AS bit) AS [IsSystemNamed],
CAST(INDEXPROPERTY(i.object_id,i.name,N'IsFulltextKey') AS bit) AS [IsFullTextKey],
CAST(case when i.type=3 then 1 else 0 end AS bit) AS [IsXmlIndex],
case UPPER(ISNULL(xi.secondary_type,'')) when 'P' then 1 when 'V' then 2 when 'R' then 3 else 0 end AS [SecondaryXmlIndexType],
ISNULL(xi2.name, N'') AS [ParentXmlIndex],
CAST(ISNULL(spi.spatial_index_type,0) AS tinyint) AS [SpatialIndexType],
CAST(ISNULL(si.bounding_box_xmin,0) AS float(53)) AS [BoundingBoxXMin],
CAST(ISNULL(si.bounding_box_ymin,0) AS float(53)) AS [BoundingBoxYMin],
CAST(ISNULL(si.bounding_box_xmax,0) AS float(53)) AS [BoundingBoxXMax],
CAST(ISNULL(si.bounding_box_ymax,0) AS float(53)) AS [BoundingBoxYMax],
CAST(ISNULL(si.level_1_grid,0) AS smallint) AS [Level1Grid],
CAST(ISNULL(si.level_2_grid,0) AS smallint) AS [Level2Grid],
CAST(ISNULL(si.level_3_grid,0) AS smallint) AS [Level3Grid],
CAST(ISNULL(si.level_4_grid,0) AS smallint) AS [Level4Grid],
CAST(ISNULL(si.cells_per_object,0) AS int) AS [CellsPerObject],
CAST(case when i.type=4 then 1 else 0 end AS bit) AS [IsSpatialIndex],
CAST(
        ISNULL ((select distinct 1 from sys.index_columns ic 
                 join sys.columns c on ic.object_id = c.object_id and c.column_id = ic.column_id 
                 where c.is_sparse = 1 and c.object_id = i.object_id and ic.index_id = i.index_id), 0)
       AS bit) AS [HasSparseColumn],
i.has_filter AS [HasFilter],
ISNULL(i.filter_definition, N'') AS [FilterDefinition],
CASE WHEN 'PS'=dsi.type THEN dsi.name ELSE N'' END AS [PartitionScheme],
CAST(CASE WHEN 'PS'=dsi.type THEN 1 ELSE 0 END AS bit) AS [IsPartitioned],
CASE WHEN 'FD'=dstbl.type THEN dstbl.name ELSE N'' END AS [FileStreamFileGroup],
CASE WHEN 'PS'=dstbl.type THEN dstbl.name ELSE N'' END AS [FileStreamPartitionScheme],
CAST(CASE WHEN filetableobj.object_id IS NULL THEN 0 ELSE 1 END AS bit) AS [IsFileTableDefined],
CAST(
          CASE i.type WHEN 1 THEN 0 WHEN 4 THEN 4
                      WHEN 3 THEN CASE xi.xml_index_type WHEN 0 THEN 2 WHEN 1 THEN 3 WHEN 2 THEN 7 WHEN 3 THEN 8 END
                      WHEN 4 THEN 4 WHEN 6 THEN 5 WHEN 7 THEN 6 WHEN 5 THEN 9 ELSE 1 END
        AS tinyint) AS [IndexType],
CAST(case when (i.type=7) then hi.bucket_count else 0 end AS int) AS [BucketCount],
CAST(i.compression_delay AS int) AS [CompressionDelay],

        ISNULL(indexedpaths.name, N'')
       AS [IndexedXmlPathName],

        ISNULL(op.state, 2)
       AS [ResumableOperationState],
CAST(ISNULL(INDEXPROPERTY(i.object_id, i.name, N'IsOptimizedForSequentialKey'), 0) AS bit) AS [IsOptimizedForSequentialKey]
FROM
sys.tables AS tbl
INNER JOIN sys.indexes AS i ON (i.index_id &gt; @_msparam_0 and i.is_hypothetical = @_msparam_1) AND (i.object_id=tbl.object_id)
LEFT OUTER JOIN sys.stats AS s ON s.stats_id = i.index_id AND s.object_id = i.object_id
LEFT OUTER JOIN sys.key_constraints AS k ON k.parent_object_id = i.object_id AND k.unique_index_id = i.index_id
LEFT OUTER JOIN sys.xml_indexes AS xi ON xi.object_id = i.object_id AND xi.index_id = i.index_id
LEFT OUTER JOIN sys.xml_indexes AS xi2 ON xi2.object_id = xi.object_id AND xi2.index_id = xi.using_xml_index_id
LEFT OUTER JOIN sys.spatial_indexes AS spi ON i.object_id = spi.object_id and i.index_id = spi.index_id
LEFT OUTER JOIN sys.spatial_index_tessellations as si ON i.object_id = si.object_id and i.index_id = si.index_id
LEFT OUTER JOIN sys.data_spaces AS dsi ON dsi.data_space_id = i.data_space_id
LEFT OUTER JOIN sys.tables AS t ON t.object_id = i.object_id
LEFT OUTER JOIN sys.data_spaces AS dstbl ON dstbl.data_space_id = t.Filestream_data_space_id and (i.index_id &lt; 2 or (i.type = 7 and i.index_id &lt; 3))
LEFT OUTER JOIN sys.filetable_system_defined_objects AS filetableobj ON i.object_id = filetableobj.object_id
LEFT OUTER JOIN sys.hash_indexes AS hi ON i.object_id = hi.object_id AND i.index_id = hi.index_id
LEFT OUTER JOIN sys.selective_xml_index_paths AS indexedpaths ON xi.object_id = indexedpaths.object_id AND xi.using_xml_index_id = indexedpaths.index_id AND xi.path_id = indexedpaths.path_id
LEFT OUTER JOIN sys.index_resumable_operations AS op ON op.index_id = i.index_id AND op.object_id = i.object_id
WHERE
(i.name=@_msparam_2)and((tbl.name=@_msparam_3 and SCHEMA_NAME(tbl.schema_id)=@_msparam_4))">SELECT
i.name AS [Name],
CAST(i.index_id AS int) AS [ID],
CAST(OBJECTPROPERTY(i.object_id,N'IsMSShip...</td><td class="metric-value">47</td><td class="metric-value">23.63</td><td>2</td><td>1,184</td></tr><tr><td>4</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
clmns.name AS [Name],
clmns.column_id AS [ID],
clmns.is_nullable AS [Nullable],
clmns.is_computed AS [Computed],
CAST(ISNULL(cik.index_column_id, 0) AS bit) AS [InPrimaryKey],
clmns.is_ansi_padded AS [AnsiPaddingStatus],
CAST(clmns.is_rowguidcol AS bit) AS [RowGuidCol],
CAST(ISNULL(cc.is_persisted, 0) AS bit) AS [IsPersisted],
ISNULL(clmns.collation_name, N'') AS [Collation],
CAST(ISNULL((select TOP 1 1 from sys.foreign_key_columns AS colfk where colfk.parent_column_id = clmns.column_id and colfk.parent_object_id = clmns.object_id), 0) AS bit) AS [IsForeignKey],
clmns.is_identity AS [Identity],
CAST(ISNULL(ic.seed_value,0) AS numeric(38)) AS [IdentitySeedAsDecimal],
CAST(ISNULL(ic.increment_value,0) AS numeric(38)) AS [IdentityIncrementAsDecimal],
(case when clmns.default_object_id = 0 then N'' when d.parent_object_id &gt; 0 then N'' else d.name end) AS [Default],
(case when clmns.default_object_id = 0 then N'' when d.parent_object_id &gt; 0 then N'' else schema_name(d.schema_id) end) AS [DefaultSchema],
ISNULL(dc.Name, N'') AS [DefaultConstraintName],
(case when clmns.rule_object_id = 0 then N'' else r.name end) AS [Rule],
(case when clmns.rule_object_id = 0 then N'' else schema_name(r.schema_id) end) AS [RuleSchema],
CAST(ISNULL(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsDeterministic'),0) AS bit) AS [IsDeterministic],
CAST(ISNULL(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsPrecise'),0) AS bit) AS [IsPrecise],
ISNULL(ic.is_not_for_replication, 0) AS [NotForReplication],
CAST(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsFulltextIndexed') AS bit) AS [IsFullTextIndexed],
CAST(COLUMNPROPERTY(clmns.object_id, clmns.name, N'StatisticalSemantics') AS int) AS [StatisticalSemantics],
CAST(clmns.encryption_type AS int) AS [EncryptionType],
clmns.encryption_algorithm_name AS [EncryptionAlgorithm],
clmns.column_encryption_key_id AS [ColumnEncryptionKeyID],
ceks.name AS [ColumnEncryptionKeyName],
CAST(clmns.is_filestream AS bit) AS [IsFileStream],
CAST(clmns.is_sparse AS bit) AS [IsSparse],
CAST(clmns.is_column_set AS bit) AS [IsColumnSet],
usrt.name AS [DataType],
s1clmns.name AS [DataTypeSchema],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND clmns.max_length &lt;&gt; -1 THEN clmns.max_length/2 ELSE clmns.max_length END AS int) AS [Length],
CAST(clmns.precision AS int) AS [NumericPrecision],
CAST(clmns.scale AS int) AS [NumericScale],
ISNULL(xscclmns.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2clmns.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case clmns.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
CASE WHEN usrt.is_table_type = 1 THEN N'structured' ELSE N'' END AS [UserType],
clmns.generated_always_type AS [GeneratedAlwaysType],
CAST(clmns.is_hidden AS bit) AS [IsHidden],
CAST(0 AS bit) AS [IsDroppedLedgerColumn],
CAST(clmns.is_masked AS bit) AS [IsMasked],
CAST(
        CASE
        WHEN [sc].[label] IS NOT NULL or [sc].[label_id] IS NOT NULL or [sc].[information_type] IS NOT NULL or [sc].[information_type_id] IS NOT NULL or [sc].[rank] IS NOT NULL THEN 1
        ELSE 0
        END
       AS bit) AS [IsClassified],
ISNULL(clmns.graph_type, 0) AS [GraphType]
FROM
sys.all_views AS v
INNER JOIN sys.all_columns AS clmns ON clmns.object_id=v.object_id
LEFT OUTER JOIN sys.indexes AS ik ON ik.object_id = clmns.object_id and 1=ik.is_primary_key
LEFT OUTER JOIN sys.index_columns AS cik ON cik.index_id = ik.index_id and cik.column_id = clmns.column_id and cik.object_id = clmns.object_id and 0 = cik.is_included_column
LEFT OUTER JOIN sys.computed_columns AS cc ON cc.object_id = clmns.object_id and cc.column_id = clmns.column_id
LEFT OUTER JOIN sys.identity_columns AS ic ON ic.object_id = clmns.object_id and ic.column_id = clmns.column_id
LEFT OUTER JOIN sys.objects AS d ON d.object_id = clmns.default_object_id
LEFT OUTER JOIN sys.default_constraints as dc ON clmns.default_object_id = dc.object_id
LEFT OUTER JOIN sys.objects AS r ON r.object_id = clmns.rule_object_id
LEFT OUTER JOIN sys.column_encryption_keys AS ceks ON (ceks.column_encryption_key_id = clmns.column_encryption_key_id)
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = clmns.user_type_id
LEFT OUTER JOIN sys.schemas AS s1clmns ON s1clmns.schema_id = usrt.schema_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = clmns.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = clmns.system_type_id) and (baset.user_type_id = clmns.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscclmns ON xscclmns.xml_collection_id = clmns.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2clmns ON s2clmns.schema_id = xscclmns.schema_id
LEFT OUTER JOIN sys.sensitivity_classifications AS sc ON sc.major_id = clmns.object_id and sc.minor_id = clmns.column_id
WHERE
(clmns.name=@_msparam_0)and((v.type = @_msparam_1)and(v.name=@_msparam_2 and SCHEMA_NAME(v.schema_id)=@_msparam_3))">SELECT
clmns.name AS [Name],
clmns.column_id AS [ID],
clmns.is_nullable AS [Nullable],
clmns.is_comp...</td><td class="metric-value">19</td><td class="metric-value">0.87</td><td>23</td><td>38</td></tr><tr><td>5</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT TOP 100
  pm.CollectionTime,
  s.ServerName,
  pm.MetricCategory,
  pm.MetricName,
  pm.MetricValue
FROM dbo.PerformanceMetrics pm
INNER JOIN dbo.Servers s ON pm.ServerID = s.ServerID
WHERE pm.CollectionTime &gt;= DATEADD(hour, -24, GETUTCDATE())
ORDER BY pm.CollectionTime DESC">SELECT TOP 100
  pm.CollectionTime,
  s.ServerName,
  pm.MetricCategory,
  pm.MetricName,
  pm.Metri...</td><td class="metric-value">12</td><td class="metric-value">4.14</td><td>3</td><td>6</td></tr><tr><td>6</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
param.name AS [Name],
param.parameter_id AS [ID],
param.default_value AS [DefaultValue],
param.has_default_value AS [HasDefaultValue],
usrt.name AS [DataType],
s1param.name AS [DataTypeSchema],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND param.max_length &lt;&gt; -1 THEN param.max_length/2 ELSE param.max_length END AS int) AS [Length],
CAST(param.precision AS int) AS [NumericPrecision],
CAST(param.scale AS int) AS [NumericScale],
ISNULL(xscparam.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2param.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case param.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
CASE WHEN usrt.is_table_type = 1 THEN N'structured' ELSE N'' END AS [UserType],
param.is_output AS [IsOutputParameter],
param.is_cursor_ref AS [IsCursorParameter],
param.is_readonly AS [IsReadOnly],
sp.object_id AS [IDText],
db_name() AS [DatabaseName],
param.name AS [ParamName],
CAST(
 case 
    when sp.is_ms_shipped = 1 then 1
    when (
        select 
            major_id 
        from 
            sys.extended_properties 
        where 
            major_id = sp.object_id and 
            minor_id = 0 and 
            class = 1 and 
            name = N'microsoft_database_tools_support') 
        is not null then 1
    else 0
end          
             AS bit) AS [ParentSysObj],
1 AS [Number]
FROM
sys.all_objects AS sp
INNER JOIN sys.all_parameters AS param ON param.object_id=sp.object_id
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = param.user_type_id
LEFT OUTER JOIN sys.schemas AS s1param ON s1param.schema_id = usrt.schema_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = param.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = param.system_type_id) and (baset.user_type_id = param.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscparam ON xscparam.xml_collection_id = param.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2param ON s2param.schema_id = xscparam.schema_id
WHERE
(param.name=@_msparam_0)and((sp.type = @_msparam_1 OR sp.type = @_msparam_2 OR sp.type=@_msparam_3)and(sp.name=@_msparam_4 and SCHEMA_NAME(sp.schema_id)=@_msparam_5))">SELECT
param.name AS [Name],
param.parameter_id AS [ID],
param.default_value AS [DefaultValue],
para...</td><td class="metric-value">8</td><td class="metric-value">0.57</td><td>15</td><td>22</td></tr><tr><td>7</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
clmns.name AS [Name],
clmns.column_id AS [ID],
clmns.is_nullable AS [Nullable],
clmns.is_computed AS [Computed],
CAST(ISNULL(cik.index_column_id, 0) AS bit) AS [InPrimaryKey],
clmns.is_ansi_padded AS [AnsiPaddingStatus],
CAST(clmns.is_rowguidcol AS bit) AS [RowGuidCol],
CAST(ISNULL(cc.is_persisted, 0) AS bit) AS [IsPersisted],
ISNULL(clmns.collation_name, N'') AS [Collation],
CAST(ISNULL((select TOP 1 1 from sys.foreign_key_columns AS colfk where colfk.parent_column_id = clmns.column_id and colfk.parent_object_id = clmns.object_id), 0) AS bit) AS [IsForeignKey],
clmns.is_identity AS [Identity],
CAST(ISNULL(ic.seed_value,0) AS numeric(38)) AS [IdentitySeedAsDecimal],
CAST(ISNULL(ic.increment_value,0) AS numeric(38)) AS [IdentityIncrementAsDecimal],
(case when clmns.default_object_id = 0 then N'' when d.parent_object_id &gt; 0 then N'' else d.name end) AS [Default],
(case when clmns.default_object_id = 0 then N'' when d.parent_object_id &gt; 0 then N'' else schema_name(d.schema_id) end) AS [DefaultSchema],
ISNULL(dc.Name, N'') AS [DefaultConstraintName],
(case when clmns.rule_object_id = 0 then N'' else r.name end) AS [Rule],
(case when clmns.rule_object_id = 0 then N'' else schema_name(r.schema_id) end) AS [RuleSchema],
CAST(ISNULL(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsDeterministic'),0) AS bit) AS [IsDeterministic],
CAST(ISNULL(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsPrecise'),0) AS bit) AS [IsPrecise],
ISNULL(ic.is_not_for_replication, 0) AS [NotForReplication],
CAST(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsFulltextIndexed') AS bit) AS [IsFullTextIndexed],
CAST(COLUMNPROPERTY(clmns.object_id, clmns.name, N'StatisticalSemantics') AS int) AS [StatisticalSemantics],
CAST(clmns.encryption_type AS int) AS [EncryptionType],
clmns.encryption_algorithm_name AS [EncryptionAlgorithm],
clmns.column_encryption_key_id AS [ColumnEncryptionKeyID],
ceks.name AS [ColumnEncryptionKeyName],
CAST(clmns.is_filestream AS bit) AS [IsFileStream],
CAST(clmns.is_sparse AS bit) AS [IsSparse],
CAST(clmns.is_column_set AS bit) AS [IsColumnSet],
usrt.name AS [DataType],
s1clmns.name AS [DataTypeSchema],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND clmns.max_length &lt;&gt; -1 THEN clmns.max_length/2 ELSE clmns.max_length END AS int) AS [Length],
CAST(clmns.precision AS int) AS [NumericPrecision],
CAST(clmns.scale AS int) AS [NumericScale],
ISNULL(xscclmns.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2clmns.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case clmns.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
CASE WHEN usrt.is_table_type = 1 THEN N'structured' ELSE N'' END AS [UserType],
clmns.generated_always_type AS [GeneratedAlwaysType],
CAST(clmns.is_hidden AS bit) AS [IsHidden],
CAST(0 AS bit) AS [IsDroppedLedgerColumn],
CAST(clmns.is_masked AS bit) AS [IsMasked],
CAST(
        CASE
        WHEN [sc].[label] IS NOT NULL or [sc].[label_id] IS NOT NULL or [sc].[information_type] IS NOT NULL or [sc].[information_type_id] IS NOT NULL or [sc].[rank] IS NOT NULL THEN 1
        ELSE 0
        END
       AS bit) AS [IsClassified],
ISNULL(clmns.graph_type, 0) AS [GraphType]
FROM
sys.all_objects AS udf
INNER JOIN sys.all_columns AS clmns ON clmns.object_id=udf.object_id
LEFT OUTER JOIN sys.indexes AS ik ON ik.object_id = clmns.object_id and 1=ik.is_primary_key
LEFT OUTER JOIN sys.index_columns AS cik ON cik.index_id = ik.index_id and cik.column_id = clmns.column_id and cik.object_id = clmns.object_id and 0 = cik.is_included_column
LEFT OUTER JOIN sys.computed_columns AS cc ON cc.object_id = clmns.object_id and cc.column_id = clmns.column_id
LEFT OUTER JOIN sys.identity_columns AS ic ON ic.object_id = clmns.object_id and ic.column_id = clmns.column_id
LEFT OUTER JOIN sys.objects AS d ON d.object_id = clmns.default_object_id
LEFT OUTER JOIN sys.default_constraints as dc ON clmns.default_object_id = dc.object_id
LEFT OUTER JOIN sys.objects AS r ON r.object_id = clmns.rule_object_id
LEFT OUTER JOIN sys.column_encryption_keys AS ceks ON (ceks.column_encryption_key_id = clmns.column_encryption_key_id)
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = clmns.user_type_id
LEFT OUTER JOIN sys.schemas AS s1clmns ON s1clmns.schema_id = usrt.schema_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = clmns.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = clmns.system_type_id) and (baset.user_type_id = clmns.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscclmns ON xscclmns.xml_collection_id = clmns.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2clmns ON s2clmns.schema_id = xscclmns.schema_id
LEFT OUTER JOIN sys.sensitivity_classifications AS sc ON sc.major_id = clmns.object_id and sc.minor_id = clmns.column_id
WHERE
(clmns.name=@_msparam_0)and((udf.type in ('TF', 'FN', 'IF', 'FS', 'FT'))and(udf.name=@_msparam_1 and SCHEMA_NAME(udf.schema_id)=@_msparam_2))">SELECT
clmns.name AS [Name],
clmns.column_id AS [ID],
clmns.is_nullable AS [Nullable],
clmns.is_comp...</td><td class="metric-value">7</td><td class="metric-value">1.75</td><td>4</td><td>37</td></tr><tr><td>8</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
param.parameter_id AS [ID],
param.name AS [Name],
param.default_value AS [DefaultValue],
param.is_output AS [IsOutputParameter],
param.is_readonly AS [IsReadOnly],
usrt.name AS [DataType],
sp.object_id AS [IDText],
db_name() AS [DatabaseName],
param.name AS [ParamName],
CAST(
 case 
    when sp.is_ms_shipped = 1 then 1
    when (
        select 
            major_id 
        from 
            sys.extended_properties 
        where 
            major_id = sp.object_id and 
            minor_id = 0 and 
            class = 1 and 
            name = N'microsoft_database_tools_support') 
        is not null then 1
    else 0
end          
             AS bit) AS [ParentSysObj],
1 AS [Number]
FROM
sys.all_objects AS sp
INNER JOIN sys.all_parameters AS param ON param.object_id=sp.object_id
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = param.user_type_id
WHERE
(sp.type = @_msparam_0 OR sp.type = @_msparam_1 OR sp.type=@_msparam_2)and(sp.name=@_msparam_3 and SCHEMA_NAME(sp.schema_id)=@_msparam_4)
ORDER BY
[ID] ASC">SELECT
param.parameter_id AS [ID],
param.name AS [Name],
param.default_value AS [DefaultValue],
para...</td><td class="metric-value">3</td><td class="metric-value">0.51</td><td>7</td><td>18</td></tr><tr><td>9</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
clmns.column_id AS [ID],
clmns.name AS [Name],
ISNULL(dc.Name, N'') AS [DefaultConstraintName],
clmns.is_nullable AS [Nullable],
CAST(ISNULL(cik.index_column_id, 0) AS bit) AS [InPrimaryKey],
clmns.is_identity AS [Identity],
usrt.name AS [DataType],
clmns.is_computed AS [Computed]
FROM
sys.all_views AS v
INNER JOIN sys.all_columns AS clmns ON clmns.object_id=v.object_id
LEFT OUTER JOIN sys.default_constraints as dc ON clmns.default_object_id = dc.object_id
LEFT OUTER JOIN sys.indexes AS ik ON ik.object_id = clmns.object_id and 1=ik.is_primary_key
LEFT OUTER JOIN sys.index_columns AS cik ON cik.index_id = ik.index_id and cik.column_id = clmns.column_id and cik.object_id = clmns.object_id and 0 = cik.is_included_column
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = clmns.user_type_id
WHERE
(v.type = @_msparam_0)and(v.name=@_msparam_1 and SCHEMA_NAME(v.schema_id)=@_msparam_2)
ORDER BY
[ID] ASC">SELECT
clmns.column_id AS [ID],
clmns.name AS [Name],
ISNULL(dc.Name, N'') AS [DefaultConstraintName...</td><td class="metric-value">3</td><td class="metric-value">1.07</td><td>3</td><td>397</td></tr><tr><td>10</td><td style="font-weight: bold;">MonitoringDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
param.is_readonly AS [IsReadOnly],
param.name AS [Name],
param.parameter_id AS [ID],
param.default_value AS [DefaultValue],
param.has_default_value AS [HasDefaultValue],
usrt.name AS [DataType],
s1param.name AS [DataTypeSchema],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND param.max_length &lt;&gt; -1 THEN param.max_length/2 ELSE param.max_length END AS int) AS [Length],
CAST(param.precision AS int) AS [NumericPrecision],
CAST(param.scale AS int) AS [NumericScale],
ISNULL(xscparam.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2param.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case param.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
CASE WHEN usrt.is_table_type = 1 THEN N'structured' ELSE N'' END AS [UserType],
udf.object_id AS [IDText],
db_name() AS [DatabaseName],
param.name AS [ParamName],
CAST(
 case 
    when udf.is_ms_shipped = 1 then 1
    when (
        select 
            major_id 
        from 
            sys.extended_properties 
        where 
            major_id = udf.object_id and 
            minor_id = 0 and 
            class = 1 and 
            name = N'microsoft_database_tools_support') 
        is not null then 1
    else 0
end          
             AS bit) AS [ParentSysObj],
-1 AS [Number]
FROM
sys.all_objects AS udf
INNER JOIN sys.all_parameters AS param ON (param.is_output = 0) AND (param.object_id=udf.object_id)
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = param.user_type_id
LEFT OUTER JOIN sys.schemas AS s1param ON s1param.schema_id = usrt.schema_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = param.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = param.system_type_id) and (baset.user_type_id = param.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscparam ON xscparam.xml_collection_id = param.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2param ON s2param.schema_id = xscparam.schema_id
WHERE
(param.name=@_msparam_0)and((udf.type in ('TF', 'FN', 'IF', 'FS', 'FT'))and(udf.name=@_msparam_1 and SCHEMA_NAME(udf.schema_id)=@_msparam_2))">SELECT
param.is_readonly AS [IsReadOnly],
param.name AS [Name],
param.parameter_id AS [ID],
param.de...</td><td class="metric-value">3</td><td class="metric-value">0.53</td><td>6</td><td>17</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">6,050</td><td class="metric-value">1,575.28</td><td>6</td><td>96,977</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,463</td><td class="metric-value">1,142.65</td><td>6</td><td>225,381</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,999</td><td class="metric-value">574.14</td><td>6</td><td>165,986</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,336</td><td class="metric-value">741.18</td><td>6</td><td>1,401</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,213</td><td class="metric-value">430.21</td><td>6</td><td>53,073</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,120</td><td class="metric-value">460.57</td><td>6</td><td>18,565</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">929</td><td class="metric-value">156.96</td><td>6</td><td>2,223</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">880</td><td class="metric-value">183.82</td><td>6</td><td>39,710</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT COUNT(*) from sys.sql_modules  WITH (NOLOCK)">SELECT COUNT(*) from sys.sql_modules  WITH (NOLOCK)</td><td class="metric-value">865</td><td class="metric-value">151.91</td><td>6</td><td>43,410</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">768</td><td class="metric-value">129.18</td><td>6</td><td>650</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_AHEC_Conversion</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmountDue, LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmoun...</td><td class="metric-value">144,371</td><td class="metric-value">5,570.28</td><td>33</td><td>860,903</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue), AmountDue = IIF(AmountDue&gt;CurrentBalance, AmountDue - CurrentBalance, 0), LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue),...</td><td class="metric-value">80,628</td><td class="metric-value">2,541.28</td><td>33</td><td>505,103</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.AffectsBalance,0)), 0)
    FROM AccountTransaction AS AT
    INNER JOIN AccountTransactionType AS ATT
              ON ATT.AccountTransactionTypeID=AT.AccountTransactionTypeID
    WHERE AT.AccountID=@AccountID
          AND CommittedDateTime IS NOT NULL
          AND VoidedDateTime IS NULL
          AND ArchivedDateTime IS NULL">SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.A...</td><td class="metric-value">37,664</td><td class="metric-value">0.09</td><td>532,741</td><td>13</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="INSERT @G
                (  
                   GuestID,
                   DisplayName,
                   LastName,
                   FirstName,
                   IsActive,
                   PreferredFirstName,
                   Batch
                )
                SELECT DISTINCT
                       Guest.GuestID,
                       Guest.DisplayName,
                       Guest.LastName,
                       Guest.FirstName,
                       Guest.IsActive,
                       Guest.PreferredFirstName,
                       0 -- Initial batch value set to 0  

                FROM Guest (nolock)
                LEFT OUTER JOIN Ticket AS T2 (nolock)
                          ON T2.GuestID=Guest.GuestID AND T2.SalonID=@SalonID
                WHERE (Guest.IsActive=1 OR @IncludeInactive=1)
                      AND Guest.DisplayName NOT LIKE 'T:%'
                      AND Guest.DisplayName NOT LIKE '%(T:%'
                      AND (@SalonID IS NULL
                            OR @SalonID&lt;0
                            OR T2.TicketID IS NOT NULL)
                      AND ((@MatchByCode IS NOT NULL AND Guest.Code LIKE @MatchByCode)
                            OR (@MatchByLastName IS NOT NULL
                                AND (Guest.LastName LIKE  @MatchByLastName 
                                      OR Guest.FirstName LIKE  @MatchByLastName 
                                      OR Guest.PreferredFirstName LIKE @MatchByLastName
                                      OR Guest.DisplayName LIKE REPLACE(@MatchByLastName, ' ', '% ') + '%'
                                      OR (@MatchByLastName LIKE '%@%'
                                          AND Guest.EmailAddress LIKE @MatchByLastName + '%'
                                          AND Guest.EmailAddress IS NOT NULL)))
                            OR (@MatchByPhoneNumber IS NOT NULL
                                AND (Guest.PhoneNumber_Home LIKE @MatchByPhoneNumber
                                      OR Guest.PhoneNumber_Auxiliary LIKE @MatchByPhoneNumber
                                      OR Guest.Code LIKE @MatchByPhoneNumber))) ORDER BY Guest.LastName, Guest.FirstName">INSERT @G
                (  
                   GuestID,
                   DisplayName,
      ...</td><td class="metric-value">11,182</td><td class="metric-value">301.73</td><td>48</td><td>8,912</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE SalonBusinessDayTerminal SET TotalSales_ToDate_Terminal = COALESCE(TotalSales_Terminal, 0) + COALESCE((SELECT TOP 1
                                                                                                                       COALESCE(TotalSales_ToDate_Terminal, 0)
                                                                                                                FROM SalonBusinessDayTerminal AS SBDT
                                                                                                                INNER JOIN SalonBusinessDay AS SBD
                                                                                                                          ON SBD.SalonBusinessDayID=SBDT.SalonBusinessDayID
                                                                                                                WHERE SBD2.SalonID=SBD.SalonID
                                                                                                                      AND SBDT2.TerminalID=SBDT.TerminalID
                                                                                                                      AND SBDT.CloseDateTime&lt;SBDT2.CloseDateTime
                                                                                                                ORDER BY SBDT.CloseDateTime DESC), 0)
  FROM SalonBusinessDayTerminal AS SBDT2
  INNER JOIN SalonBusinessDay AS SBD2
            ON SBD2.SalonBusinessDayID=SBDT2.SalonBusinessDayID
  WHERE SBDT2.SalonBusinessDayTerminalID=@SBDT">UPDATE SalonBusinessDayTerminal SET TotalSales_ToDate_Terminal = COALESCE(TotalSales_Terminal, 0) + ...</td><td class="metric-value">8,725</td><td class="metric-value">8.82</td><td>1,000</td><td>326</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT AccountTransactionID,
           AT.Name,
           Amount,
           ReceivedDateTime,
           CommittedDateTime,
           VoidedDateTime,
           EffectiveDateTime,
           ExpirationDateTime,
           ReversedDateTime,
           AT.AccountID,
           A.Name AS AcccountName,
           PR.Name AS ProductName,
           AT.Notes,
		   ProductID, --Hannah 12-2-23
		   AccountTransactionTypeID
    FROM AccountTransaction AS AT
    LEFT OUTER JOIN Account AS A
              ON A.AccountID=AT.AccountID
    LEFT OUTER JOIN Person AS P
              ON P.PersonID=A.PersonID
    LEFT OUTER JOIN Product AS PR
              ON AT.POSProductGlobalKey=PR.ProductGlobalKey
    WHERE (@PersonID=A.PersonID OR ISNULL(@PersonID, -1)&lt;0) AND (@RestrictToIsActive=0 OR AT.IsActive=1)">SELECT AccountTransactionID,
           AT.Name,
           Amount,
           ReceivedDateTime,...</td><td class="metric-value">7,726</td><td class="metric-value">351.55</td><td>31</td><td>5,361</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = InitialBalance
    FROM Account
    WHERE AccountID=@AccountID">SELECT @Total = InitialBalance
    FROM Account
    WHERE AccountID=@AccountID</td><td class="metric-value">6,889</td><td class="metric-value">0.02</td><td>532,741</td><td>3</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,010</td><td class="metric-value">1,056.37</td><td>6</td><td>202,876</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT P.PersonID,
           FirstName,
           PreferredFirstName,
           LastName,
           DisplayName,
           PhoneNumber_Mobile,
           PhoneNumber_Home,
           PhoneNumber_Work,
           P.EmailAddress,
           '' AS IdentityString,
           P.AddressLine1,
           P.AddressLine2,
           P.City,
           P.StateID,
           P.PostalCode,
           P.Name,
           OptInForEmail,
           OptInForText,
           ConfirmedInformation,
           BadgeNumber,
           InternalIDNumber,
           P.IsActive,
           BirthDate,
           LocationID_Primary,
           FID,
           P.TuitionPaymentTypeID,
           PersonRoleID_Default,
           L.Name AS LocationName,
           TPT.Name AS TuitionPaymentTypeName,
           PR.Name AS PersonRoleName,
           S.StateCode AS StateCode,
           B.BadgeID,
		   P.Sponsor, --HD 11-14-23
		   P.HireDate, --Hannah 12-14-23
		   P.TermDate, 
		   P.ContractNumber, --Hannah 12-26-23
		    P.StudentGroupID, --Hannah 2-13-24
			SG.Name as StudentGroupName,
		   P.Pin, --Hannah 7-29-24
		   P.PermitExpirationDate,--hannah 3-13-25
		   B.StatusText_Override --hannah 4-24-25
    FROM Person AS P
    LEFT OUTER JOIN Location AS L
              ON L.LocationID=LocationID_Primary
    LEFT OUTER JOIN TuitionPaymentType AS TPT
              ON TPT.TuitionPaymentTypeID=P.TuitionPaymentTypeID
    LEFT OUTER JOIN PersonRole AS PR
              ON PR.PersonRoleID=PersonRoleID_Default
    LEFT OUTER JOIN State AS S
              ON S.StateID=P.StateID
    LEFT OUTER JOIN Badge AS B
              ON B.PersonID=P.PersonID
	LEFT OUTER JOIN StudentGroup as SG on SG.StudentGroupID = P.StudentGroupID
    WHERE (ISNULL(@PersonID, -1)&lt;0 OR P.PersonID=@PersonID)">SELECT P.PersonID,
           FirstName,
           PreferredFirstName,
           LastName,
   ...</td><td class="metric-value">4,804</td><td class="metric-value">351.88</td><td>20</td><td>17,122</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_AHEC_Conversion</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">4,704</td><td class="metric-value">889.70</td><td>6</td><td>257,162</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_AHEC_Conversion090825TEST</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_AHEC_Conversion090825TEST</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">3</td><td class="metric-value">70.72</td><td>4</td><td>16</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_AHEC_Conversion090825TEST</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS                             	JOIN sys.plan_persist_runtime_stats_interval I                  	ON WS.runtime_stats_interval_id = I.runtime_stats_interval_id   	WHERE I.end_time &lt; @threshold_time">DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS...</td><td class="metric-value">3</td><td class="metric-value">28.88</td><td>4</td><td>26</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_AHEC_Conversion090825TEST</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_runtime_stats_interval WHERE end_time &lt; @clean_up_time">DELETE sys.plan_persist_runtime_stats_interval WHERE end_time &lt; @clean_up_time</td><td class="metric-value">1</td><td class="metric-value">18.01</td><td>1</td><td>23</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_AHEC_Conversion090825TEST</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_AHEC_Conversion090825TEST].[sys].[filetable_updates_1890574269] with (readpast) order by table_id">select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_AHEC_Conversion090...</td><td class="metric-value">0</td><td class="metric-value">0.08</td><td>1</td><td>0</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Badge_Multicard</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,327</td><td class="metric-value">1,095.71</td><td>6</td><td>223,441</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">4,100</td><td class="metric-value">1,536.89</td><td>4</td><td>97,947</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">3,614</td><td class="metric-value">1,810.02</td><td>2</td><td>2,096,013</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,883</td><td class="metric-value">552.65</td><td>6</td><td>157,464</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,259</td><td class="metric-value">716.30</td><td>6</td><td>1,359</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,172</td><td class="metric-value">404.48</td><td>6</td><td>50,487</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,115</td><td class="metric-value">438.99</td><td>6</td><td>20,368</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">963</td><td class="metric-value">160.80</td><td>6</td><td>2,171</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">827</td><td class="metric-value">165.57</td><td>6</td><td>39,650</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Badge_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">744</td><td class="metric-value">124.24</td><td>6</td><td>627</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_BadgeDemo</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">6,024</td><td class="metric-value">1,528.75</td><td>6</td><td>97,723</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,302</td><td class="metric-value">1,100.42</td><td>6</td><td>223,278</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">3,611</td><td class="metric-value">1,807.93</td><td>2</td><td>2,096,003</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,765</td><td class="metric-value">534.39</td><td>6</td><td>157,507</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,288</td><td class="metric-value">732.48</td><td>6</td><td>1,350</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,192</td><td class="metric-value">414.64</td><td>6</td><td>50,489</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,112</td><td class="metric-value">442.19</td><td>6</td><td>18,597</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">939</td><td class="metric-value">156.80</td><td>6</td><td>2,169</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">805</td><td class="metric-value">167.85</td><td>6</td><td>39,663</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_BadgeDemo</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">754</td><td class="metric-value">125.82</td><td>6</td><td>626</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_CheckIn_SchoolVision</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,331</td><td class="metric-value">1,097.68</td><td>6</td><td>224,187</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,954</td><td class="metric-value">1,517.20</td><td>4</td><td>139,465</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,902</td><td class="metric-value">555.74</td><td>6</td><td>165,664</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,308</td><td class="metric-value">695.67</td><td>6</td><td>1,388</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,145</td><td class="metric-value">400.87</td><td>6</td><td>52,677</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,088</td><td class="metric-value">439.09</td><td>6</td><td>20,080</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">953</td><td class="metric-value">159.87</td><td>6</td><td>2,213</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">805</td><td class="metric-value">165.55</td><td>6</td><td>39,665</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">751</td><td class="metric-value">125.33</td><td>6</td><td>650</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_CheckIn_SchoolVision</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">690</td><td class="metric-value">347.27</td><td>2</td><td>130,214</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Coastal</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">11,224</td><td class="metric-value">1,053.56</td><td>13</td><td>195,214</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">11,002</td><td class="metric-value">977.74</td><td>13</td><td>256,366</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">7,665</td><td class="metric-value">1,177.39</td><td>7</td><td>140,233</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">4,663</td><td class="metric-value">550.85</td><td>12</td><td>1,402</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">1,479</td><td class="metric-value">139.85</td><td>13</td><td>29,765</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS FunctionName, 
p.name AS FunctionOwner,
ss.name AS SchemaName,
s.object_id AS id,
s.modify_date as LastModified,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
s.type AS FunctionType,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted
FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'IF', N'FN', N'TF', N'FT', N'FS', N'AF') AND
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)">SELECT s.name AS FunctionName, 
p.name AS FunctionOwner,
ss.name AS SchemaName,
s.object_id AS id...</td><td class="metric-value">902</td><td class="metric-value">106.39</td><td>13</td><td>7,396</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ViewName, 
c.object_id AS ParentObjectId,
c.name AS ColumnName, sc.name AS ViewOwner,
c.column_id AS ColumnID, 
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn
FROM sys.objects t WITH (NOLOCK) 
INNER JOIN sys.columns c WITH (NOLOCK)  ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK)  ON sc.schema_id=t.schema_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
WHERE t.type = 'V'
AND t.is_ms_shipped = 0
ORDER BY c.object_id, c.column_id">SELECT t.name AS ViewName, 
c.object_id AS ParentObjectId,
c.name AS ColumnName, sc.name AS ViewOw...</td><td class="metric-value">693</td><td class="metric-value">137.28</td><td>6</td><td>2,662</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT COUNT(*) from sys.sql_modules  WITH (NOLOCK)">SELECT COUNT(*) from sys.sql_modules  WITH (NOLOCK)</td><td class="metric-value">673</td><td class="metric-value">60.54</td><td>13</td><td>8,306</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="with cte_sum as (																													select																																	r.plan_id,																															sum(case when (execution_type = 0 or @accountAbortedFlag = 1) then count_executions	else 0 end) as sum_count_executions,			sum(case when execution_type in (3,4) then count_executions  else 0 end) as sum_count_aborted,										sum(case when (execution_type = 0 or @accountAbortedFlag = 1) then total_cpu_time else 0 end) as sum_cpu_time,						sum(case when (execution_type = 0 or @accountAbortedFlag = 1)																				 then sumsquare_cpu_time  else 0 end) / @APRC_SUM_SQUARE_CPU_SCALE as sumsquare_cpu_time								from sys.plan_persist_runtime_stats_merged as r with(nolock)																		join @plans as p on r.plan_id = p.plan_id																							join @intervals as i on r.runtime_stats_interval_id = i.interval_id																	where execution_type in (0,3,4)																										group by r.plan_id)																													select top(1)																															@bestPlanId = plan_id,																												@sumBestCountExecutions = sum_count_executions,																						@sumBestCountAborted = sum_count_aborted,																							@sumBestCpuTime = sum_cpu_time,																										@sumBestSquareCpuTime = sumsquare_cpu_time																						from cte_sum																														where sum_count_executions &gt;= @minBestExecutionCount																				order by sum_count_aborted, sum_cpu_time / sum_count_executions desc">with cte_sum as (																													select																																	r.plan_id,					...</td><td class="metric-value">576</td><td class="metric-value">41.20</td><td>14</td><td>1,302</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Coastal</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT ss.name AS DefaultOwner, o.name AS DefaultName, sm.definition AS Text, o.object_id AS id
FROM sys.objects o WITH (NOLOCK)
LEFT JOIN sys.schemas ss WITH (NOLOCK)  ON o.schema_id=ss.schema_id
INNER JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=o.object_id
WHERE o.type = 'D' AND o.parent_object_id = 0
ORDER BY o.name">SELECT ss.name AS DefaultOwner, o.name AS DefaultName, sm.definition AS Text, o.object_id AS id
FRO...</td><td class="metric-value">538</td><td class="metric-value">42.04</td><td>13</td><td>677</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_CoastalAB</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_wait_stats WHERE plan_id = @plan_id">DELETE sys.plan_persist_wait_stats WHERE plan_id = @plan_id</td><td class="metric-value">513</td><td class="metric-value">26.04</td><td>55</td><td>30</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmountDue, LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmoun...</td><td class="metric-value">453</td><td class="metric-value">36.36</td><td>21</td><td>3,377</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE AccountTransaction SET Amount = 0, POSDetails = CASE  
                                                           WHEN POSDetails NOT LIKE '%Voided (POS)%' THEN 'Voided (POS)--' + POSDetails  
                                                           ELSE POSDetails  
                                                       END, VoidedDateTime = GETDATE()  
WHERE POSTransactionID IN(SELECT TransactionID  
                          FROM POS_Transaction_Voided AS V  
                          WHERE AccountTransaction.POSLocationID=V.LocationID) AND POSDetails NOT LIKE '%Voided (POS)--%'">UPDATE AccountTransaction SET Amount = 0, POSDetails = CASE  
                                     ...</td><td class="metric-value">404</td><td class="metric-value">11.69</td><td>65</td><td>46</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">327</td><td class="metric-value">335.71</td><td>2</td><td>11,454</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue), AmountDue = IIF(AmountDue&gt;CurrentBalance, AmountDue - CurrentBalance, 0), LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue),...</td><td class="metric-value">287</td><td class="metric-value">25.56</td><td>21</td><td>682</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="FETCH NEXT FROM cur INTO @TableName, @ColumnName;
    ">FETCH NEXT FROM cur INTO @TableName, @ColumnName;
    </td><td class="metric-value">286</td><td class="metric-value">0.81</td><td>746</td><td>82</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT A.accountid, P.*  
INTO #T  
FROM POS_Transaction AS P  
INNER JOIN account AS a  
          ON a.badgenumber_pos=P.Code">SELECT A.accountid, P.*  
INTO #T  
FROM POS_Transaction AS P  
INNER JOIN account AS a  
      ...</td><td class="metric-value">224</td><td class="metric-value">21.19</td><td>16</td><td>500</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_wait_stats WHERE plan_id IN (SELECT plan_id FROM sys.plan_persist_plan WHERE query_id = @query_id)">DELETE sys.plan_persist_wait_stats WHERE plan_id IN (SELECT plan_id FROM sys.plan_persist_plan WHERE...</td><td class="metric-value">200</td><td class="metric-value">38.22</td><td>13</td><td>32</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE ProductInventory SET BackStockQuantity = CASE
                                                              WHEN setasfinal=1 AND AffectsBackStockQuantity&lt;&gt;0 THEN 0
                                                              ELSE ISNULL(BackStockQuantity, 0)
                                                          END + ISNULL(CASE
                                                                           WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                           ELSE QuantityAffected
                                                                       END * AffectsBackStockQuantity, 0),
                                      BackBarQuantity = CASE
                                                            WHEN setasfinal=1 AND AffectsBackBarQuantity&lt;&gt;0 THEN 0
                                                            ELSE ISNULL(BackBarQuantity, 0)
                                                        END + ISNULL(CASE
                                                                         WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                         ELSE QuantityAffected
                                                                     END * AffectsBackBarQuantity, 0),
                                      RetailQuantity = CASE
                                                           WHEN setasfinal=1 AND AffectsRetailQuantity&lt;&gt;0 THEN 0
                                                           ELSE ISNULL(RetailQuantity, 0)
                                                       END + ISNULL(CASE
                                                                        WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                        ELSE QuantityAffected
                                                                    END * AffectsRetailQuantity, 0),
                                      RecommendedRequestQuantity = CASE
                                                                       WHEN setasfinal=1 AND AffectsRecommendedRequestQuantity&lt;&gt;0 THEN 0
                                                                       ELSE ISNULL(RecommendedRequestQuantity, 0)
                                                                   END + ISNULL(CASE
                                                                                    WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                                    ELSE QuantityAffected
                                                                                END * AffectsRecommendedRequestQuantity, 0),
                                      RequestQuantity = CASE
                                                            WHEN setasfinal=1 AND AffectsRequestQuantity&lt;&gt;0 THEN 0
                                                            ELSE ISNULL(RequestQuantity, 0)
                                                        END + ISNULL(CASE
                                                                         WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                         ELSE QuantityAffected
                                                                     END * AffectsRequestQuantity, 0),  
                                     --LastQuantityRequested = 
                                     --		Case when setasfinal = 1 and AffectsLastQuantityRequested &lt;&gt; 0  then 0 else IsNull(  LastQuantityRequested,0) end + IsNull(Case When UseAbsoluteValues = 1 then Abs(QuantityAffected) Else QuantityAffected End * AffectsLastQuantityRequested,0),
                                     --	LastQuantityReceived = 
                                     --		Case when setasfinal = 1 and AffectsLastQuantityReceived &lt;&gt; 0  then 0 else  IsNull( LastQuantityReceived,0) end +IsNull( Case When UseAbsoluteValues = 1 then Abs(QuantityAffected) Else QuantityAffected End * AffectsLastQuantityReceived,0),
                                     DistributeQuantity = CASE
                                                              WHEN setasfinal=1 AND AffectsDistributeQuantity&lt;&gt;0 THEN 0
                                                              ELSE ISNULL(DistributeQuantity, 0)
                                                          END + ISNULL(CASE
                                                                           WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                           ELSE QuantityAffected
                                                                       END * AffectsDistributeQuantity, 0),
                                      OnOrderQuantity = CASE
                                                            WHEN setasfinal=1 AND AffectsOnOrderQuantity&lt;&gt;0 THEN 0
                                                            ELSE ISNULL(OnOrderQuantity, 0)
                                                        END + ISNULL(CASE
                                                                         WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                         ELSE QuantityAffected
                                                                     END * AffectsOnOrderQuantity, 0),
                                      BackOrderedQuantity = CASE
                                                                WHEN setasfinal=1 AND AffectsBackOrderedQuantity&lt;&gt;0 THEN 0
                                                                ELSE ISNULL(BackOrderedQuantity, 0)
                                                            END + ISNULL(CASE
                                                                             WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                             ELSE QuantityAffected
                                                                         END * AffectsBackOrderedQuantity, 0),  
                                     --RecommendedOrderQuantity = 
                                     --	Case when setasfinal = 1 and AffectsRecommendedOrderQuantity &lt;&gt; 0  then 0 else  IsNull( RecommendedOrderQuantity ,0)end +IsNull( Case When UseAbsoluteValues = 1 then Abs(QuantityAffected) Else QuantityAffected End * AffectsRecommendedOrderQuantity,0),
                                     PendingOrderQuantity = CASE
                                                                WHEN setasfinal=1 AND AffectsPendingOrderQuantity&lt;&gt;0 THEN 0
                                                                ELSE ISNULL(PendingOrderQuantity, 0)
                                                            END + ISNULL(CASE
                                                                             WHEN UseAbsoluteValues=1 THEN ABS(QuantityAffected)
                                                                             ELSE QuantityAffected
                                                                         END * AffectsPendingOrderQuantity, 0),
                                      ProductInventoryVersion = ISNULL(ProductInventory.ProductInventoryVersion, 0) + 1
          FROM ProductInventory
          INNER JOIN @tmpUpdate AS T
                    ON T.SalonID=ProductInventory.SalonID AND T.ProductID=ProductInventory.ProductID
          INNER JOIN ProductInventoryActionType AS PIAT
                    ON PIAT.ProductInventoryActionTypeID=T.ProductInventoryActionTypeID">UPDATE ProductInventory SET BackStockQuantity = CASE
                                              ...</td><td class="metric-value">175</td><td class="metric-value">44.07</td><td>4</td><td>224</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_CoastalAB</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                        FROM Ticket AS T
                                        INNER JOIN Guest AS G2
                                                  ON G2.GuestID=T.GuestID
                                        INNER JOIN TicketLineItem AS TLI
                                                  ON T.TicketID=TLI.TicketID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Product AS P
                                                  ON P.ProductID=TLI.ProductID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Salon AS S
                                                  ON S.SalonID=T.SalonID
                                        WHERE G2.GuestID=@GuestID
                                              AND T.TicketStatusID=@TicketStatusID_CheckedOut
                                              AND dbo.Date_IsThisWeek(T.EndDateTime, 1)=1
                                              --and P.MaxPurchaseCountPerDay&gt;0 --Hannah 4-20-23 only count tickets with maxcounts

                                              AND (S.VisitCount_OnlyMaxPurchaseProducts=0 OR P.MaxPurchaseCountPerDay&gt;0)--11-2-23 fix to add field to control max purchase count
                                              ), ServiceTotal = (SELECT SUM(NetServiceAmount)
                                                                 FROM Ticket AS T
                                                                 INNER JOIN Guest AS G2
                                                                           ON G2.GuestID=T.GuestID
                                                                 WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut), ProductTotal = (SELECT SUM(NetProductAmount)
                                                                                                                                                             FROM Ticket AS T
                                                                                                                                                             INNER JOIN Guest AS G2
                                                                                                                                                                       ON G2.GuestID=T.GuestID
                                                                                                                                                             WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut)
FROM Guest AS G
WHERE G.GuestID=@GuestID">UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                   ...</td><td class="metric-value">135</td><td class="metric-value">28.22</td><td>5</td><td>3,227</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Copiague</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
           P.PersonID,
           FirstName,
           LastName,
           Phone,
           Phone2,
           P.EmailAddress,
           StartDate,
           EndDate,
           ISNULL(CONVERT(INT, P.IsAvailable) * CONVERT(INT, L.IsActive) * CONVERT(INT, CONVERT(BIT, (SELECT MAX(CONVERT(INT, IsActive))
                                                                                                      FROM Person_PersonRole AS PPR2
                                                                                                      WHERE PPR2.PersonID=P.PersonID))), 0) AS IsAvailable,
           P.PhotoFileName,
           P.AddressLine1,
           P.AddressLine2,
           P.City,
           P.StateID,
           ST.StateCode,
           P.PostalCode,
           CONVERT(BIT, CASE
                            WHEN P.EmailAddress='hannah@schoolvision.net' OR PR.CanBeMonitor=1 THEN 1
                            ELSE 0
                        END) -- (select count(*)  from Person_PersonRole as PPR2
          --inner join Person as P2 on P2.PersonID = PPR2.PersonID
          --inner join PersonRole as PR2 on PR2.PersonRoleID = PPR2.PersonRoleID
          --inner join Location as L2 on L2.LocationID = PPR2.LocationID
          --where PR2.Name &lt;&gt; 'Member'
          --and P2.PersonID = P.PersonID
          --and L2.LocationID = L.LocationID) 
          AS CanBeMonitor,
           P.Code,
           P.IsEventEligible --Hannah 11-16-23

    FROM Person_PersonRole AS PPR
    INNER JOIN Person AS P
              ON P.PersonID=PPR.PersonID
    INNER JOIN PersonRole AS PR
              ON PR.PersonRoleID=PPR.PersonRoleID
    INNER JOIN Location AS L
              ON L.LocationID=PPR.LocationID
    INNER JOIN PersonStatus AS PS
              ON PS.PersonStatusID=P.PersonStatusID
    LEFT OUTER JOIN SecurityProfile AS SP
              ON SP.SecurityProfileID=PPR.SecurityProfileID
    LEFT OUTER JOIN State AS ST
              ON ST.StateID=P.StateID
    WHERE (P.Code LIKE @PersonCode
            OR @PersonCode IS NULL
            OR @PersonCode=''
            OR P.EmailAddress=@PersonCode)
          AND (L.LocationID=@LocationID
                OR @LocationID&lt;0
                OR @LocationID IS NULL)
          AND (P.PersonID=@PersonID
                OR @PersonID&lt;0
                OR @PersonID IS NULL)">SELECT DISTINCT
           P.PersonID,
           FirstName,
           LastName,
           Pho...</td><td class="metric-value">26,018</td><td class="metric-value">6.34</td><td>4,516</td><td>32</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
           P.PersonID,
           P.DisplayName,
           PR.PersonRoleID,
           PR.Name AS PersonRoleName,
           IsPaid,
           CASE
               WHEN IsPaid=1 THEN 'Paid'
               ELSE NULL
           END AS PaidStatus,
           L.LocationID,
           L.Name AS LocationName,
           PPR.SecurityProfileID,
           SP.Name,
           CONVERT(BIT, CONVERT(INT, PPR.IsActive) * CONVERT(INT, L.IsActive)) AS IsActive,
           MAX(PersonPersonRoleID) AS PersonPersonRoleID
    FROM Person_PersonRole AS PPR
    INNER JOIN Person AS P
              ON P.PersonID=PPR.PersonID
    INNER JOIN PersonRole AS PR
              ON PR.PersonRoleID=PPR.PersonRoleID
    INNER JOIN Location AS L
              ON L.LocationID=PPR.LocationID
    LEFT OUTER JOIN SecurityProfile AS SP
              ON SP.SecurityProfileID=PPR.SecurityProfileID
    WHERE (P.Code LIKE @PersonCode
            OR @PersonCode IS NULL
            OR @PersonCode='')
          AND (L.LocationID=@LocationID
                OR @LocationID&lt;0
                OR @LocationID IS NULL)
          AND (P.PersonID=@PersonID
                OR @PersonID&lt;0
                OR @PersonID IS NULL)
          AND (L.LocationTypeName='Club' OR @ClubsOnly=0)
          AND L.IsActive=1
          AND (L.Name='Admin' OR PR.Name NOT LIKE 'Admin%')
    GROUP BY P.PersonID, P.DisplayName, PR.PersonRoleID, PR.Name, IsPaid, CASE
                                                                              WHEN IsPaid=1 THEN 'Paid'
                                                                              ELSE NULL
                                                                          END, L.LocationID, L.Name, PPR.SecurityProfileID, SP.Name, PPR.IsActive, L.IsActive
    ORDER BY L.Name, PR.Name">SELECT DISTINCT
           P.PersonID,
           P.DisplayName,
           PR.PersonRoleID,
   ...</td><td class="metric-value">23,660</td><td class="metric-value">5.82</td><td>4,516</td><td>26</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,502</td><td class="metric-value">1,153.90</td><td>6</td><td>227,221</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,969</td><td class="metric-value">1,535.64</td><td>4</td><td>140,248</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sp.major_id AS id, 
so.name AS ObjectName, 
sys.schemas.name AS ObjectOwner,  
so.type AS ObjectType, 
sp.minor_id AS smallid,  
sp.name AS PropertyName, 
sp.value AS PropertyValue,
CAST(sp.value AS varbinary(MAX)) AS PropertyValueBinary,
sql_variant_property(sp.value,'BaseType') AS PropertyValueBaseType,
sql_variant_property(sp.value,'Precision') AS PropertyValuePrecision,
sql_variant_property(sp.value,'Scale') AS PropertyValueScale,
CASE WHEN sql_variant_property(sp.value,'BaseType') IN (N'nchar', N'nvarchar') THEN CAST(sql_variant_property(sp.value,'MaxLength') AS INT)/2 ELSE sql_variant_property(sp.value,'MaxLength') END AS PropertyValueMaxLength,
CASE sp.class WHEN 4 THEN USER_NAME(sp.major_id) END AS UserName,
CASE sp.class 
	WHEN 6 THEN (SELECT TOP 1 name FROM sys.types sst WITH (NOLOCK) WHERE sst.user_type_id=sp.major_id)
	WHEN 8 THEN (SELECT TOP 1 name FROM sys.types sst WITH (NOLOCK) WHERE sst.user_type_id=sp.major_id) 
END AS UDTName,
CASE sp.class 
	WHEN 6 THEN (SELECT TOP 1 sys.schemas.name FROM sys.schemas WITH (NOLOCK) INNER JOIN sys.types WITH (NOLOCK) ON sys.types.schema_id=sys.schemas.schema_id WHERE sys.types.user_type_id=sp.major_id)
	WHEN 8 THEN (SELECT TOP 1 sys.schemas.name FROM sys.schemas WITH (NOLOCK) INNER JOIN sys.types WITH (NOLOCK) ON sys.types.schema_id=sys.schemas.schema_id WHERE sys.types.user_type_id=sp.major_id) 
END AS UDTOwner,
CASE sp.class
    WHEN  3 THEN (SELECT TOP 1 ss2.name as a FROM sys.schemas ss2 WITH (NOLOCK) WHERE ss2.schema_id = sp.major_id)
    WHEN  5 THEN (SELECT TOP 1 sa2.name as a FROM sys.assemblies sa2 WITH (NOLOCK) WHERE sa2.assembly_id = sp.major_id)
    WHEN 10 THEN (SELECT TOP 1 sxsc2.name as a FROM sys.xml_schema_collections sxsc2 WITH (NOLOCK) WHERE sxsc2.xml_collection_id = sp.major_id) COLLATE database_default
    WHEN 15 THEN (SELECT TOP 1 smt2.name FROM sys.service_message_types smt2 WITH (NOLOCK) WHERE smt2.message_type_id = sp.major_id)
    WHEN 16 THEN (SELECT TOP 1 ssc2.name FROM sys.service_contracts ssc2 WITH (NOLOCK) WHERE ssc2.service_contract_id = sp.major_id)
    WHEN 17 THEN (SELECT TOP 1 ss2.name FROM sys.services ss2 WITH (NOLOCK) WHERE ss2.service_id = sp.major_id)
    WHEN 18 THEN (SELECT TOP 1 srs2.name FROM sys.remote_service_bindings srs2 WITH (NOLOCK) WHERE srs2.remote_service_binding_id = sp.major_id)
    WHEN 19 THEN (SELECT TOP 1 sr2.name FROM sys.routes sr2 WITH (NOLOCK) WHERE sr2.route_id = sp.major_id)
    WHEN 20 THEN (SELECT TOP 1 sps2.name FROM sys.partition_schemes sps2 WITH (NOLOCK) WHERE sps2.data_space_id = sp.major_id)
    WHEN 21 THEN (SELECT TOP 1 spf2.name FROM sys.partition_functions spf2 WITH (NOLOCK) WHERE spf2.function_id = sp.major_id)
    ELSE CAST(NULL AS sysname)
END AS YukonObjectName,
CASE sp.class 
    WHEN 10 THEN SCHEMA_NAME(( SELECT TOP 1 sx2.schema_id FROM sys.xml_schema_collections sx2 WITH (NOLOCK) WHERE sx2.xml_collection_id = sp.major_id))
    WHEN 6 THEN SCHEMA_NAME((SELECT TOP 1 st2.schema_id FROM sys.types st2 WITH (NOLOCK) WHERE st2.user_type_id = sp.major_id))
    WHEN 8 THEN SCHEMA_NAME((SELECT TOP 1 st2.schema_id FROM sys.types st2 WITH (NOLOCK) WHERE st2.user_type_id = sp.major_id))
ELSE 
USER_NAME(CASE sp.class 
    WHEN 3 THEN (SELECT TOP 1 sch2.principal_id FROM sys.schemas sch2 WITH (NOLOCK) WHERE sch2.schema_id = sp.major_id)
    WHEN 4 THEN (SELECT TOP 1 sp2.owning_principal_id FROM sys.database_principals sp2 WITH (NOLOCK) WHERE sp2.principal_id = sp.major_id)
    WHEN 5 THEN (SELECT TOP 1 sa2.principal_id FROM sys.assemblies sa2 WITH (NOLOCK) WHERE sa2.assembly_id = sp.major_id)
    WHEN 15 THEN (SELECT TOP 1 smt2.principal_id FROM sys.service_message_types smt2 WITH (NOLOCK) WHERE smt2.message_type_id = sp.major_id)
    WHEN 16 THEN (SELECT TOP 1 ssc2.principal_id FROM sys.service_contracts ssc2 WITH (NOLOCK) WHERE ssc2.service_contract_id = sp.major_id)
    WHEN 17 THEN (SELECT TOP 1 ss2.principal_id FROM sys.services ss2 WITH (NOLOCK) WHERE ss2.service_id = sp.major_id)
    WHEN 18 THEN (SELECT TOP 1 srs2.principal_id FROM sys.remote_service_bindings srs2 WITH (NOLOCK) WHERE srs2.remote_service_binding_id = sp.major_id)
    WHEN 19 THEN (SELECT TOP 1 sr2.principal_id FROM sys.routes sr2 WITH (NOLOCK) WHERE sr2.route_id = sp.major_id)
    WHEN 23 THEN (SELECT TOP 1 sft2.principal_id FROM sys.fulltext_catalogs sft2 WITH (NOLOCK) WHERE sft2.fulltext_catalog_id = sp.major_id)
    WHEN 24 THEN (SELECT TOP 1 ssk2.principal_id FROM sys.symmetric_keys ssk2 WITH (NOLOCK) WHERE ssk2.symmetric_key_id = sp.major_id)
    WHEN 26 THEN (SELECT TOP 1 sak2.principal_id FROM sys.asymmetric_keys sak2 WITH (NOLOCK) WHERE sak2.asymmetric_key_id = sp.major_id)
    WHEN 25 THEN (SELECT TOP 1 sc2.principal_id FROM sys.certificates sc2 WITH (NOLOCK) WHERE sc2.certificate_id = sp.major_id)
    ELSE CAST(NULL AS sysname)
END)
END AS YukonObjectOwner,
CASE sp.class
    WHEN 2 then spar.name
    WHEN 8 then (SELECT TOP 1 sc.name 
                 FROM sys.extended_properties ep  WITH (NOLOCK) 
                 INNER JOIN sys.table_types t WITH (NOLOCK) ON ep.major_id = t.user_type_id 
                 INNER JOIN sys.columns AS sc WITH (NOLOCK) ON t.type_table_object_id = sc.object_id AND ep.minor_id = sc.column_id 
                 WHERE sp.major_id = ep.major_id AND sp.minor_id = ep.minor_id)
    ELSE sc.name
END AS FieldName,
si.name AS IndexName,
pso.name AS ParentName,
pu.name AS ParentOwner,
pso.type AS ParentType,
sp.class AS type,
ddlt.name AS DdlTriggerName,
en.name AS EventNotificiationName,
qensq.name AS ENQueueName,
qensqs.name AS ENQueueSchema

FROM sys.extended_properties AS sp WITH (NOLOCK) 
LEFT JOIN sys.objects  AS so WITH (NOLOCK) ON so.object_id=sp.major_id
LEFT JOIN sys.schemas  WITH (NOLOCK) ON sys.schemas.schema_id=so.schema_id
LEFT JOIN sys.columns AS sc WITH (NOLOCK) ON sc.object_id=sp.major_id AND sc.column_id=sp.minor_id
LEFT JOIN sys.parameters AS spar WITH (NOLOCK) ON spar.object_id=sp.major_id AND spar.parameter_id=sp.minor_id
LEFT JOIN sys.indexes si WITH (NOLOCK) ON si.object_id=sp.major_id AND si.index_id=sp.minor_id
LEFT JOIN sys.objects pso  WITH (NOLOCK) ON so.parent_object_id=pso.object_id
LEFT JOIN sys.schemas pu  WITH (NOLOCK) ON pso.schema_id=pu.schema_id
LEFT JOIN sys.triggers  AS ddlt WITH (NOLOCK) ON ddlt.object_id=sp.major_id
LEFT JOIN sys.event_notifications  AS en WITH (NOLOCK) ON en.object_id=sp.major_id
LEFT JOIN sys.service_queues  AS qensq WITH (NOLOCK) ON qensq.object_id=en.parent_id
LEFT JOIN sys.schemas AS qensqs WITH (NOLOCK) ON qensqs.schema_id=qensq.SCHEMA_ID">SELECT sp.major_id AS id, 
so.name AS ObjectName, 
sys.schemas.name AS ObjectOwner,  
so.type AS ...</td><td class="metric-value">3,348</td><td class="metric-value">2,739.58</td><td>6</td><td>14,657</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT EmployeeID,
       EmployeeNoteID,
       Name,
       NoteDate
FROM EmployeeNote AS EN
WHERE (EN.EmployeeID=@EmployeeID OR @EmployeeID IS NULL) AND EN.NoteDate=@Date">SELECT EmployeeID,
       EmployeeNoteID,
       Name,
       NoteDate
FROM EmployeeNote AS EN
...</td><td class="metric-value">3,016</td><td class="metric-value">1.03</td><td>2,932</td><td>104</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,967</td><td class="metric-value">577.40</td><td>6</td><td>175,035</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,435</td><td class="metric-value">791.31</td><td>6</td><td>1,405</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,039</td><td class="metric-value">588.17</td><td>4</td><td>131,466</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="IF EXISTS(SELECT TOP 1
                 *
          FROM EmployeeTimeCardItem AS ETCI
          
          WHERE StartDateTime IS NOT NULL
                AND EndDateTime IS NULL
                AND EmployeeID=@PersonID
                AND SalonID=@LocationID
                --@PersonID
                )">IF EXISTS(SELECT TOP 1
                 *
          FROM EmployeeTimeCardItem AS ETCI
          ...</td><td class="metric-value">1,130</td><td class="metric-value">0.75</td><td>1,780</td><td>5</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Demo_Multicard</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">6,128</td><td class="metric-value">1,555.07</td><td>6</td><td>142,168</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,731</td><td class="metric-value">1,180.04</td><td>6</td><td>223,241</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">3,555</td><td class="metric-value">1,778.95</td><td>2</td><td>2,095,496</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">3,221</td><td class="metric-value">625.98</td><td>6</td><td>157,471</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,319</td><td class="metric-value">718.58</td><td>6</td><td>1,343</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,237</td><td class="metric-value">466.94</td><td>6</td><td>18,656</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,192</td><td class="metric-value">416.67</td><td>6</td><td>50,485</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">985</td><td class="metric-value">203.21</td><td>6</td><td>39,642</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">953</td><td class="metric-value">158.90</td><td>6</td><td>2,180</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Demo_Multicard</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">767</td><td class="metric-value">127.87</td><td>6</td><td>632</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Hope</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmountDue, LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmoun...</td><td class="metric-value">36,507</td><td class="metric-value">354.98</td><td>151</td><td>91,539</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.AffectsBalance,0)), 0)
    FROM AccountTransaction AS AT
    INNER JOIN AccountTransactionType AS ATT
              ON ATT.AccountTransactionTypeID=AT.AccountTransactionTypeID
    WHERE AT.AccountID=@AccountID
          AND CommittedDateTime IS NOT NULL
          AND VoidedDateTime IS NULL
          AND ArchivedDateTime IS NULL">SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.A...</td><td class="metric-value">22,888</td><td class="metric-value">0.33</td><td>102,005</td><td>114</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET VisitCount = (SELECT COUNT(T.TicketID)
                               FROM Ticket AS T
                               INNER JOIN Guest AS G2
                                         ON G2.GuestID=T.GuestID
                               INNER JOIN TicketLineItem AS TLI
                                         ON T.TicketID=TLI.TicketID --Hannah 4-20-23 only count tickets with maxcounts

                               INNER JOIN Product AS P
                                         ON P.ProductID=TLI.ProductID --Hannah 4-20-23 only count tickets with maxcounts

                               INNER JOIN Salon AS S
                                         ON S.SalonID=T.SalonID
                               WHERE G2.GuestID=@GuestID
                                     AND T.TicketStatusID=@TicketStatusID_CheckedOut 
                                     --AND DateDIFF(Day,T.EndDateTime,'2023-08-13')&lt;0 --Added date compare to force visit count to reset at semester 01-18-2023 DG 

                                     AND (S.VisitCount_BySemester=0 OR dbo.Date_IsThisSemester(T.EndDateTime)=1)
                                     --and P.MaxPurchaseCountPerDay&gt;0 --Hannah 4-20-23 only count tickets with maxcounts

                                     AND (S.VisitCount_OnlyMaxPurchaseProducts=0 OR P.MaxPurchaseCountPerDay&gt;0)--11-2-23 fix to add field to control max purchase count
                                     ), ServiceTotal = (SELECT SUM(NetServiceAmount)
                                                        FROM Ticket AS T
                                                        INNER JOIN Guest AS G2
                                                                  ON G2.GuestID=T.GuestID
                                                        WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut), ProductTotal = (SELECT SUM(NetProductAmount)
                                                                                                                                                    FROM Ticket AS T
                                                                                                                                                    INNER JOIN Guest AS G2
                                                                                                                                                              ON G2.GuestID=T.GuestID
                                                                                                                                                    WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut)
FROM Guest AS G
WHERE G.GuestID=@GuestID">UPDATE Guest SET VisitCount = (SELECT COUNT(T.TicketID)
                               FROM Ticket A...</td><td class="metric-value">12,756</td><td class="metric-value">123.33</td><td>106</td><td>6,362</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                        FROM Ticket AS T
                                        INNER JOIN Guest AS G2
                                                  ON G2.GuestID=T.GuestID
                                        INNER JOIN TicketLineItem AS TLI
                                                  ON T.TicketID=TLI.TicketID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Product AS P
                                                  ON P.ProductID=TLI.ProductID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Salon AS S
                                                  ON S.SalonID=T.SalonID
                                        WHERE G2.GuestID=@GuestID
                                              AND T.TicketStatusID=@TicketStatusID_CheckedOut
                                              AND dbo.Date_IsThisWeek(T.EndDateTime, 1)=1
                                              --and P.MaxPurchaseCountPerDay&gt;0 --Hannah 4-20-23 only count tickets with maxcounts

                                              AND (S.VisitCount_OnlyMaxPurchaseProducts=0 OR P.MaxPurchaseCountPerDay&gt;0)--11-2-23 fix to add field to control max purchase count
                                              ), ServiceTotal = (SELECT SUM(NetServiceAmount)
                                                                 FROM Ticket AS T
                                                                 INNER JOIN Guest AS G2
                                                                           ON G2.GuestID=T.GuestID
                                                                 WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut), ProductTotal = (SELECT SUM(NetProductAmount)
                                                                                                                                                             FROM Ticket AS T
                                                                                                                                                             INNER JOIN Guest AS G2
                                                                                                                                                                       ON G2.GuestID=T.GuestID
                                                                                                                                                             WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut)
FROM Guest AS G
WHERE G.GuestID=@GuestID">UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                   ...</td><td class="metric-value">10,003</td><td class="metric-value">96.58</td><td>106</td><td>6,445</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue), AmountDue = IIF(AmountDue&gt;CurrentBalance, AmountDue - CurrentBalance, 0), LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue),...</td><td class="metric-value">8,925</td><td class="metric-value">81.12</td><td>151</td><td>10,173</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT EmployeeID, 0, 1
  FROM Employee">SELECT EmployeeID, 0, 1
  FROM Employee</td><td class="metric-value">6,932</td><td class="metric-value">16.11</td><td>1,352</td><td>35</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="IF EXISTS(SELECT TicketLineItemDiscountID
        FROM TicketLineItem_Discount
        WHERE TicketLineItemID IN(SELECT TLI.TicketLineItemID
                                  FROM TicketLineItem AS TLI
                                  WHERE TicketID=@TicketID) AND DiscountID IN(SELECT DiscountID
                                                                              FROM Discount
                                                                              WHERE DiscountTypeID IN(@DiscountTypeID_Promotion, @DiscountTypeID_Coupon, @DiscountTypeID_Loyalty)))">IF EXISTS(SELECT TicketLineItemDiscountID
        FROM TicketLineItem_Discount
        WHERE Ticke...</td><td class="metric-value">6,770</td><td class="metric-value">3.45</td><td>2,868</td><td>4,564</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @DayOfYear = JulianDay
  FROM dbo.Dates AS D
  INNER JOIN Ticket AS T
            ON DATEDIFF(d, COALESCE(T.EndDateTime, T.StartDateTime), D.Date)=0
  WHERE T.TicketID=@TicketID">SELECT @DayOfYear = JulianDay
  FROM dbo.Dates AS D
  INNER JOIN Ticket AS T
            ON DATED...</td><td class="metric-value">6,308</td><td class="metric-value">24.69</td><td>325</td><td>803</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">5,101</td><td class="metric-value">937.87</td><td>6</td><td>293,640</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Hope</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @StartDateTime = MAX(d.date)
    FROM date AS d
    WHERE date&lt;GETDATE() AND dayofweek=@StartDayOfWeek">SELECT @StartDateTime = MAX(d.date)
    FROM date AS d
    WHERE date&lt;GETDATE() AND dayofweek=@...</td><td class="metric-value">5,099</td><td class="metric-value">0.03</td><td>216,046</td><td>3</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Hope_20250901</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Hope_20250901</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">74</td><td class="metric-value">797.29</td><td>4</td><td>1,244</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Hope_20250901</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS                             	JOIN sys.plan_persist_runtime_stats_interval I                  	ON WS.runtime_stats_interval_id = I.runtime_stats_interval_id   	WHERE I.end_time &lt; @threshold_time">DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS...</td><td class="metric-value">7</td><td class="metric-value">11.77</td><td>4</td><td>118</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Hope_20250901</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_Hope_20250901].[sys].[filetable_updates_1890574269] with (readpast) order by table_id">select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_Hope_20250901].[sy...</td><td class="metric-value">0</td><td class="metric-value">0.07</td><td>1</td><td>0</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Merced</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE b
        SET BadgeImageId_PersonImage = bi.BadgeImageId
        FROM dbo.Badge AS b
        INNER JOIN dbo.BadgeImage AS bi 
            ON b.BadgeId = bi.BadgeId 
            AND bi.BadgeImageTypeId = 1 
        WHERE bi.BadgeImageId IN (
            -- Get the max BadgeImageId for each badge where type = 1 and IsActive = 1
            SELECT MAX(bi2.BadgeImageId) 
            FROM dbo.BadgeImage AS bi2 
            WHERE bi2.BadgeImageTypeId = 1 
            AND bi2.IsActive = 1 
            GROUP BY bi2.BadgeId
        )
        -- Only update if the current value is different
        AND bi.BadgeImageId &lt;&gt; ISNULL(b.BadgeImageId_PersonImage, -1)
        -- And the current value is not already the correct max active image
        AND ISNULL(b.BadgeImageId_PersonImage, -1) NOT IN (
            SELECT MAX(bi3.BadgeImageId) 
            FROM dbo.BadgeImage AS bi3 
            WHERE bi3.BadgeImageTypeId = 1 
            AND bi3.IsActive = 1 
            GROUP BY bi3.BadgeId
        )">UPDATE b
        SET BadgeImageId_PersonImage = bi.BadgeImageId
        FROM dbo.Badge AS b
     ...</td><td class="metric-value">529,955</td><td class="metric-value">44.02</td><td>13,001</td><td>1,525</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @RemainingRecords = @RemainingRecords + COUNT(*)
    FROM dbo.Merced_SISImport WITH (NOLOCK)
    WHERE InProcessDateTime IS NULL 
      AND ProcessedDateTime IS NULL
      AND SISImportID IN (SELECT MAX(SISImportID) FROM Merced_SISImport GROUP BY IDNumber, EmailAddress)">SELECT @RemainingRecords = @RemainingRecords + COUNT(*)
    FROM dbo.Merced_SISImport WITH (NOLOCK)...</td><td class="metric-value">472,771</td><td class="metric-value">473,460.70</td><td>1</td><td>10,713,233</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="WITH EligibleRecords AS (
                SELECT TOP (@BatchSize) SISImportID
                FROM Merced_SISImport
                WHERE InProcessDateTime IS NULL 
                  AND ProcessedDateTime IS NULL
                  AND SISImportID IN (SELECT MAX(SISImportID) FROM Merced_SISImport GROUP BY IDNumber, EmailAddress)
                ORDER BY SISImportID
            )
            UPDATE s
            SET InProcessDateTime = @batchProcessDate
            FROM dbo.Merced_SISImport s WITH (ROWLOCK)
            INNER JOIN EligibleRecords e ON s.SISImportID = e.SISImportID">WITH EligibleRecords AS (
                SELECT TOP (@BatchSize) SISImportID
                FROM...</td><td class="metric-value">77,033</td><td class="metric-value">77,194.64</td><td>1</td><td>1,078,557</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE bi
    SET StoredDateTime = GETDATE()
    FROM dbo.badgeimage bi
    INNER JOIN inserted i ON bi.BadgeImageID = i.BadgeImageID
    WHERE 
        -- For inserts, always update
        NOT EXISTS (SELECT 1 FROM deleted d WHERE d.BadgeImageID = i.BadgeImageID)
        OR
        -- For updates, only if photo data changed
        EXISTS (
            SELECT 1 FROM deleted d 
            WHERE d.BadgeImageID = i.BadgeImageID
            AND (
                -- Photo data changed
                (d.IDWPhotoField IS NULL AND i.IDWPhotoField IS NOT NULL)
                OR (d.IDWPhotoField IS NOT NULL AND i.IDWPhotoField IS NULL)
                OR (DATALENGTH(d.IDWPhotoField) != DATALENGTH(i.IDWPhotoField))
                -- OR if using PhotoHash column
                OR (EXISTS (SELECT 1 FROM sys.columns WHERE object_id = OBJECT_ID('dbo.badgeimage') AND name = 'PhotoHash')
                    AND d.PhotoHash != i.PhotoHash)
            )
        )">UPDATE bi
    SET StoredDateTime = GETDATE()
    FROM dbo.badgeimage bi
    INNER JOIN inserted i ON...</td><td class="metric-value">43,864</td><td class="metric-value">1.38</td><td>32,201</td><td>76</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE bi
        SET IsActive = 0
        FROM dbo.BadgeImage bi
        INNER JOIN #AffectedBadges ab 
            ON bi.BadgeId = ab.BadgeId 
            AND bi.BadgeImageTypeId = ab.BadgeImageTypeId
        WHERE bi.IsActive = 1
        AND bi.BadgeImageId &lt;&gt; ab.MaxBadgeImageId">UPDATE bi
        SET IsActive = 0
        FROM dbo.BadgeImage bi
        INNER JOIN #AffectedBadges...</td><td class="metric-value">5,281</td><td class="metric-value">0.17</td><td>32,201</td><td>30</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="INSERT INTO #AffectedBadges (BadgeId, BadgeImageTypeId, MaxBadgeImageId)
        SELECT BadgeId, BadgeImageTypeId, MAX(BadgeImageId)
        FROM dbo.BadgeImage
        WHERE BadgeId IN (
            SELECT DISTINCT BadgeId
            FROM inserted
        )
        AND BadgeImageTypeId IN (
            SELECT DISTINCT BadgeImageTypeId
            FROM inserted
        )
        GROUP BY BadgeId, BadgeImageTypeId">INSERT INTO #AffectedBadges (BadgeId, BadgeImageTypeId, MaxBadgeImageId)
        SELECT BadgeId, Bad...</td><td class="metric-value">4,233</td><td class="metric-value">0.13</td><td>32,201</td><td>9</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
       BP.BadgeID,
       PE.PersonID,
       PR.PersonRoleID,
       PR.Name AS PersonRoleName
FROM Person_PersonRole AS PE
INNER JOIN PersonRole AS PR
          ON PR.PersonRoleID=PE.PersonRoleID
LEFT OUTER JOIN BadgePerson AS BP
          ON BP.PersonID=PE.PersonID AND BP.InstitutionGlobalKey=PE.InstitutionGlobalKey
WHERE PE.InstitutionGlobalKey=@InstitutionGlobalKey
      AND (ISNULL(@BadgeID, -1)&lt;0 OR BP.BadgeID=@BadgeID)
      AND (ISNULL(@PersonID, -1)&lt;0 OR BP.PersonID=@PersonID)
      AND PR.IsEvent=0">SELECT DISTINCT
       BP.BadgeID,
       PE.PersonID,
       PR.PersonRoleID,
       PR.Name AS...</td><td class="metric-value">2,627</td><td class="metric-value">66.16</td><td>52</td><td>665</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
       BP.BadgeID,
       PE.PersonID,
       E.EventID,
       E.EventName
FROM Person_Event AS PE
INNER JOIN Event AS E
          ON E.EventID=PE.EventID
LEFT OUTER JOIN BadgePerson AS BP
          ON BP.PersonID=PE.PersonID AND BP.InstitutionGlobalKey=PE.InstitutionGlobalKey
WHERE PE.InstitutionGlobalKey=@InstitutionGlobalKey
      AND (ISNULL(@BadgeID, -1)&lt;0 OR BP.BadgeID=@BadgeID)
      AND (ISNULL(@PersonID, -1)&lt;0 OR BP.PersonID=@PersonID)">SELECT DISTINCT
       BP.BadgeID,
       PE.PersonID,
       E.EventID,
       E.EventName
FRO...</td><td class="metric-value">2,442</td><td class="metric-value">61.14</td><td>52</td><td>668</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE bi
        SET IsActive = 1
        FROM dbo.BadgeImage bi
        INNER JOIN #AffectedBadges ab 
            ON bi.BadgeId = ab.BadgeId 
            AND bi.BadgeImageTypeId = ab.BadgeImageTypeId
        WHERE bi.BadgeImageId = ab.MaxBadgeImageId
        AND (bi.IsActive = 0 OR bi.IsActive IS NULL)">UPDATE bi
        SET IsActive = 1
        FROM dbo.BadgeImage bi
        INNER JOIN #AffectedBadges...</td><td class="metric-value">2,338</td><td class="metric-value">0.07</td><td>32,201</td><td>4</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Merced</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
       BI.BadgeInformationID,
       BI.Name,
       BI.InformationText,
       BI.IsContact,
       BI.PhoneNumber,
       BI.EmailAddress,
       BI.WebsiteURL,
       BI.HTMLText,
       BI.BadgeInformationID_CopiedFrom,
       Bi.CanBeEdited,
	   BI.Ordinal
INTO #tmpBI
FROM BadgeInformation AS BI, Badge_LinkByFilter AS BLF
INNER JOIN Institution AS I
          ON I.InstitutionGlobalKey=BLF.InstitutionGlobalKey
WHERE (COALESCE(BI.EffectiveDateTime, GETDATE())&lt;=GETDATE() OR BI.EffectiveDateTime IS NULL)
      AND (COALESCE(BI.ExpirationDateTime, GETDATE())&gt;=GETDATE() OR BI.ExpirationDateTime IS NULL)
      AND BI.IsActive=1
      AND BI.InstitutionID=BLF.InstitutionID
      AND (BI.InstitutionID=I.InstitutionID)
      AND (BI.LocationID=BLF.LocationID OR COALESCE(BI.LocationID, -1)&lt;0)
      AND (BI.DepartmentID=BLF.DepartmentID OR COALESCE(BI.DepartmentID, -1)&lt;0)
      AND (BI.PersonRoleID_RestrictTo=BLF.PersonRoleID OR COALESCE(BI.PersonRoleID_RestrictTo, -1)&lt;0)
      AND ((BLF.IsEmployee=1 AND BI.AppliesToAllEmployees=1)
            OR (BLF.IsVisitor=1 AND BI.AppliesToAllVisitors=1)
            OR (BLF.IsStudent=1 AND BI.AppliesToAllStudents=1))
      AND (BI.BadgeID_RestrictTo=BLF.BadgeID OR ISNULL(BI.BadgeID_RestrictTo, -1)&lt;0)
      AND (BLF.BadgeID=@BadgeID OR COALESCE(@BadgeID, -1)&lt;0)
      AND (((BI.IsInfoItem=1 OR BI.IsContact=1) AND @LimitToInfoItem=1)
            OR (BI.IsMenuItem=1 AND @LimitToMenuItem=1)
            OR (@LimitToMenuItem=1 AND @LimitToInfoItem=1))
      AND BI.IsActive=1">SELECT DISTINCT
       BI.BadgeInformationID,
       BI.Name,
       BI.InformationText,
       ...</td><td class="metric-value">1,941</td><td class="metric-value">22.97</td><td>104</td><td>1,055</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_SageOak</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">7,885</td><td class="metric-value">1,356.11</td><td>6</td><td>311,455</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,521</td><td class="metric-value">1,152.13</td><td>6</td><td>235,747</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">4,026</td><td class="metric-value">1,534.77</td><td>4</td><td>100,796</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sp.major_id AS id, 
so.name AS ObjectName, 
sys.schemas.name AS ObjectOwner,  
so.type AS ObjectType, 
sp.minor_id AS smallid,  
sp.name AS PropertyName, 
sp.value AS PropertyValue,
CAST(sp.value AS varbinary(MAX)) AS PropertyValueBinary,
sql_variant_property(sp.value,'BaseType') AS PropertyValueBaseType,
sql_variant_property(sp.value,'Precision') AS PropertyValuePrecision,
sql_variant_property(sp.value,'Scale') AS PropertyValueScale,
CASE WHEN sql_variant_property(sp.value,'BaseType') IN (N'nchar', N'nvarchar') THEN CAST(sql_variant_property(sp.value,'MaxLength') AS INT)/2 ELSE sql_variant_property(sp.value,'MaxLength') END AS PropertyValueMaxLength,
CASE sp.class WHEN 4 THEN USER_NAME(sp.major_id) END AS UserName,
CASE sp.class 
	WHEN 6 THEN (SELECT TOP 1 name FROM sys.types sst WITH (NOLOCK) WHERE sst.user_type_id=sp.major_id)
	WHEN 8 THEN (SELECT TOP 1 name FROM sys.types sst WITH (NOLOCK) WHERE sst.user_type_id=sp.major_id) 
END AS UDTName,
CASE sp.class 
	WHEN 6 THEN (SELECT TOP 1 sys.schemas.name FROM sys.schemas WITH (NOLOCK) INNER JOIN sys.types WITH (NOLOCK) ON sys.types.schema_id=sys.schemas.schema_id WHERE sys.types.user_type_id=sp.major_id)
	WHEN 8 THEN (SELECT TOP 1 sys.schemas.name FROM sys.schemas WITH (NOLOCK) INNER JOIN sys.types WITH (NOLOCK) ON sys.types.schema_id=sys.schemas.schema_id WHERE sys.types.user_type_id=sp.major_id) 
END AS UDTOwner,
CASE sp.class
    WHEN  3 THEN (SELECT TOP 1 ss2.name as a FROM sys.schemas ss2 WITH (NOLOCK) WHERE ss2.schema_id = sp.major_id)
    WHEN  5 THEN (SELECT TOP 1 sa2.name as a FROM sys.assemblies sa2 WITH (NOLOCK) WHERE sa2.assembly_id = sp.major_id)
    WHEN 10 THEN (SELECT TOP 1 sxsc2.name as a FROM sys.xml_schema_collections sxsc2 WITH (NOLOCK) WHERE sxsc2.xml_collection_id = sp.major_id) COLLATE database_default
    WHEN 15 THEN (SELECT TOP 1 smt2.name FROM sys.service_message_types smt2 WITH (NOLOCK) WHERE smt2.message_type_id = sp.major_id)
    WHEN 16 THEN (SELECT TOP 1 ssc2.name FROM sys.service_contracts ssc2 WITH (NOLOCK) WHERE ssc2.service_contract_id = sp.major_id)
    WHEN 17 THEN (SELECT TOP 1 ss2.name FROM sys.services ss2 WITH (NOLOCK) WHERE ss2.service_id = sp.major_id)
    WHEN 18 THEN (SELECT TOP 1 srs2.name FROM sys.remote_service_bindings srs2 WITH (NOLOCK) WHERE srs2.remote_service_binding_id = sp.major_id)
    WHEN 19 THEN (SELECT TOP 1 sr2.name FROM sys.routes sr2 WITH (NOLOCK) WHERE sr2.route_id = sp.major_id)
    WHEN 20 THEN (SELECT TOP 1 sps2.name FROM sys.partition_schemes sps2 WITH (NOLOCK) WHERE sps2.data_space_id = sp.major_id)
    WHEN 21 THEN (SELECT TOP 1 spf2.name FROM sys.partition_functions spf2 WITH (NOLOCK) WHERE spf2.function_id = sp.major_id)
    ELSE CAST(NULL AS sysname)
END AS YukonObjectName,
CASE sp.class 
    WHEN 10 THEN SCHEMA_NAME(( SELECT TOP 1 sx2.schema_id FROM sys.xml_schema_collections sx2 WITH (NOLOCK) WHERE sx2.xml_collection_id = sp.major_id))
    WHEN 6 THEN SCHEMA_NAME((SELECT TOP 1 st2.schema_id FROM sys.types st2 WITH (NOLOCK) WHERE st2.user_type_id = sp.major_id))
    WHEN 8 THEN SCHEMA_NAME((SELECT TOP 1 st2.schema_id FROM sys.types st2 WITH (NOLOCK) WHERE st2.user_type_id = sp.major_id))
ELSE 
USER_NAME(CASE sp.class 
    WHEN 3 THEN (SELECT TOP 1 sch2.principal_id FROM sys.schemas sch2 WITH (NOLOCK) WHERE sch2.schema_id = sp.major_id)
    WHEN 4 THEN (SELECT TOP 1 sp2.owning_principal_id FROM sys.database_principals sp2 WITH (NOLOCK) WHERE sp2.principal_id = sp.major_id)
    WHEN 5 THEN (SELECT TOP 1 sa2.principal_id FROM sys.assemblies sa2 WITH (NOLOCK) WHERE sa2.assembly_id = sp.major_id)
    WHEN 15 THEN (SELECT TOP 1 smt2.principal_id FROM sys.service_message_types smt2 WITH (NOLOCK) WHERE smt2.message_type_id = sp.major_id)
    WHEN 16 THEN (SELECT TOP 1 ssc2.principal_id FROM sys.service_contracts ssc2 WITH (NOLOCK) WHERE ssc2.service_contract_id = sp.major_id)
    WHEN 17 THEN (SELECT TOP 1 ss2.principal_id FROM sys.services ss2 WITH (NOLOCK) WHERE ss2.service_id = sp.major_id)
    WHEN 18 THEN (SELECT TOP 1 srs2.principal_id FROM sys.remote_service_bindings srs2 WITH (NOLOCK) WHERE srs2.remote_service_binding_id = sp.major_id)
    WHEN 19 THEN (SELECT TOP 1 sr2.principal_id FROM sys.routes sr2 WITH (NOLOCK) WHERE sr2.route_id = sp.major_id)
    WHEN 23 THEN (SELECT TOP 1 sft2.principal_id FROM sys.fulltext_catalogs sft2 WITH (NOLOCK) WHERE sft2.fulltext_catalog_id = sp.major_id)
    WHEN 24 THEN (SELECT TOP 1 ssk2.principal_id FROM sys.symmetric_keys ssk2 WITH (NOLOCK) WHERE ssk2.symmetric_key_id = sp.major_id)
    WHEN 26 THEN (SELECT TOP 1 sak2.principal_id FROM sys.asymmetric_keys sak2 WITH (NOLOCK) WHERE sak2.asymmetric_key_id = sp.major_id)
    WHEN 25 THEN (SELECT TOP 1 sc2.principal_id FROM sys.certificates sc2 WITH (NOLOCK) WHERE sc2.certificate_id = sp.major_id)
    ELSE CAST(NULL AS sysname)
END)
END AS YukonObjectOwner,
CASE sp.class
    WHEN 2 then spar.name
    WHEN 8 then (SELECT TOP 1 sc.name 
                 FROM sys.extended_properties ep  WITH (NOLOCK) 
                 INNER JOIN sys.table_types t WITH (NOLOCK) ON ep.major_id = t.user_type_id 
                 INNER JOIN sys.columns AS sc WITH (NOLOCK) ON t.type_table_object_id = sc.object_id AND ep.minor_id = sc.column_id 
                 WHERE sp.major_id = ep.major_id AND sp.minor_id = ep.minor_id)
    ELSE sc.name
END AS FieldName,
si.name AS IndexName,
pso.name AS ParentName,
pu.name AS ParentOwner,
pso.type AS ParentType,
sp.class AS type,
ddlt.name AS DdlTriggerName,
en.name AS EventNotificiationName,
qensq.name AS ENQueueName,
qensqs.name AS ENQueueSchema

FROM sys.extended_properties AS sp WITH (NOLOCK) 
LEFT JOIN sys.objects  AS so WITH (NOLOCK) ON so.object_id=sp.major_id
LEFT JOIN sys.schemas  WITH (NOLOCK) ON sys.schemas.schema_id=so.schema_id
LEFT JOIN sys.columns AS sc WITH (NOLOCK) ON sc.object_id=sp.major_id AND sc.column_id=sp.minor_id
LEFT JOIN sys.parameters AS spar WITH (NOLOCK) ON spar.object_id=sp.major_id AND spar.parameter_id=sp.minor_id
LEFT JOIN sys.indexes si WITH (NOLOCK) ON si.object_id=sp.major_id AND si.index_id=sp.minor_id
LEFT JOIN sys.objects pso  WITH (NOLOCK) ON so.parent_object_id=pso.object_id
LEFT JOIN sys.schemas pu  WITH (NOLOCK) ON pso.schema_id=pu.schema_id
LEFT JOIN sys.triggers  AS ddlt WITH (NOLOCK) ON ddlt.object_id=sp.major_id
LEFT JOIN sys.event_notifications  AS en WITH (NOLOCK) ON en.object_id=sp.major_id
LEFT JOIN sys.service_queues  AS qensq WITH (NOLOCK) ON qensq.object_id=en.parent_id
LEFT JOIN sys.schemas AS qensqs WITH (NOLOCK) ON qensqs.schema_id=qensq.SCHEMA_ID">SELECT sp.major_id AS id, 
so.name AS ObjectName, 
sys.schemas.name AS ObjectOwner,  
so.type AS ...</td><td class="metric-value">3,219</td><td class="metric-value">2,713.73</td><td>6</td><td>14,767</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,304</td><td class="metric-value">687.73</td><td>6</td><td>1,415</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,282</td><td class="metric-value">441.09</td><td>6</td><td>55,218</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">1,837</td><td class="metric-value">527.28</td><td>5</td><td>19,244</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">983</td><td class="metric-value">164.16</td><td>6</td><td>2,277</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">837</td><td class="metric-value">171.78</td><td>6</td><td>43,215</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_SageOak</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">795</td><td class="metric-value">132.54</td><td>6</td><td>660</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Westmoreland</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmountDue, LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmoun...</td><td class="metric-value">156,191</td><td class="metric-value">2,479.27</td><td>67</td><td>302,292</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue), AmountDue = IIF(AmountDue&gt;CurrentBalance, AmountDue - CurrentBalance, 0), LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = IIF(AmountDue&gt;CurrentBalance, 0, CurrentBalance - AmountDue),...</td><td class="metric-value">57,755</td><td class="metric-value">931.08</td><td>67</td><td>159,477</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.AffectsBalance,0)), 0)
    FROM AccountTransaction AS AT
    INNER JOIN AccountTransactionType AS ATT
              ON ATT.AccountTransactionTypeID=AT.AccountTransactionTypeID
    WHERE AT.AccountID=@AccountID
          AND CommittedDateTime IS NOT NULL
          AND VoidedDateTime IS NULL
          AND ArchivedDateTime IS NULL">SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.A...</td><td class="metric-value">42,533</td><td class="metric-value">0.04</td><td>1,066,037</td><td>2</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = InitialBalance
    FROM Account
    WHERE AccountID=@AccountID">SELECT @Total = InitialBalance
    FROM Account
    WHERE AccountID=@AccountID</td><td class="metric-value">13,404</td><td class="metric-value">0.01</td><td>1,066,037</td><td>2</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
clmns.name AS [Name],
clmns.column_id AS [ID],
clmns.is_nullable AS [Nullable],
clmns.is_computed AS [Computed],
CAST(ISNULL(cik.index_column_id, 0) AS bit) AS [InPrimaryKey],
clmns.is_ansi_padded AS [AnsiPaddingStatus],
CAST(clmns.is_rowguidcol AS bit) AS [RowGuidCol],
CAST(ISNULL(cc.is_persisted, 0) AS bit) AS [IsPersisted],
ISNULL(clmns.collation_name, N'') AS [Collation],
CAST(ISNULL((select TOP 1 1 from sys.foreign_key_columns AS colfk where colfk.parent_column_id = clmns.column_id and colfk.parent_object_id = clmns.object_id), 0) AS bit) AS [IsForeignKey],
clmns.is_identity AS [Identity],
CAST(ISNULL(ic.seed_value,0) AS numeric(38)) AS [IdentitySeedAsDecimal],
CAST(ISNULL(ic.increment_value,0) AS numeric(38)) AS [IdentityIncrementAsDecimal],
(case when clmns.default_object_id = 0 then N'' when d.parent_object_id &gt; 0 then N'' else d.name end) AS [Default],
(case when clmns.default_object_id = 0 then N'' when d.parent_object_id &gt; 0 then N'' else schema_name(d.schema_id) end) AS [DefaultSchema],
ISNULL(dc.Name, N'') AS [DefaultConstraintName],
(case when clmns.rule_object_id = 0 then N'' else r.name end) AS [Rule],
(case when clmns.rule_object_id = 0 then N'' else schema_name(r.schema_id) end) AS [RuleSchema],
CAST(ISNULL(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsDeterministic'),0) AS bit) AS [IsDeterministic],
CAST(ISNULL(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsPrecise'),0) AS bit) AS [IsPrecise],
ISNULL(ic.is_not_for_replication, 0) AS [NotForReplication],
CAST(COLUMNPROPERTY(clmns.object_id, clmns.name, N'IsFulltextIndexed') AS bit) AS [IsFullTextIndexed],
CAST(COLUMNPROPERTY(clmns.object_id, clmns.name, N'StatisticalSemantics') AS int) AS [StatisticalSemantics],
CAST(clmns.encryption_type AS int) AS [EncryptionType],
clmns.encryption_algorithm_name AS [EncryptionAlgorithm],
clmns.column_encryption_key_id AS [ColumnEncryptionKeyID],
ceks.name AS [ColumnEncryptionKeyName],
CAST(clmns.is_filestream AS bit) AS [IsFileStream],
CAST(clmns.is_sparse AS bit) AS [IsSparse],
CAST(clmns.is_column_set AS bit) AS [IsColumnSet],
usrt.name AS [DataType],
s1clmns.name AS [DataTypeSchema],
ISNULL(baset.name, N'') AS [SystemType],
CAST(CASE WHEN baset.name IN (N'nchar', N'nvarchar') AND clmns.max_length &lt;&gt; -1 THEN clmns.max_length/2 ELSE clmns.max_length END AS int) AS [Length],
CAST(clmns.precision AS int) AS [NumericPrecision],
CAST(clmns.scale AS int) AS [NumericScale],
ISNULL(xscclmns.name, N'') AS [XmlSchemaNamespace],
ISNULL(s2clmns.name, N'') AS [XmlSchemaNamespaceSchema],
ISNULL( (case clmns.is_xml_document when 1 then 2 else 1 end), 0) AS [XmlDocumentConstraint],
CASE WHEN usrt.is_table_type = 1 THEN N'structured' ELSE N'' END AS [UserType],
clmns.generated_always_type AS [GeneratedAlwaysType],
CAST(clmns.is_hidden AS bit) AS [IsHidden],
CAST(0 AS bit) AS [IsDroppedLedgerColumn],
CAST(clmns.is_masked AS bit) AS [IsMasked],
CAST(
        CASE
        WHEN [sc].[label] IS NOT NULL or [sc].[label_id] IS NOT NULL or [sc].[information_type] IS NOT NULL or [sc].[information_type_id] IS NOT NULL or [sc].[rank] IS NOT NULL THEN 1
        ELSE 0
        END
       AS bit) AS [IsClassified],
ISNULL(clmns.graph_type, 0) AS [GraphType]
FROM
sys.tables AS tbl
INNER JOIN sys.all_columns AS clmns ON clmns.object_id=tbl.object_id
LEFT OUTER JOIN sys.indexes AS ik ON ik.object_id = clmns.object_id and 1=ik.is_primary_key
LEFT OUTER JOIN sys.index_columns AS cik ON cik.index_id = ik.index_id and cik.column_id = clmns.column_id and cik.object_id = clmns.object_id and 0 = cik.is_included_column
LEFT OUTER JOIN sys.computed_columns AS cc ON cc.object_id = clmns.object_id and cc.column_id = clmns.column_id
LEFT OUTER JOIN sys.identity_columns AS ic ON ic.object_id = clmns.object_id and ic.column_id = clmns.column_id
LEFT OUTER JOIN sys.objects AS d ON d.object_id = clmns.default_object_id
LEFT OUTER JOIN sys.default_constraints as dc ON clmns.default_object_id = dc.object_id
LEFT OUTER JOIN sys.objects AS r ON r.object_id = clmns.rule_object_id
LEFT OUTER JOIN sys.column_encryption_keys AS ceks ON (ceks.column_encryption_key_id = clmns.column_encryption_key_id)
LEFT OUTER JOIN sys.types AS usrt ON usrt.user_type_id = clmns.user_type_id
LEFT OUTER JOIN sys.schemas AS s1clmns ON s1clmns.schema_id = usrt.schema_id
LEFT OUTER JOIN sys.types AS baset ON (baset.user_type_id = clmns.system_type_id and baset.user_type_id = baset.system_type_id) or ((baset.system_type_id = clmns.system_type_id) and (baset.user_type_id = clmns.user_type_id) and (baset.is_user_defined = 0) and (baset.is_assembly_type = 1)) 
LEFT OUTER JOIN sys.xml_schema_collections AS xscclmns ON xscclmns.xml_collection_id = clmns.xml_collection_id
LEFT OUTER JOIN sys.schemas AS s2clmns ON s2clmns.schema_id = xscclmns.schema_id
LEFT OUTER JOIN sys.sensitivity_classifications AS sc ON sc.major_id = clmns.object_id and sc.minor_id = clmns.column_id
WHERE
(clmns.name=@_msparam_0)and((tbl.name=@_msparam_1 and SCHEMA_NAME(tbl.schema_id)=@_msparam_2))">SELECT
clmns.name AS [Name],
clmns.column_id AS [ID],
clmns.is_nullable AS [Nullable],
clmns.is_comp...</td><td class="metric-value">6,294</td><td class="metric-value">30.24</td><td>232</td><td>5,659</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,443</td><td class="metric-value">1,144.79</td><td>6</td><td>233,250</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">4,173</td><td class="metric-value">1,573.05</td><td>4</td><td>99,834</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,944</td><td class="metric-value">576.97</td><td>6</td><td>172,182</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,323</td><td class="metric-value">707.57</td><td>6</td><td>1,439</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Westmoreland</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
SCHEMA_NAME(sp.schema_id) AS [Schema],
sp.name AS [Name],
sp.object_id AS [ID],
CAST(
 case 
    when sp.is_ms_shipped = 1 then 1
    when (
        select 
            major_id 
        from 
            sys.extended_properties 
        where 
            major_id = sp.object_id and 
            minor_id = 0 and 
            class = 1 and 
            name = N'microsoft_database_tools_support') 
        is not null then 1
    else 0
end          
             AS bit) AS [IsSystemObject],
CASE WHEN sp.type = N'P' THEN 1 WHEN sp.type = N'PC' THEN 2 ELSE 1 END AS [ImplementationType],
CAST(CASE WHEN ISNULL(smsp.definition, ssmsp.definition) IS NULL THEN 1 ELSE 0 END AS bit) AS [IsEncrypted]
FROM
sys.all_objects AS sp
LEFT OUTER JOIN sys.sql_modules AS smsp ON smsp.object_id = sp.object_id
LEFT OUTER JOIN sys.system_sql_modules AS ssmsp ON ssmsp.object_id = sp.object_id
WHERE
(sp.type = @_msparam_0 OR sp.type = @_msparam_1 OR sp.type=@_msparam_2)
ORDER BY
[Schema] ASC,[Name] ASC">SELECT
SCHEMA_NAME(sp.schema_id) AS [Schema],
sp.name AS [Name],
sp.object_id AS [ID],
CAST(
 case ...</td><td class="metric-value">1,811</td><td class="metric-value">8,726.77</td><td>3</td><td>222,975</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Westmoreland08112025KEEP</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Westmoreland08112025KEEP</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">8</td><td class="metric-value">28.95</td><td>3</td><td>37</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Westmoreland08112025KEEP</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS                             	JOIN sys.plan_persist_runtime_stats_interval I                  	ON WS.runtime_stats_interval_id = I.runtime_stats_interval_id   	WHERE I.end_time &lt; @threshold_time">DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS...</td><td class="metric-value">3</td><td class="metric-value">14.54</td><td>3</td><td>6</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Westmoreland08112025KEEP</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_Westmoreland08112025KEEP].[sys].[filetable_updates_1890574269] with (readpast) order by table_id">select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_Westmoreland081120...</td><td class="metric-value">0</td><td class="metric-value">0.06</td><td>1</td><td>0</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Wiley</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmountDue, LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmoun...</td><td class="metric-value">88,833</td><td class="metric-value">3,154.28</td><td>35</td><td>495,440</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.AffectsBalance,0)), 0)
    FROM AccountTransaction AS AT
    INNER JOIN AccountTransactionType AS ATT
              ON ATT.AccountTransactionTypeID=AT.AccountTransactionTypeID
    WHERE AT.AccountID=@AccountID
          AND CommittedDateTime IS NOT NULL
          AND VoidedDateTime IS NULL
          AND ArchivedDateTime IS NULL">SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.A...</td><td class="metric-value">79,582</td><td class="metric-value">1.63</td><td>60,480</td><td>270</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @TicketCount = ISNULL(COUNT(DISTINCT T.TicketID), 0)
FROM TicketLineItem AS TLI
INNER JOIN Ticket AS T
          ON T.TicketID=TLI.TicketID
INNER JOIN TicketStatus AS ts
          ON ts.TicketStatusID=T.TicketStatusID
WHERE T.SalonBusinessDayID=@SalonBusinessDayID
      AND IncludeInTotal=1
      AND IsPending=0">SELECT @TicketCount = ISNULL(COUNT(DISTINCT T.TicketID), 0)
FROM TicketLineItem AS TLI
INNER JOIN ...</td><td class="metric-value">77,023</td><td class="metric-value">165.87</td><td>563</td><td>1,245</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="INSERT #t0
  (  
     TicketID,
     StartDateTime,
     ScheduledStartDateTime,
     ScheduledEndDateTime,
     TicketStatusID,
     EmployeeID_Current,
     ServiceID_Primary,
     EstimatedWaitTimeInMinutes,
     InServiceDateTime,
     WaitStartDateTime,
     EndDateTime,
     CallAheadDateTime,
     ContainsRequest,
     TicketPaymentID,
     GuestID,
     EstimatedDurationInMinutes,
     HasMultipleEmployees,
     Source
  )
  SELECT TicketID,
         StartDateTime,
         ScheduledStartDateTime,
         ScheduledEndDateTime,
         TicketStatusID,
         EmployeeID_Current,
         ServiceID_Primary,
         EstimatedWaitTimeInMinutes,
         InServiceDateTime,
         WaitStartDateTime,
         EndDateTime,
         CallAheadDateTime,
         ContainsRequest,
         TicketPaymentID,
         GuestID,
         EstimatedDurationInMinutes,
         HasMultipleEmployees,
         T.Source
  FROM Ticket AS T
  WHERE SalonID=@SalonID AND ((DATEDIFF(d, ScheduledStartDateTime, GETDATE())=0
                               --4/20/15 Andrew added @TicketStatusID_BlockOut to show Block Outs on the Check In list.
                               AND TicketStatusID IN(@TicketStatusID_ScheduledAppointment, @TicketStatusID_ConfirmedAppointment, @TicketStatusID_CalledAppointment, @TicketStatusID_BlockOut)) OR (TicketStatusID IN(@TicketStatusID_Inservice, @TicketStatusID_Waiting, @TicketStatusID_CallAhead)))">INSERT #t0
  (  
     TicketID,
     StartDateTime,
     ScheduledStartDateTime,
     Scheduled...</td><td class="metric-value">17,530</td><td class="metric-value">49.94</td><td>420</td><td>3,548</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                        FROM Ticket AS T
                                        INNER JOIN Guest AS G2
                                                  ON G2.GuestID=T.GuestID
                                        INNER JOIN TicketLineItem AS TLI
                                                  ON T.TicketID=TLI.TicketID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Product AS P
                                                  ON P.ProductID=TLI.ProductID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Salon AS S
                                                  ON S.SalonID=T.SalonID
                                        WHERE G2.GuestID=@GuestID
                                              AND T.TicketStatusID=@TicketStatusID_CheckedOut
                                              AND dbo.Date_IsThisWeek(T.EndDateTime, 1)=1
                                              --and P.MaxPurchaseCountPerDay&gt;0 --Hannah 4-20-23 only count tickets with maxcounts

                                              AND (S.VisitCount_OnlyMaxPurchaseProducts=0 OR P.MaxPurchaseCountPerDay&gt;0)--11-2-23 fix to add field to control max purchase count
                                              ), ServiceTotal = (SELECT SUM(NetServiceAmount)
                                                                 FROM Ticket AS T
                                                                 INNER JOIN Guest AS G2
                                                                           ON G2.GuestID=T.GuestID
                                                                 WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut), ProductTotal = (SELECT SUM(NetProductAmount)
                                                                                                                                                             FROM Ticket AS T
                                                                                                                                                             INNER JOIN Guest AS G2
                                                                                                                                                                       ON G2.GuestID=T.GuestID
                                                                                                                                                             WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut)
FROM Guest AS G
WHERE G.GuestID=@GuestID">UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                   ...</td><td class="metric-value">16,797</td><td class="metric-value">25.97</td><td>838</td><td>2,974</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="INSERT @TicketLineItemTemp
(  
   TicketID,
   TicketLineItemID,
   TicketLineItemTypeID,
   ReferenceNumberID,
   ProductID,
   ProductStyleID,
   ServiceID,
   PackageID,
   GuestID_Related,
   EmployeeID,
   EmployeeID_CheckIn,
   Quantity,
   UnitPrice,
   UnitCost,
   BaseAmount,
   DiscountAmount,
   ProductAmount,
   ServiceAmount,
   TaxableAmount,
   CommissionableAmount,
   TaxAmount,
   FinalAmount,
   IsPrimary,
   IsRedo,
   WasRedone,
   IsRefund,
   WasRefunded,
   IsReturn,
   WasReturned,
   TicketLineItemID_Related,
   QuantityInDiscount,
   TicketVersion,
   ReceiptProvided,
   QuestionSetID_Guest,
   QuestionSetID_ChemicalCard,
   ProcessLineItem,
   Ordinal,
   RelatedID,
   ComputeTotal,
   EndDateTime,
   Description,
   EmployeeName,
   FirstName,
   LastName
)
SELECT T.TicketID,
       TLI.TicketLineItemID,
       TLI.TicketLineItemTypeID,
       TLI.ReferenceNumberID,
       TLI.ProductID,
       TLI.ProductStyleID,
       TLI.ServiceID,
       TLI.PackageID,
       GuestID_Related,
       TLI.EmployeeID,
       TLI.EmployeeID_CheckIn,
       Quantity,
       UnitPrice,
       TLI.UnitCost,
       BaseAmount,
       TLI.DiscountAmount,
       ProductAmount,
       ServiceAmount,
       TaxableAmount,
       CommissionableAmount,
       TLI.TaxAmount,
       FinalAmount,
       TLI.IsPrimary,
       TLI.IsRedo,
       TLI.WasRedone,
       TLI.IsRefund,
       TLI.WasRefunded,
       TLI.IsReturn,
       TLI.WasReturned,
       TicketLineItemID_Related,
       QuantityInDiscount,
       TLI.TicketVersion,
       ReceiptProvided,
       TLI.QuestionSetID_Guest,
       TLI.QuestionSetID_ChemicalCard,
       ProcessLineItem,
       Ordinal,
       RelatedID,
       TLI.ComputeTotal,
       EndDateTime,
       CASE
           WHEN Pkg.Name IS NOT NULL THEN Pkg.Name
           WHEN S.Name IS NOT NULL THEN S.Name
           ELSE P.Name
       END,
       E.DisplayName,
       G2.FirstName,
       G2.LastName
FROM TicketLineItem AS TLI
INNER JOIN Ticket AS T
          ON T.TicketID=TLI.TicketID
LEFT OUTER JOIN TicketLineItemType AS TLIT
          ON TLI.TicketLineItemTypeID=TLIT.TicketLineItemTypeID
LEFT OUTER JOIN Package AS Pkg
          ON Pkg.PackageID=TLI.PackageID
LEFT OUTER JOIN Product AS P
          ON P.ProductID=TLI.ProductID
LEFT OUTER JOIN Service AS S
          ON S.ServiceID=TLI.ServiceID
LEFT OUTER JOIN Guest AS G
          ON G.GuestID=TLI.GuestID_Related
LEFT OUTER JOIN Guest AS G2
          ON G2.GuestID=T.GuestID
LEFT OUTER JOIN Employee AS E
          ON E.EmployeeID=TLI.EmployeeID
LEFT OUTER JOIN Employee AS ECI
          ON ECI.EmployeeID=TLI.EmployeeID
LEFT OUTER JOIN TicketStatus AS TS
          ON TS.TicketStatusID=T.TicketStatusID
WHERE (SalonBusinessDayID=@SalonBusinessDayID OR @SalonBusinessDayID IS NULL)
      AND (TS.IsPending=1 OR @LimitToPending=0)
      AND (TS.IsPending=0 OR @LimitToNotPending=0)
      AND (T.SalonID=@SalonID OR @SalonID IS NULL)
      AND (@RestrictToGuestID IS NULL OR T.GuestID=@RestrictToGuestID)">INSERT @TicketLineItemTemp
(  
   TicketID,
   TicketLineItemID,
   TicketLineItemTypeID,
   Re...</td><td class="metric-value">16,242</td><td class="metric-value">46.93</td><td>419</td><td>5,340</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 'S',
       S.ServiceID,
       HandCode_Default,
       S.Name,
       COALESCE(Popularity, Popularity_Default) AS Popularity,
       COALESCE(SPL.UnitPrice, UnitPrice_Default) AS Price,
       ST.Name AS TypeName,
       ST.ServiceTypeID AS TypeID,
       NULL AS DisplayColor
FROM Service AS S
LEFT OUTER JOIN Service_PriceLevel AS SPL
          ON SPL.ServiceID=S.ServiceID AND SPL.PriceLevelID=@PriceLevelID_Service
LEFT OUTER JOIN Salon_Service AS SS
          ON SS.ServiceID=S.ServiceID AND SS.SalonID=@SalonID
LEFT OUTER JOIN ServiceType AS ST
          ON ST.ServiceTypeID=S.ServiceTypeID
WHERE COALESCE(Popularity, Popularity_Default)&gt;0
      --UNION ALL
      --SELECT  'P',
      --        S.ProductID,
      --        HandCode_Default,
      --        S.Name,
      --        COALESCE(Popularity, Popularity_Default),
      --        COALESCE(SPL.UnitPrice, UnitPrice_Default),
      --        PT.Name
      --FROM    Product AS S
      --        LEFT OUTER JOIN Product_PriceLevel AS SPL
      --            ON SPL.ProductID = S.ProductID
      --               AND SPL.PriceLevelID = @PriceLevelID_Product
      --        LEFT OUTER JOIN Salon_Product AS SS
      --            ON SS.ProductID = S.ProductID
      --               AND SS.SaloniD = @SalonID
      --        LEFT OUTER JOIN ProductType AS PT
      --            ON PT.ProductTypeID = S.ProductTypeID
      --WHERE   COALESCE(Popularity, Popularity_Default) &gt; 0
      --ORDER BY COALESCE(Popularity, Popularity_Default),
      --        HandCode_Default

UNION ALL
SELECT 'P',
       P.ProductID,
       HandCode_Default,
       P.Name,
       Qty AS Popularity,  -- COALESCE(Popularity, Popularity_Default),
      COALESCE(SPL.UnitPrice, UnitPrice_Default) AS Price,
       PT.Name AS TypeName,
       PT.ProductTypeID AS TypeID,
       PL.DisplayColor
FROM Quantity AS Q, Product AS P
LEFT OUTER JOIN Product_PriceLevel AS SPL
          ON SPL.ProductID=P.ProductID AND SPL.PriceLevelID=@PriceLevelID_Product
LEFT OUTER JOIN Salon_Product AS SS
          ON SS.ProductID=P.ProductID AND SS.SalonID=@SalonID
LEFT OUTER JOIN ProductType AS PT
          ON PT.ProductTypeID=P.ProductTypeID
LEFT OUTER JOIN ProductLine AS PL
          ON PL.ProductLineID=p.ProductLineID
WHERE COALESCE(SS.IsActive, P.IsActive)=1 AND COALESCE(SS.Popularity, P.Popularity_Default) LIKE '%|' + CONVERT(VARCHAR(100), Qty) + '|%'
ORDER BY Popularity, HandCode_Default">SELECT 'S',
       S.ServiceID,
       HandCode_Default,
       S.Name,
       COALESCE(Populari...</td><td class="metric-value">13,950</td><td class="metric-value">29.20</td><td>563</td><td>256</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @SalonID AS SalonID,
         T.EmployeeID_Current,
         COALESCE(MAX(CASE
                          WHEN T.TicketStatusID=2 THEN InServiceDateTime
                          ELSE NULL
                      END), MAX(EndDateTime), '1/1/1900') AS LastTicketInServiceDateTime,
         MAX(ISNULL(EndDateTime, '1/1/1900')) AS LastTicketEndDateTime,
         CASE
             WHEN COALESCE(MAX(CASE
                                   WHEN T.TicketStatusID=2 AND EndDateTime IS NULL THEN InServiceDateTime
                                   ELSE NULL
                               END), '1/1/1900')&lt;&gt;'1/1/1900' THEN 1
             ELSE 0
         END AS InServiceExists --8/1/2011 Matt added the and EndDateTime is null clause so that if they stop the time for a guest, they won't show In Service
        
  INTO #T1
  FROM Ticket AS T
  WHERE T.TicketStatusID IN(1, 2, 3)
        AND DATEDIFF(d, T.StartDateTime, GETDATE())=0
        AND SalonID=@SalonID
        AND ISNULL(T.ContainsService, 1)=1
  GROUP BY EmployeeID_Current">SELECT @SalonID AS SalonID,
         T.EmployeeID_Current,
         COALESCE(MAX(CASE
           ...</td><td class="metric-value">10,599</td><td class="metric-value">29.48</td><td>420</td><td>1,158</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET VisitCount = (SELECT COUNT(T.TicketID)
                               FROM Ticket AS T
                               INNER JOIN Guest AS G2
                                         ON G2.GuestID=T.GuestID
                               INNER JOIN TicketLineItem AS TLI
                                         ON T.TicketID=TLI.TicketID --Hannah 4-20-23 only count tickets with maxcounts

                               INNER JOIN Product AS P
                                         ON P.ProductID=TLI.ProductID --Hannah 4-20-23 only count tickets with maxcounts

                               INNER JOIN Salon AS S
                                         ON S.SalonID=T.SalonID
                               WHERE G2.GuestID=@GuestID
                                     AND T.TicketStatusID=@TicketStatusID_CheckedOut 
                                     --AND DateDIFF(Day,T.EndDateTime,'2023-08-13')&lt;0 --Added date compare to force visit count to reset at semester 01-18-2023 DG 

                                     AND (S.VisitCount_BySemester=0 OR dbo.Date_IsThisSemester(T.EndDateTime)=1)
                                     --and P.MaxPurchaseCountPerDay&gt;0 --Hannah 4-20-23 only count tickets with maxcounts

                                     AND (S.VisitCount_OnlyMaxPurchaseProducts=0 OR P.MaxPurchaseCountPerDay&gt;0)--11-2-23 fix to add field to control max purchase count
                                     ), ServiceTotal = (SELECT SUM(NetServiceAmount)
                                                        FROM Ticket AS T
                                                        INNER JOIN Guest AS G2
                                                                  ON G2.GuestID=T.GuestID
                                                        WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut), ProductTotal = (SELECT SUM(NetProductAmount)
                                                                                                                                                    FROM Ticket AS T
                                                                                                                                                    INNER JOIN Guest AS G2
                                                                                                                                                              ON G2.GuestID=T.GuestID
                                                                                                                                                    WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut)
FROM Guest AS G
WHERE G.GuestID=@GuestID">UPDATE Guest SET VisitCount = (SELECT COUNT(T.TicketID)
                               FROM Ticket A...</td><td class="metric-value">9,407</td><td class="metric-value">15.98</td><td>838</td><td>2,580</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,823</td><td class="metric-value">1,265.90</td><td>6</td><td>245,294</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_Windermere</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="INSERT #t0
  (  
     TicketID,
     StartDateTime,
     ScheduledStartDateTime,
     ScheduledEndDateTime,
     TicketStatusID,
     EmployeeID_Current,
     ServiceID_Primary,
     EstimatedWaitTimeInMinutes,
     InServiceDateTime,
     WaitStartDateTime,
     EndDateTime,
     CallAheadDateTime,
     ContainsRequest,
     TicketPaymentID,
     GuestID,
     EstimatedDurationInMinutes,
     HasMultipleEmployees,
     Source
  )
  SELECT TicketID,
         StartDateTime,
         ScheduledStartDateTime,
         ScheduledEndDateTime,
         TicketStatusID,
         EmployeeID_Current,
         ServiceID_Primary,
         EstimatedWaitTimeInMinutes,
         InServiceDateTime,
         WaitStartDateTime,
         EndDateTime,
         CallAheadDateTime,
         ContainsRequest,
         TicketPaymentID,
         GuestID,
         EstimatedDurationInMinutes,
         HasMultipleEmployees,
         T.Source
  FROM Ticket AS T
  WHERE SalonID=@SalonID AND ((DATEDIFF(d, ScheduledStartDateTime, GETDATE())=0
                               --4/20/15 Andrew added @TicketStatusID_BlockOut to show Block Outs on the Check In list.
                               AND TicketStatusID IN(@TicketStatusID_ScheduledAppointment, @TicketStatusID_ConfirmedAppointment, @TicketStatusID_CalledAppointment, @TicketStatusID_BlockOut)) OR (TicketStatusID IN(@TicketStatusID_Inservice, @TicketStatusID_Waiting, @TicketStatusID_CallAhead)))">INSERT #t0
  (  
     TicketID,
     StartDateTime,
     ScheduledStartDateTime,
     Scheduled...</td><td class="metric-value">89,450</td><td class="metric-value">115.08</td><td>950</td><td>8,551</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET DisplayName = DisplayName + ' !' + CASE
                                                        WHEN GS.EmployeeID_Stylist=-2 THEN 'M'
                                                        WHEN GS.EmployeeID_Stylist=-3 THEN 'F'
                                                        ELSE ''
                                                    END + ':' + CASE
                                                                    WHEN GS2.EmployeeID_Stylist=-2 THEN 'M'
                                                                    WHEN GS2.EmployeeID_Stylist=-3 THEN 'F'
                                                                    ELSE ''
                                                                END
FROM Guest AS G
LEFT OUTER JOIN Guest_Stylist AS GS
          ON GS.GuestID=G.GuestID
             AND GS.EmployeeID_Stylist IN(-2, -3)
             AND GS.Ordinal=1
LEFT OUTER JOIN Guest_Stylist AS GS2
          ON GS2.GuestID=G.GuestID
             AND GS2.EmployeeID_Stylist IN(-2, -3)
             AND GS2.Ordinal=2
WHERE (@GuestID IS NULL OR @GuestID=G.GuestID)
      AND (GS.EmployeeID_Stylist IN(-2, -3) OR GS2.EmployeeID_Stylist IN(-2, -3))
      AND COALESCE(DisplayName, 'NULL')&lt;&gt;DisplayName + ' !' + CASE
                                                                  WHEN GS.EmployeeID_Stylist=-2 THEN 'M'
                                                                  WHEN GS.EmployeeID_Stylist=-3 THEN 'F'
                                                                  ELSE ''
                                                              END + ':' + CASE
                                                                              WHEN GS2.EmployeeID_Stylist=-2 THEN 'M'
                                                                              WHEN GS2.EmployeeID_Stylist=-3 THEN 'F
'
                                                                              ELSE ''
                                                                          END">UPDATE Guest SET DisplayName = DisplayName + ' !' + CASE
                                           ...</td><td class="metric-value">77,972</td><td class="metric-value">19.42</td><td>4,656</td><td>135</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT AccountTransactionID,
           AT.Name,
           Amount,
           ReceivedDateTime,
           CommittedDateTime,
           VoidedDateTime,
           EffectiveDateTime,
           ExpirationDateTime,
           ReversedDateTime,
           AT.AccountID,
           A.Name AS AcccountName,
           PR.Name AS ProductName,
           AT.Notes,
		   ProductID, --Hannah 12-2-23
		   AccountTransactionTypeID
    FROM AccountTransaction AS AT
    LEFT OUTER JOIN Account AS A
              ON A.AccountID=AT.AccountID
    LEFT OUTER JOIN Person AS P
              ON P.PersonID=A.PersonID
    LEFT OUTER JOIN Product AS PR
              ON AT.POSProductGlobalKey=PR.ProductGlobalKey
    WHERE (@PersonID=A.PersonID OR ISNULL(@PersonID, -1)&lt;0) AND (@RestrictToIsActive=0 OR AT.IsActive=1)">SELECT AccountTransactionID,
           AT.Name,
           Amount,
           ReceivedDateTime,...</td><td class="metric-value">65,151</td><td class="metric-value">633.83</td><td>108</td><td>45,719</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @SalonID AS SalonID,
         T.EmployeeID_Current,
         COALESCE(MAX(CASE
                          WHEN T.TicketStatusID=2 THEN InServiceDateTime
                          ELSE NULL
                      END), MAX(EndDateTime), '1/1/1900') AS LastTicketInServiceDateTime,
         MAX(ISNULL(EndDateTime, '1/1/1900')) AS LastTicketEndDateTime,
         CASE
             WHEN COALESCE(MAX(CASE
                                   WHEN T.TicketStatusID=2 AND EndDateTime IS NULL THEN InServiceDateTime
                                   ELSE NULL
                               END), '1/1/1900')&lt;&gt;'1/1/1900' THEN 1
             ELSE 0
         END AS InServiceExists --8/1/2011 Matt added the and EndDateTime is null clause so that if they stop the time for a guest, they won't show In Service
        
  INTO #T1
  FROM Ticket AS T
  WHERE T.TicketStatusID IN(1, 2, 3)
        AND DATEDIFF(d, T.StartDateTime, GETDATE())=0
        AND SalonID=@SalonID
        AND ISNULL(T.ContainsService, 1)=1
  GROUP BY EmployeeID_Current">SELECT @SalonID AS SalonID,
         T.EmployeeID_Current,
         COALESCE(MAX(CASE
           ...</td><td class="metric-value">61,261</td><td class="metric-value">79.27</td><td>950</td><td>4,795</td></tr><tr><td>5</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @StartDateTime = MAX(d.date)
    FROM date AS d
    WHERE date&lt;GETDATE() AND dayofweek=@StartDayOfWeek">SELECT @StartDateTime = MAX(d.date)
    FROM date AS d
    WHERE date&lt;GETDATE() AND dayofweek=@...</td><td class="metric-value">53,074</td><td class="metric-value">0.03</td><td>2,283,367</td><td>3</td></tr><tr><td>6</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @EndDateTime = MIN(d.date)
    FROM date AS d
    WHERE date&gt;@StartDateTime AND dayofweek=CASE
                                                WHEN @StartDayOfWeek=1 THEN 7
                                                ELSE(@StartDayOfWeek + 6) % 7
                                            END">SELECT @EndDateTime = MIN(d.date)
    FROM date AS d
    WHERE date&gt;@StartDateTime AND dayofwee...</td><td class="metric-value">45,162</td><td class="metric-value">0.02</td><td>2,283,367</td><td>3</td></tr><tr><td>7</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @DayOfYear = JulianDay
  FROM dbo.Dates AS D
  INNER JOIN Ticket AS T
            ON DATEDIFF(d, COALESCE(T.EndDateTime, T.StartDateTime), D.Date)=0
  WHERE T.TicketID=@TicketID">SELECT @DayOfYear = JulianDay
  FROM dbo.Dates AS D
  INNER JOIN Ticket AS T
            ON DATED...</td><td class="metric-value">37,324</td><td class="metric-value">20.07</td><td>2,120</td><td>820</td></tr><tr><td>8</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.AffectsBalance,0)), 0)
    FROM AccountTransaction AS AT
    INNER JOIN AccountTransactionType AS ATT
              ON ATT.AccountTransactionTypeID=AT.AccountTransactionTypeID
    WHERE AT.AccountID=@AccountID
          AND CommittedDateTime IS NOT NULL
          AND VoidedDateTime IS NULL
          AND ArchivedDateTime IS NULL">SELECT @Total = ISNULL(@Total, 0) + ISNULL(SUM(COALESCE(AT.AccountAmount,AT.Amount,0) * IsNull(ATT.A...</td><td class="metric-value">34,444</td><td class="metric-value">1.17</td><td>30,780</td><td>398</td></tr><tr><td>9</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmountDue, LastBalanceSyncDateTime = DATEADD(ss, -60, GETDATE())
WHERE (AccountID=@AccountID OR (ISNULL(@AccountID, -1)&lt;0 AND (accountid IN(SELECT accountid
                                                                           FROM accounttransaction AS at) OR (isactive=1 AND accountid NOT IN(SELECT accountid
                                                                                                                                              FROM accounttransaction)))))">UPDATE account SET currentbalance = dbo.calculateaccountbalance(accountid), AmountDue = InitialAmoun...</td><td class="metric-value">30,757</td><td class="metric-value">220.39</td><td>183</td><td>52,888</td></tr><tr><td>10</td><td style="font-weight: bold;">SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                        FROM Ticket AS T
                                        INNER JOIN Guest AS G2
                                                  ON G2.GuestID=T.GuestID
                                        INNER JOIN TicketLineItem AS TLI
                                                  ON T.TicketID=TLI.TicketID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Product AS P
                                                  ON P.ProductID=TLI.ProductID --Hannah 4-20-23 only count tickets with maxcounts

                                        INNER JOIN Salon AS S
                                                  ON S.SalonID=T.SalonID
                                        WHERE G2.GuestID=@GuestID
                                              AND T.TicketStatusID=@TicketStatusID_CheckedOut
                                              AND dbo.Date_IsThisWeek(T.EndDateTime, 1)=1
                                              --and P.MaxPurchaseCountPerDay&gt;0 --Hannah 4-20-23 only count tickets with maxcounts

                                              AND (S.VisitCount_OnlyMaxPurchaseProducts=0 OR P.MaxPurchaseCountPerDay&gt;0)--11-2-23 fix to add field to control max purchase count
                                              ), ServiceTotal = (SELECT SUM(NetServiceAmount)
                                                                 FROM Ticket AS T
                                                                 INNER JOIN Guest AS G2
                                                                           ON G2.GuestID=T.GuestID
                                                                 WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut), ProductTotal = (SELECT SUM(NetProductAmount)
                                                                                                                                                             FROM Ticket AS T
                                                                                                                                                             INNER JOIN Guest AS G2
                                                                                                                                                                       ON G2.GuestID=T.GuestID
                                                                                                                                                             WHERE G2.GuestID=@GuestID AND T.TicketStatusID=@TicketStatusID_CheckedOut)
FROM Guest AS G
WHERE G.GuestID=@GuestID">UPDATE Guest SET VisitCount_ThisWeek = (SELECT COUNT(T.TicketID)
                                   ...</td><td class="metric-value">24,750</td><td class="metric-value">61.70</td><td>513</td><td>8,923</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: SVDB_WindermerePreImport07232025DONOTMOVE</td></tr><tr><td>1</td><td style="font-weight: bold;">SVDB_WindermerePreImport07232025DONOTMOVE</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_runtime_stats_interval WHERE end_time &lt; @clean_up_time">DELETE sys.plan_persist_runtime_stats_interval WHERE end_time &lt; @clean_up_time</td><td class="metric-value">4</td><td class="metric-value">58.29</td><td>2</td><td>14</td></tr><tr><td>2</td><td style="font-weight: bold;">SVDB_WindermerePreImport07232025DONOTMOVE</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">3</td><td class="metric-value">56.12</td><td>4</td><td>14</td></tr><tr><td>3</td><td style="font-weight: bold;">SVDB_WindermerePreImport07232025DONOTMOVE</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS                             	JOIN sys.plan_persist_runtime_stats_interval I                  	ON WS.runtime_stats_interval_id = I.runtime_stats_interval_id   	WHERE I.end_time &lt; @threshold_time">DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS...</td><td class="metric-value">3</td><td class="metric-value">28.51</td><td>4</td><td>33</td></tr><tr><td>4</td><td style="font-weight: bold;">SVDB_WindermerePreImport07232025DONOTMOVE</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_WindermerePreImport07232025DONOTMOVE].[sys].[filetable_updates_1890574269] with (readpast) order by table_id">select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [SVDB_WindermerePreImpor...</td><td class="metric-value">0</td><td class="metric-value">0.07</td><td>1</td><td>0</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TEST_SVDB_AHEC_20250903</td></tr><tr><td>1</td><td style="font-weight: bold;">TEST_SVDB_AHEC_20250903</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS                             	JOIN sys.plan_persist_runtime_stats_interval I                  	ON WS.runtime_stats_interval_id = I.runtime_stats_interval_id   	WHERE I.end_time &lt; @threshold_time">DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS...</td><td class="metric-value">7</td><td class="metric-value">46.44</td><td>4</td><td>34</td></tr><tr><td>2</td><td style="font-weight: bold;">TEST_SVDB_AHEC_20250903</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">3</td><td class="metric-value">18.44</td><td>4</td><td>15</td></tr><tr><td>3</td><td style="font-weight: bold;">TEST_SVDB_AHEC_20250903</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE sys.plan_persist_runtime_stats_interval WHERE end_time &lt; @clean_up_time">DELETE sys.plan_persist_runtime_stats_interval WHERE end_time &lt; @clean_up_time</td><td class="metric-value">2</td><td class="metric-value">8.18</td><td>3</td><td>23</td></tr><tr><td>4</td><td style="font-weight: bold;">TEST_SVDB_AHEC_20250903</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [TEST_SVDB_AHEC_20250903].[sys].[filetable_updates_1890574269] with (readpast) order by table_id">select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [TEST_SVDB_AHEC_20250903...</td><td class="metric-value">0</td><td class="metric-value">0.06</td><td>1</td><td>0</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_AffordableCDL</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,278</td><td class="metric-value">1,093.89</td><td>6</td><td>232,413</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,970</td><td class="metric-value">1,556.04</td><td>4</td><td>140,972</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,921</td><td class="metric-value">566.79</td><td>6</td><td>171,405</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,270</td><td class="metric-value">732.70</td><td>6</td><td>1,413</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">1,504</td><td class="metric-value">430.69</td><td>4</td><td>54,284</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">789</td><td class="metric-value">164.99</td><td>6</td><td>40,891</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">759</td><td class="metric-value">382.33</td><td>2</td><td>138,236</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">643</td><td class="metric-value">161.07</td><td>4</td><td>2,241</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">516</td><td class="metric-value">129.31</td><td>4</td><td>657</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_AffordableCDL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS FunctionName, 
p.name AS FunctionOwner,
ss.name AS SchemaName,
s.object_id AS id,
s.modify_date as LastModified,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
s.type AS FunctionType,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted
FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'IF', N'FN', N'TF', N'FT', N'FS', N'AF') AND
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)">SELECT s.name AS FunctionName, 
p.name AS FunctionOwner,
ss.name AS SchemaName,
s.object_id AS id...</td><td class="metric-value">375</td><td class="metric-value">105.12</td><td>6</td><td>8,499</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_CMVT</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,296</td><td class="metric-value">2,279.42</td><td>6</td><td>220,990</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">4,090</td><td class="metric-value">1,835.62</td><td>4</td><td>100,636</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,764</td><td class="metric-value">643.07</td><td>6</td><td>155,302</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,241</td><td class="metric-value">939.75</td><td>6</td><td>1,401</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,181</td><td class="metric-value">497.30</td><td>6</td><td>53,388</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">1,008</td><td class="metric-value">499.71</td><td>3</td><td>15,346</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">945</td><td class="metric-value">195.65</td><td>6</td><td>2,223</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">793</td><td class="metric-value">171.86</td><td>6</td><td>40,056</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">767</td><td class="metric-value">166.88</td><td>6</td><td>650</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_CMVT</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">742</td><td class="metric-value">446.02</td><td>2</td><td>132,361</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_Fleet001</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
       PRI.EnteredDate,
       PRI.ProcedureInstanceID,
	   PIS.ProcedureInstanceStepID,
	   PISC.ProcedureInstanceStepComponentID,
	   PISCI.ProcedureInstanceStepComponentInstructorID,
       PRI.StudentID,
       PISCI.Comment AS Comment,
       PS.Name AS ProcedureSequenceName,
	   PSC.Name as ProcedureStepComponentName
FROM ProcedureInstance AS PRI
INNER JOIN ProcedureInstanceStep as  PIS
          ON PIS.ProcedureInstanceID=PRI.ProcedureInstanceID
INNER JOIN ProcedureInstanceStepComponent as PISC
		  ON PISC.ProcedureInstanceStepID = pis.ProcedureInstanceStepID
INNER JOIN ProcedureInstanceStepComponent_Instructor as PISCI
		  ON PISCI.ProcedureInstanceStepComponentID=pisc.ProcedureinstanceStepComponentID
INNER JOIN ProcedureStepComponent as PSC
		  ON PSC.ProcedureStepComponentID= PISC.ProcedureStepComponentID
INNER JOIN ProcedureSequence AS PS
          ON ps.ProcedureSequenceID=pri.ProcedureSequenceID
WHERE PRI.StudentID=@StudentID AND ps.ProcedureSequenceID=@ProcedureSequenceID
AND (@StartDate is null OR pri.EnteredDate &gt;= @StartDate) --hannah 7-9-24
AND PRI.ProcedureInstanceStatusID&lt;&gt;10 --hannah 7-9-24 leave out removed
AND not PISCI.Comment is null
ORDER BY PRI.EnteredDate">SELECT DISTINCT
       PRI.EnteredDate,
       PRI.ProcedureInstanceID,
	   PIS.ProcedureInstance...</td><td class="metric-value">436,674</td><td class="metric-value">429.46</td><td>1,308</td><td>37,358</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
       P.PersonID,
       P.DisplayName AS PersonName,
       SL.LocationID,
       L.Name AS LocationName,
       PRD.PersonRoleID,
       PRD.Name AS PersonRoleName,
       SP.SecurityProfileID,
       SP.Name AS SecurityProfileName,
       CASE
           WHEN COALESCE(IsPaid, 1)=1 THEN 'Paid'
           ELSE 'Not Paid'
       END AS PaidStatus,
       CONVERT(BIT, ISNULL(CONVERT(INT, PS.IsAvailable), 0)) AS IsAvailable,
       P.PersonRoleID_Default,
       PR.IsStudent,
       PRD.IsEmployee,
       PPR.EmployeeId_Instructor
      --PPR.PersonPersonRoleID,  ----- AT 04/27/2020 to remove duplicate lines
      ----- AT 04/27/2020 Replaced commented out selection of ETC below with the case below to prevent sub query error  04/28/22 DROPPED ETCIID all together
      --				CASE WHEN 	@RestrictToCheckedInToday = 0 AND @RestrictToClockedInNow = 0 THEN  NULL ELSE ETCI.EmployeeTimeCardItemID END AS TimecardItem  --AND @RestrictToNotClockedInNow = 0 
      --(
      --SELECT ETCI.EmployeeTimeCardItemID
      --FROM EmployeeTimeCardItem AS ETCI
      --WHERE ETCI.EmployeeID = P.PersonID
      --	  AND ETCI.SalonID = L.LocationID
      --	  AND DATEDIFF(d, ETCI.StartDateTime, GETDATE()) = 0
      --	  AND ETCI.EndDateTime IS NULL
      --) AS TimecardItem
      --(
      --SELECT ETCI.EmployeeTimeCardItemID
      --FROM EmployeeTimeCardItem AS ETCI
      --WHERE ETCI.EmployeeID = P.PersonID
      --	  AND ETCI.SalonID = L.LocationID
      --	  AND DATEDIFF(d, ETCI.StartDateTime, GETDATE()) = 0
      --	  AND ETCI.EndDateTime IS NULL
      --) AS TimecardItem
      --AT 06/09/2022  The following are intended to return the employeejobID so we can then use it to run the clock out event SP
      ,
       (SELECT TOP 1
               ETCI.EmployeeJobID
        FROM EmployeeTimeCardItem AS ETCI
        INNER JOIN EmployeeJob AS EJ2
                  ON ETCI.EmployeeJobID=EJ2.EmployeeJobID
        WHERE ETCI.EmployeeID=P.PersonID
              AND ETCI.SalonID=L.LocationID
              AND ETCI.EndDateTime IS NULL
              --AND DATEDIFF(d, ETCI.StartDateTime, GETDATE()) = 0

              AND EJ2.IsEvent=0
        ORDER BY ETCI.StartDateTime DESC) AS PersonRoleID_Course,
       (SELECT TOP 1
               ETCI.EmployeeJobID
        FROM EmployeeTimeCardItem AS ETCI
        INNER JOIN EmployeeJob AS EJ2
                  ON ETCI.EmployeeJobID=EJ2.EmployeeJobID
        WHERE ETCI.EmployeeID=P.PersonID
              AND ETCI.SalonID=L.LocationID
              AND ETCI.EndDateTime IS NULL
              --AND DATEDIFF(d, ETCI.StartDateTime, GETDATE()) = 0

              AND EJ2.IsEvent=1
        ORDER BY ETCI.StartDateTime DESC) AS PersonRoleID_Event,
       ( --Hannah 5-30-23 also return the start date time for the course
        SELECT TOP 1
               ETCI.StartDateTime
        FROM EmployeeTimeCardItem AS ETCI
        INNER JOIN EmployeeJob AS EJ2
                  ON ETCI.EmployeeJobID=EJ2.EmployeeJobID
        WHERE ETCI.EmployeeID=P.PersonID
              AND ETCI.SalonID=L.LocationID
              AND ETCI.EndDateTime IS NULL
              --AND DATEDIFF(d, ETCI.StartDateTime, GETDATE()) = 0

              AND EJ2.IsEvent=0
        ORDER BY ETCI.StartDateTime DESC) AS StartDateTime_Course,
       CASE
           WHEN OGS.ProcedureInstanceStatusID&gt;0 THEN 1
           ELSE 0
       END AS HasOpenGradeSheet,
       P.IsActive AS Person_IsActive,
       P.IsActive_Grading AS Person_IsActive_Grading,
       P.PersonStatusID AS Person_EmployeeStatusID,
       PPR.IsActive AS PPR_IsActive,
       P.HireDate,
       P.InitialHoursDate,
	   P.PersonStatusID --hannah 11-14-23
FROM PersonRole AS PR
INNER JOIN Person_PersonRole AS PPR
          ON PPR.PersonRoleID=PR.PersonRoleID AND PPR.IsActive=1 --AT 07/17/2022 adding IsActive check

INNER JOIN Person AS P
          ON P.PersonID=PPR.PersonID
INNER JOIN PersonRole AS PRD
          ON PRD.PersonRoleID=P.PersonRoleID_Default
             --INNER JOIN Location AS L ON L.LocationID = P.LocationID_Primary  --AT 05/04/2022 Fixed join to join into person
             --INNER JOIN Student_Location AS L ON L.LocationID = P.LocationID_Primary  --AT 06/26/2022 Fixed join person but into student location

INNER JOIN Student_Location AS SL
          ON SL.StudentID=PPR.PersonID  --AT 06/26/2022 Fixed join person but into student location

INNER JOIN Location AS L
          ON L.LocationID=SL.LocationID  --AT 06/26/2022 Fixed join person but into student location

LEFT OUTER JOIN SecurityProfile AS SP
          ON SP.SecurityProfileID=P.SecurityProfileID_Default
INNER JOIN PersonStatus AS PS
          ON PS.PersonStatusID=P.PersonStatusID
             ----- AT 04/27/2020 Added in ETCI Join to prevent above sub query error

LEFT OUTER JOIN EmployeeTimeCardItem AS ETCI
          ON ETCI.EmployeeID=P.PersonID AND ETCI.SalonID=L.LocationID
LEFT OUTER JOIN TruckTrack_OpenGradeSheets AS OGS
          ON OGS.StudentID=P.PersonID AND OGS.LocationID=L.LocationID --AND OGS.InstructorID =PPR.EmployeeId_Instructor

WHERE (P.PersonID=@PersonID
        OR @PersonID&lt;0
        OR @PersonID IS NULL)
      --AND PPR.IsActive = 1
      --AND (L.IsSchool = 0 OR PRD.IsStudent = 1 OR (PRD.IsInstructor = 1 AND P.PersonID = @PersonID_Monitor))

      AND (SL.LocationID=@LocationID
            OR @LocationID&lt;0
            OR @LocationID IS NULL)  --AT 5/2/2022 This was commented out, added it back in as requested

      AND ((@RestrictToCheckedInToday=1 AND DATEDIFF(d, ETCI.StartDateTime, GETDATE())=0)
            OR (@RestrictToClockedInNow=1
                AND DATEDIFF(d, ETCI.StartDateTime, GETDATE())=0
                AND ETCI.EndDateTime IS NULL)
            OR (@RestrictToNotClockedInNow=1
                AND NOT EXISTS(SELECT EmployeeTimeCardItemID
                               FROM EmployeeTimeCardItem
                               WHERE EmployeeID=P.PersonID
                                     AND SalonID=L.LocationID
                                     AND DATEDIFF(d, StartDateTime, GETDATE())=0
                                     AND EndDateTime IS NULL))
            OR (@RestrictToCheckedInToday=0
                AND @RestrictToClockedInNow=0
                AND @RestrictToNotClockedInNow=0))
      AND PR.IsStudent=1  --Changed this to only care if the job is marked as IsStudent = 1

      AND P.PersonID NOT IN(SELECT InstructorID
                            FROM Instructor)
      AND (PPR.EmployeeId_Instructor=@PersonID_Instructor
            OR @PersonID_Instructor IS NULL
            OR @PersonID_Instructor IN(SELECT EmployeeID
                                       FROM Employee_EmployeeJob AS EEJ3
                                       INNER JOIN Instructor AS I
                                                 ON EEJ3.EmployeeID=I.InstructorID
                                       INNER JOIN EmployeeJob AS EJ3
                                                 ON EEJ3.EmployeeJobID=EJ3.EmployeeJobID
                                       WHERE EJ3.IsStudent=1 AND EEJ3.EmployeeJobID=PR.PersonRoleID))   --This should filter down the list by the Instructors ID if passed

      AND (ETCI.EmployeeId_Instructor=@PersonID_WhoClockedIn OR @PersonID_WhoClockedIn IS NULL)   --This should filter down the list by the who clocked IN ID if passed

      --AND P.PersonStatusID=1	--AT 06/26/2022 EmployeeStatusID (from Employee) =1 (Active) --HD 11-14-23 commented this out so all statuses that are ACTIVE will come through

      AND P.IsActive=1  --AT 07/19/2022 IsActive flag from Employee

      --AND P.IsActive_Grading=1 --AT 07/19/2022  Grading flag from Employee

      AND (PR.PersonRoleID=@PersonRoleID OR @PersonRoleID IS NULL)  --AT 7/4/2022 

ORDER BY P.HireDate, PersonName">SELECT DISTINCT
       P.PersonID,
       P.DisplayName AS PersonName,
       SL.LocationID,
   ...</td><td class="metric-value">127,955</td><td class="metric-value">153.76</td><td>1,012</td><td>23,813</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT P.ProcedureInstanceID,
           P.StudentID,
           P.StudentTypeID,
           P.LocationID,
           P.LocationStationID,
           P.ProcedureSequenceID,
           P.ProcedureEvaluationTypeID,
           P.ProcedureInstanceStatusID,
           P.PatientNumber,
           P.Ordinal,
           P.RequireEveryStepEvaluationByStudent,
           P.RequireEveryStepEvaluationByInstructor,
           P.NumberOfInstructorsRequired,
           P.ProcedureInstanceID_Prior,
           P.ProcedureStepID_LastCompleted,
           P.WasOnlyPartiallyCompleted,
           P.StudentComment,
           P.EnteredDate,
           P.Source,
           P.Code,
           S.DisplayName StudentDisplayName,
           L.Name LocationName,
           LS.StationNumber LocationStationNumber,
           PIS.Name ProcedureInstanceStatusName,
           PS.Name ProcedureSequenceName,
           P.Submitted,
           PIS.Name AS ProcedureInstanceStatusName_Instructor,
           PIS.Name AS ProcedureInstanceStatusName_Student,
           LS.StationCode,     --AT 06/03/2022
          S.ProficientRoad,
           S.ProficientRange --AT 07/17/2022
          ,
           S.ProficientHazmat --Hannah 10-19-23
          ,
           COALESCE(PS.IsUnique, 0) AS IsUnique,
           COALESCE(PS.IsManualTime, 0) AS IsManualTime   --AT 11/21/2022
          ,
           I.InstructorID,
           I.DisplayName --Hannah 10-12-23
          ,
           P.RouteNumber,
           P.EvalBatchNumber --Hannah 10-16-23
          ,
           P.IsFailure --Hannah 11-147-23
          ,
           PS.ShowProficiency,   --Hannah 12-6-23
          PS.Batch_ShowPreviousInstances, --Hannah 5-30-24
		  P.TrailerNumber, 
		  P.Miles

    FROM ProcedureInstance P
    INNER JOIN ProcedureSequence PS
              ON PS.ProcedureSequenceID=P.ProcedureSequenceID
    INNER JOIN ProcedureInstance_Instructor PII --hannah 2-24-25 changed joins to INNER for both PII and I (were LEFT OUTER and slowed it down)
              ON PII.ProcedureInstanceID=P.ProcedureInstanceID
                 AND (PII.InstructorID=@InstructorID OR @InstructorID IS NULL)
                 AND PII.IsActive=1
    INNER JOIN Instructor I
              ON I.InstructorID=PII.InstructorID --Hannah 10-12-23

    LEFT OUTER JOIN Student S
              ON S.StudentID=P.StudentID
    INNER JOIN Location L
              ON L.LocationID=P.LocationID
    LEFT OUTER JOIN LocationStation LS
              ON LS.LocationStationID=P.LocationStationID
    LEFT OUTER JOIN ProcedureInstanceStatus PIS
              ON PIS.ProcedureInstanceStatusID=P.ProcedureInstanceStatusID
    WHERE (--Hannah 10-31-23 include ALL incomplete if that flag is true------------
           (@InstructorID IS NULL OR PII.InstructorID=@InstructorID)
           AND PIS.IsCompleteStatus=0
           AND @IncludeAllUnsubmitted=1
           AND P.LocationID=@LocationID --hannah 1-18-24 open should still filter by location

           AND (P.ProcedureSequenceID=@ProcedureSequenceID OR @ProcedureSequenceID IS NULL) --Hannah 1-23-24 filter by sequence

           AND (S.StudentGroupID=@StudentGroupID OR @StudentGroupID IS NULL) --Hannah 2-15-24 filter by group
           ------------------------------------------------------------------------------
           )
           OR ((P.StudentID=@StudentID
                     OR IsNull(@StudentID,-1)&lt;0 )
               AND (@InstructorID IS NULL OR PII.InstructorID=@InstructorID)
               AND (P.LocationID=@LocationID
                     OR IsNull(@LocationID,-1)&lt;0)
               AND (P.ProcedureInstanceStatusID=@ProcedureInstanceStatusID
                     OR IsNull(@ProcedureInstanceStatusID,-1)&lt;0  )
               AND (P.ProcedureSequenceID=@ProcedureSequenceID OR @ProcedureSequenceID IS NULL) --Hannah 1-23-24 filter by sequence

               AND (S.StudentGroupID=@StudentGroupID OR @StudentGroupID IS NULL) --Hannah 2-15-24 filter by group

               AND (@StartDateTime IS NULL OR DATEDIFF(d, @StartDateTime, COALESCE(P.EditedDate, P.EnteredDate))&gt;=0)
               AND (@EndDateTime IS NULL OR DATEDIFF(d, COALESCE(P.EditedDate, P.EnteredDate), @EndDateTime)&gt;=0)
               AND (@IncludeOnlyActiveStatus=0 OR PIS.IsActiveStatus=1)
               AND (((@IncludeOnlyCompleteStatus=0 OR PIS.IsCompleteStatus=1) AND (@IncludeOnlyIncompleteStatus=0 OR PIS.IsCompleteStatus=0)) OR (@IncludeOnlyCompleteStatus=1 AND @IncludeOnlyIncompleteStatus=1))
               AND (@IncludeOnlyInitialStatus=0 OR PIS.IsInitialStatus=1)) 
			   AND P.LocationStationID&lt;&gt;0 --hannah 9-24-24 to exclude ones added from time admin
    ORDER BY CASE
                 WHEN @NewestFirst=1 THEN P.EnteredDate
             END DESC, CASE
                           WHEN @NewestFirst=0 THEN P.EnteredDate
                       END">SELECT P.ProcedureInstanceID,
           P.StudentID,
           P.StudentTypeID,
           P.Lo...</td><td class="metric-value">112,679</td><td class="metric-value">122.50</td><td>1,228</td><td>50,030</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT TOP 1
           PersonImageFileName
    FROM BadgePersonInfoView AS P
    WHERE PersonID=@PersonID
          AND BadgeID=@BadgeID
		  --Hannah 12-17-24 allow inactive badge images through
          --AND IsActive=1
          --AND IsExpired=0
          --AND IsEffective=1
    ORDER BY BadgeID DESC">SELECT TOP 1
           PersonImageFileName
    FROM BadgePersonInfoView AS P
    WHERE PersonID=...</td><td class="metric-value">106,838</td><td class="metric-value">1.21</td><td>88,603</td><td>359</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT pi.procedureinstanceid,
       p.displayname,
       ps.name,
       pi.EnteredDate,
       pi.IsFailure,
       pi.IsCriticalFailure,
       p.PersonID,
	   pis.Name as ProcedureInstanceStatusName,--hannah 8/13/24
	   ES.IsWithdrawn,  --Hannah 12-17-24
	   pi.SubmitTotalString, --hannah 6-5-25
	   pi.RouteNumber, --hannah8-20-25
	   p.Sponsor, -- hannah 8-21
	   EI.DisplayName as InstructorName,
	   p.StartDate,
	   pi.StudentComment as Comment,
	   ps.IsPracticeOnly, --hannah 9-25-25 get new flag
       pi.SafetyConcernString --hannah 10-16-25
FROM person AS p



LEFT OUTER JOIN procedureinstance AS PI 
          ON pi.StudentID=p.PersonID AND (pi.EnteredDate &gt;= @MondayDate OR pi.EnteredDate is null)--hannah 9-18-25 exclude pis at the join, so that a person can still get a record if have old pi's only
LEFT OUTER JOIN proceduresequence AS ps
          ON ps.ProcedureSequenceID=pi.ProcedureSequenceID
LEFT OUTER JOIN procedureinstancestatus AS pis
          ON pis.ProcedureInstanceStatusID=pi.ProcedureInstanceStatusID
LEFT OUTER JOIN Employee as E on E.EmployeeID=p.PersonID
LEFT OUTER JOIN EmployeeStatus as ES on ES.EmployeeStatusID = E.EmployeeStatusID
LEFT OUTER JOIN ProcedureInstance_Instructor as PII on PII.ProcedureInstanceID = PI.ProcedureInstanceID
LEFT OUTER JOIN Employee as EI on EI.EmployeeID=PII.InstructorID
WHERE 
       p.LocationID_Primary=@LocationID
      AND (p.StudentGroupID=@StudentGroupID_Group2 OR @StudentGroupID_Group2 IS NULL)
      AND (p.EmployeeStatusID=@StudentStatusID_Group2 OR @StudentStatusID_Group2 IS NULL)
      --AND (pis.Name&lt;&gt;'removed' OR pis.Name is null) hannah 9-23-25 don't exclude removed, or people with only removed don't show. we'll weed them out in API
	  AND (pi.EnteredDate &gt;= @MondayDate OR pi.EnteredDate is null)
ORDER BY ES.IsWithdrawn, p.displayname, CAST(pi.entereddate AS DATE)">SELECT pi.procedureinstanceid,
       p.displayname,
       ps.name,
       pi.EnteredDate,
    ...</td><td class="metric-value">72,055</td><td class="metric-value">64.12</td><td>1,245</td><td>4,265</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT P.ProcedureInstanceStepID,
       I.InstructorID,
       P.ProcedureInstanceStepInstructorID,
       P.Grade,
       P.Comment,
       P.Ordinal,
       P.EnteredDate,
       P.EditedDate,
       P.EditVersion,
       P.RecordID_Source,
       P.LocationID_Source,
       P.Source,
       P.Code,
       I.DisplayName AS InstructorDisplayName,
       PS.ProcedureInstanceID,
       PS.ProcedureStepID,
       PS2.ProcedureSequenceID,
       PS2.Name AS ProcedureSequenceName
FROM ProcedureInstance AS PIn
INNER JOIN ProcedureInstanceStep AS PS
          ON PS.ProcedureInstanceID=PIn.ProcedureInstanceID
INNER JOIN ProcedureInstanceStep_Instructor AS P
          ON P.ProcedureInstanceStepID=PS.ProcedureInstanceStepID
LEFT OUTER JOIN ProcedureSequence AS PS2
          ON PS2.ProcedureSequenceID=PS.ProcedureSequenceID
INNER JOIN Instructor AS I
          ON I.InstructorID=P.InstructorID
INNER JOIN ProcedureInstance_Instructor AS PII
          ON PII.ProcedureInstanceID=PIn.ProcedureInstanceID AND PII.InstructorID=I.InstructorID
LEFT OUTER JOIN ProcedureInstanceStatus AS PIS
          ON (PII.IsActive=1 AND PIS.ProcedureInstanceStatusID=PII.ProcedureInstanceStatusID) OR (PII.IsActive=0 AND PIS.ProcedureInstanceStatusID=PIn.ProcedureInstanceStatusID)
WHERE PIn.ProcedureInstanceID=@ProcedureInstanceID AND (PII.IsActive=1 OR PIS.IsCompleteStatus=1)
ORDER BY P.Ordinal, PS.ProcedureInstanceStepID">SELECT P.ProcedureInstanceStepID,
       I.InstructorID,
       P.ProcedureInstanceStepInstructorI...</td><td class="metric-value">67,609</td><td class="metric-value">68.05</td><td>1,246</td><td>4,463</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
     ETCI.EmployeeID, ProficientRoad, ProficientRange
INTO #ETCI_EmployeeID
FROM EmployeeTimeCardItem AS ETCI
INNER JOIN Employee AS E
        ON ETCI.EmployeeID=E.EmployeeID --120
           
LEFT JOIN TruckTrack_Grades AS TG
        ON TG.StudentID=ETCI.EmployeeID AND TG.EmployeeJobID=ETCI.EmployeeJobID
JOIN EmployeeStatus AS ES
        ON E.EmployeeStatusID=ES.EmployeeStatusID          
           --TASK: Need to check this once we start adding time records for Theory
           
WHERE 1=1  --39
    --AND (   (E.ProficientRoadDate BETWEEN @StartDateTime AND  CONVERT(DATETIME, .99 + FLOOR( CONVERT(FLOAT, @EndDateTime) ) ) ) 
    --     OR (E.ProficientRangeDate BETWEEN @StartDateTime AND  CONVERT(DATETIME, .99 + FLOOR( CONVERT(FLOAT, @EndDateTime) ) ) ) 
    --  OR @StartDateTime IS NULL)
    
    AND ES.IsAvailableForTPR=1 --hannah 1-23-24 limit tpr by employee status
    
    AND ((
          --Hannah 10-26 commented out to allow old ones through
          -- (E.ProficientRoadDate &gt;= @StartDateTime OR E.ProficientRangeDate &gt;= @StartDateTime OR @StartDateTime IS NULL) AND
          (E.ProficientRoadDate&lt;@EndDateTime
            OR E.ProficientRangeDate&lt;@EndDateTime
            OR @EndDateTime IS NULL))
          OR (((TG.TYPE='IsTheory'
                 OR TG.TPR_Training_IsHazmat=1
                 OR TG.TPR_Training_IsPassenger=1
                 OR TG.TPR_Training_IsSchoolBus=1))
              --Hannah 10-26 commented out to allow old ones through
              --AND (TG.EnteredDate &gt;= @StartDateTime OR @StartDateTime IS NULL)
              
              AND (TG.EnteredDate&lt;@EndDateTime OR @EndDateTime IS NULL)
              AND TG.ProcedureInstanceStatusID=5 --Hannah 6-29-23 only show theory if the grade is submitted
              ))
    AND (E.HireDate=@StudentStartDate OR @StudentStartDate IS NULL)">SELECT DISTINCT
     ETCI.EmployeeID, ProficientRoad, ProficientRange
INTO #ETCI_EmployeeID
FROM ...</td><td class="metric-value">42,835</td><td class="metric-value">917.58</td><td>53</td><td>52,615</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT *
INTO #Theory_ToUpdate
FROM (  
      SELECT DISTINCT
             StudentID,
             Student,
             TG.EmployeeJobID,
             TG.EnteredDate,
             Grade,
             CASE
                 WHEN PSE.[Type]='IsTheory'
                 AND ((TG.TPR_Training_IsHazmat IS NULL OR TG.TPR_Training_IsHazmat=0)
                      AND (TG.TPR_Training_IsPassenger IS NULL OR TG.TPR_Training_IsPassenger=0)
                      AND (TG.TPR_Training_IsSchoolBus IS NULL OR TG.TPR_Training_IsSchoolBus=0)) THEN 1
                 ELSE 0
             END AS TPR_Training_IsTheory,
             CASE
                 WHEN TG.TPR_Training_IsHazmat=1 THEN 1
                 ELSE 0
             END AS TPR_Training_IsHazmat,
             CASE
                 WHEN TG.TPR_Training_IsPassenger=1 THEN 1
                 ELSE 0
             END AS TPR_Training_IsPassenger,
             CASE
                 WHEN TG.TPR_Training_IsSchoolBus=1 THEN 1
                 ELSE 0
             END AS TPR_Training_IsSchoolBus,
             ROW_NUMBER() OVER(PARTITION BY TG.EmployeeJobID, StudentID ORDER BY stepordinal DESC, stepcomponentordinal DESC, TG.entereddate DESC) AS GradeRow --hannah 6-22-23  add ordinals to order by to  make sure last grade of sheet wins and is the official score
            
      FROM TruckTrack_Grades AS TG
      INNER JOIN ProcedureSequence_EmployeeJob AS PSE
                ON TG.ProcedureSequenceID=PSE.ProcedureSequenceID
      WHERE TG.EnteredDate&lt;=@EndDateTime  --AT 11/01/2022  --Hannah 10-26 allow old ones through BETWEEN @StartDateTime AND
            --AND (TG.TPR_Training_IsHazmat =1 OR TG.TPR_Training_IsPassenger = 1 OR TG.TPR_Training_IsSchoolBus = 1) --AT 11/01/2022	
            
            AND PSE.[Type]='IsTheory'   --(TG.TPR_Training_IsHazmat =1 OR TG.TPR_Training_IsPassenger = 1 OR TG.TPR_Training_IsSchoolBus = 1) --AT 11/15/2022		
            
            AND TG.Grade IS NOT NULL --Hannah 1-13-24 weed out nulls
            
   ) AS T
WHERE GradeRow=1">SELECT *
INTO #Theory_ToUpdate
FROM (  
      SELECT DISTINCT
             StudentID,
         ...</td><td class="metric-value">39,273</td><td class="metric-value">825.71</td><td>53</td><td>49,548</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT P.ProcedureInstanceStepComponentID,
       P.Grade,
       P.Comment,
       P.LocationID_Source,
       PS.ProcedureInstanceStepID,
       PC.ProcedureStepComponentID,
       P.Locked,
	   P.CheckOffData,
	   P.InstructorID,
	   PIn.ProcedureInstanceID,
	   PIn.EnteredDate,
	   PIn.ProcedureInstanceStatusID,
	   pIn.IsFailure
FROM ProcedureInstance AS PIn
INNER JOIN ProcedureInstanceStep AS PS
          ON PS.ProcedureInstanceID=PIn.ProcedureInstanceID
INNER JOIN ProcedureInstanceStepComponent AS PC
          ON PC.ProcedureInstanceStepID=PS.ProcedureInstanceStepID
INNER JOIN ProcedureInstanceStepComponent_Instructor AS P
          ON P.ProcedureInstanceStepComponentID=PC.ProcedureInstanceStepComponentID
LEFT OUTER JOIN ProcedureInstanceStatus AS PIS
          ON PIS.ProcedureInstanceStatusID=PIn.ProcedureInstanceStatusID
WHERE PIn.StudentID=@StudentID 
AND (  PIS.IsActiveStatus=1)
AND PIn.ProcedureSequenceID=@ProcedureSequenceID 
And PIn.LocationID=@LocationID
ORDER BY PIn.ProcedureInstanceID">SELECT P.ProcedureInstanceStepComponentID,
       P.Grade,
       P.Comment,
       P.LocationID_...</td><td class="metric-value">33,842</td><td class="metric-value">138.48</td><td>300</td><td>1,649</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT ETCI.*,
     CASE
         WHEN E.Code IS NULL THEN CONVERT(VARCHAR, E.EmployeeID)
         ELSE E.Code
     END AS Number --AT 11/15/2022    --E.Code   --SyStudentID
    ,
     PermitNumber = E.TPR_PermitNumber,
     [State] = 'US-' + ST.StateCode,
     FirstName = E.FirstName,
     LastName = E.LastName,
     DateOfBirth = E.BirthDate,
     ClassEndorsementCode = CASE
                                WHEN EJETCI.TPR_ClassEndorsementCode LIKE '_,%' THEN LEFT(EJETCI.TPR_ClassEndorsementCode, 1)
                                WHEN LEN(EJETCI.TPR_ClassEndorsementCode)=1 THEN EJETCI.TPR_ClassEndorsementCode
                                ELSE 'A'
                            END --(subpart 'Class' values{â€œAâ€, â€œBâ€, â€œPâ€, â€œSâ€, â€œHâ€})
                            ,
     ApplicationType = EJETCI.TPR_ApplicationType --(subpart 'AppType' values{â€œNewâ€, â€œUpgradeâ€)
    ,
     ProviderLocationId = S.TPR_ProviderLocationId,
     Training_StartDateTime = ETCI.StartDateTime,
     Training_EndDateTime = ETCI.EndDateTime,
     Training_Type = CASE
                         WHEN EJETCI.TPR_Training_IsTheory=1 THEN 'Theory'
                         WHEN EJETCI.TPR_Training_IsPublicRoad=1 THEN 'PublicRoad'
                         WHEN EJETCI.TPR_Training_IsRange=1 THEN 'Range'
                         ELSE ''
                     END --(subpart â€œTraining Typeâ€ Values {â€œTheoryâ€, â€œPublicRoadâ€, â€œRangeâ€})
                     ,
     EJETCI.TPR_Training_IsPublicRoad,
     EJETCI.TPR_Training_IsRange,
     EJETCI.TPR_Training_IsTheory,
     0 AS TPR_Training_IsHazmat,
     0 AS TPR_Training_IsPassenger,
     0 AS TPR_Training_IsSchoolBus,
     CASE
         WHEN EJETCI.TPR_Training_IsPublicRoad=1 THEN E.ProficientRoad
         ELSE 0
     END AS ProficientRoad,
     CASE
         WHEN EJETCI.TPR_Training_IsRange=1 THEN E.ProficientRange
         ELSE 0
     END AS ProficientRange,
     Completion_Date = ETCI.EndDateTime,
     Training_Method = CASE
                           WHEN EJETCI.TPR_Training_IsOnline=1 THEN 'Online'
                           ELSE 'InPerson'
                       END -- (subpart â€œMethodâ€ Values{â€œOnlineâ€,â€InPersonâ€})
                       ,
     [Hours] = CASE
                   WHEN EJETCI.Time_PostToTPR=1 AND (EJETCI.TPR_Training_IsPublicRoad=1 OR EJETCI.TPR_Training_IsRange=1) THEN ETCI.TotalHoursWorked
                   ELSE NULL
               END,
     ETCI.EmployeeTimeCardItemGlobalKey AS InternalID
    
    -- AT 10/07/2022 putting back to the MTI version where it uses grade sheet per adding multiple theory scores to base things from
    ,
     -1 AS Score--set score initialization as double hannah 6-22-23
    ,
     ETCI.Uploaded AS HasPosted,
     ETCI.UploadedDateTime AS PostedDate,  --Hannah 4-29-24
    0 AS Grad,
     0 AS ReadyToPost,
     @Notes AS Notes,
     EI.DisplayName AS ApprovedBy,
     CASE
         WHEN ApprovedDateTime IS NOT NULL OR TotalHoursWorked=0 THEN 1
         ELSE 0
     END AS Approved, --hannah 9-4-24  If its approved OR no hours count as approved
     EJETCI.Name AS EventName,
     E.ProficientRoadDate,
     E.ProficientRangeDate
INTO #ETCI_ToUpdate
FROM EmployeeTimeCardItem AS ETCI
INNER JOIN #ETCI_EmployeeID AS ETCI_EID
        ON ETCI_EID.EmployeeID=ETCI.EmployeeID
INNER JOIN Employee AS E
        ON ETCI.EmployeeID=E.EmployeeID --120
           
INNER JOIN EmployeeJob AS EJETCI
        ON EJETCI.EmployeeJobID=ETCI.EmployeeJobID
           AND EJETCI.IsStudent=1  --95
           
           AND (EJETCI.Event_PostToTPR=1 OR EJETCI.Time_PostToTPR=1)  --46
           
           AND ((E.ProficientRoad=1
                 AND EJETCI.TPR_Training_IsPublicRoad=1
                 AND E.ProficientRoadDate&lt;=@EndDateTime --Hannah 10-26 allow old ones through BETWEEN @StartDateTime AND
                 --AND E.ProficientRoadDate BETWEEN @StartDateTime AND CONVERT(DATETIME, .99 + FLOOR( CONVERT(FLOAT, @EndDateTime) ) ) 
                 )
                 OR (E.ProficientRange=1
                     AND EJETCI.TPR_Training_IsRange=1
                     AND E.ProficientRangeDate&lt;=@EndDateTime --Hannah 10-26 allow old ones through BETWEEN @StartDateTime AND
                     --AND E.ProficientRangeDate BETWEEN @StartDateTime AND CONVERT(DATETIME, .99 + FLOOR( CONVERT(FLOAT, @EndDateTime) ) ) 													 
                     )
                 OR EJETCI.TPR_Training_IsTheory=1)
INNER JOIN Salon AS S
        ON S.SalonID=ETCI.SalonID  --46
           
LEFT OUTER JOIN State AS ST
        ON ST.StateID=E.TPR_PermitStateID  --46
           --TEMP: REMOVE THIS UNTIL WE CAN FIND OUT ABOUT INTITUTION         INNER JOIN Institution AS I ON I.InstitutionID = S.SalonID_Institution
           
LEFT OUTER JOIN ProcedureInstance AS PI_Grading
        ON PI_Grading.ProcedureInstanceID=ETCI.ProcedureInstanceID --46
           
LEFT OUTER JOIN ProcedureInstanceStep AS PIS
        ON PI_Grading.ProcedureInstanceID=PIS.ProcedureInstanceID
           --LEFT OUTER JOIN [TruckTrack_Grades] AS TG ON PIS.ProcedureInstanceStepID = TG.ProcedureInstanceStepID  -- Changing link to EMployeeJobID --AT 10/09/2022
           --LEFT OUTER JOIN [TruckTrack_Grades] AS TG ON TG.StudentID = ETCI.EmployeeID AND ETCI.EmployeeJobID = TG.EmployeeJobID AND TG.ProcedureSequenceID != @ProcedureSequenceID_Professionalism
           
LEFT OUTER JOIN Employee AS EI
        ON EI.EmployeeID=ETCI.EmployeeID_Instructor
           
           --TASK: Need to check this once we start adding time records for Theory
           
WHERE 1=1  --39
    --TEMP: We will come back and revist this in a month or two  --AND ETCI.ApprovedDateTime IS NOT NULL     --Not sure how we are approving
    
    AND ETCI.ExportedDateTime IS NULL
    AND ETCI.ExportFileName IS NULL
    AND (ETCI.Uploaded=0 OR @IncludePosted=1)
    AND (ETCI.SalonID=@LocationID OR ISNULL(@LocationID, -1)&lt;0)
    --TEMP: REMOVE THIS UNTIL WE CAN FIND OUT ABOUT INTITUTION         AND I.InstitutionGlobalKey = @InstitutionGlobalKey
    
    AND (ETCI.UploadedDateTime IS NULL OR (@IncludePosted=1 AND (ETCI.UploadedDateTime&gt;=@StartDateTime OR @StartDateTime IS NULL)))
    --Dropping the start/end date and time so we can get all records belonging to the chosen EIDs
    --AND (ETCI.StartDateTime &gt;= @StartDateTime OR @StartDateTime IS NULL)
    --AND (ETCI.EndDateTime &lt;= CONVERT(DATETIME, .99 + FLOOR( CONVERT(FLOAT, @EndDateTime) ) ) OR @EndDateTime IS NULL)
    
    AND (ETCI.EmployeeJobID=@EventID OR @EventID IS NULL)
    AND (ETCI.EmployeeID_Instructor=@InstructorID OR @InstructorID IS NULL)
    AND (E.EmployeeID=@PersonID OR @PersonID IS NULL)
    --Leaving this criteria in because it is not part of the date range filter above, its only to remove cancels
    
    AND ETCI.EndDateTime&gt;CONVERT(DATETIME, .101 + FLOOR(CONVERT(FLOAT, ETCI.StartDateTime)))  --AT 09/21/2022 Filter Out Canceled
    
    AND ((EJETCI.TPR_Training_IsPublicRoad=1 AND E.ProficientRoad=1)  --AT 09/2022
         
          OR (EJETCI.TPR_Training_IsRange=1 AND E.ProficientRange=1)
          OR (EJETCI.TPR_Training_IsTheory=1 AND PI_Grading.IsFinalSubmit=1))--Hannah 11-20- AND PI_Grading.IsFinalSubmit=1
	AND (
		(EJETCI.TPR_Training_IsTheory=1 ) OR --AND dbo.EmployeeUploadedToTPR(ETCI.EmployeeID,0,0,1)=0 --hannah 2-17-2025 need to still include theory here, just not AND not uploaded
		(EJETCI.TPR_Training_IsPublicRoad=1 AND dbo.EmployeeUploadedToTPR(ETCI.EmployeeID,1,0,0)=0)
		OR (EJETCI.TPR_Training_IsRange=1 AND dbo.EmployeeUploadedToTPR(ETCI.EmployeeID,0,1,0)=0)
		OR (@IncludePosted=1 AND (ETCI.UploadedDateTime&gt;=@StartDateTime OR @StartDateTime IS NULL))
		)">SELECT ETCI.*,
     CASE
         WHEN E.Code IS NULL THEN CONVERT(VARCHAR, E.EmployeeID)
       ...</td><td class="metric-value">30,123</td><td class="metric-value">627.83</td><td>53</td><td>54,432</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_HammerDown</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,579</td><td class="metric-value">1,146.13</td><td>6</td><td>246,540</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,909</td><td class="metric-value">1,541.40</td><td>4</td><td>96,542</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,959</td><td class="metric-value">572.50</td><td>6</td><td>165,446</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,222</td><td class="metric-value">697.54</td><td>6</td><td>1,390</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,173</td><td class="metric-value">407.84</td><td>6</td><td>53,054</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">1,028</td><td class="metric-value">436.48</td><td>3</td><td>19,370</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">940</td><td class="metric-value">156.68</td><td>6</td><td>2,222</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">798</td><td class="metric-value">173.82</td><td>6</td><td>40,003</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">756</td><td class="metric-value">126.77</td><td>6</td><td>651</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_HammerDown</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">718</td><td class="metric-value">368.80</td><td>2</td><td>131,133</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_Lonestar</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,292</td><td class="metric-value">2,772.61</td><td>6</td><td>225,845</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,946</td><td class="metric-value">1,512.65</td><td>4</td><td>96,543</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,857</td><td class="metric-value">760.21</td><td>6</td><td>167,443</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,254</td><td class="metric-value">1,029.30</td><td>6</td><td>1,401</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">1,438</td><td class="metric-value">402.99</td><td>4</td><td>53,217</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">1,018</td><td class="metric-value">430.55</td><td>3</td><td>15,551</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">802</td><td class="metric-value">242.75</td><td>6</td><td>40,175</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">717</td><td class="metric-value">359.54</td><td>2</td><td>131,632</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">622</td><td class="metric-value">155.54</td><td>4</td><td>2,218</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_Lonestar</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">503</td><td class="metric-value">125.78</td><td>4</td><td>651</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_Mellevet</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,386</td><td class="metric-value">1,965.77</td><td>6</td><td>235,882</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,888</td><td class="metric-value">1,473.80</td><td>4</td><td>97,293</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,879</td><td class="metric-value">739.25</td><td>6</td><td>165,766</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,278</td><td class="metric-value">892.11</td><td>6</td><td>1,385</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,138</td><td class="metric-value">462.79</td><td>6</td><td>52,869</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">1,053</td><td class="metric-value">448.38</td><td>3</td><td>20,877</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">940</td><td class="metric-value">185.26</td><td>6</td><td>2,229</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">833</td><td class="metric-value">273.08</td><td>6</td><td>42,807</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">755</td><td class="metric-value">146.68</td><td>6</td><td>653</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_Mellevet</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">702</td><td class="metric-value">352.03</td><td>2</td><td>131,378</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_Moov</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,199</td><td class="metric-value">1,076.77</td><td>6</td><td>228,081</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,960</td><td class="metric-value">1,531.20</td><td>4</td><td>100,635</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,791</td><td class="metric-value">544.63</td><td>6</td><td>165,758</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,253</td><td class="metric-value">701.17</td><td>6</td><td>1,393</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,145</td><td class="metric-value">400.57</td><td>6</td><td>52,865</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">1,005</td><td class="metric-value">430.43</td><td>3</td><td>16,600</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">936</td><td class="metric-value">156.33</td><td>6</td><td>2,220</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">792</td><td class="metric-value">173.52</td><td>6</td><td>40,208</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">750</td><td class="metric-value">125.12</td><td>6</td><td>651</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_Moov</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">695</td><td class="metric-value">350.31</td><td>2</td><td>132,212</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_MoovDS</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_MoovDS</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">53</td><td class="metric-value">365.95</td><td>1</td><td>1,551</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_MoovDS</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS                             	JOIN sys.plan_persist_runtime_stats_interval I                  	ON WS.runtime_stats_interval_id = I.runtime_stats_interval_id   	WHERE I.end_time &lt; @threshold_time">DELETE TOP(@top_count) WS                                       	FROM sys.plan_persist_wait_stats WS...</td><td class="metric-value">4</td><td class="metric-value">2.06</td><td>4</td><td>20</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_MoovDS</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [TruckTrack_MoovDS].[sys].[filetable_updates_1890574269] with (readpast) order by table_id">select table_id, item_guid, oplsn_fseqno, oplsn_bOffset, oplsn_slotid
 from [TruckTrack_MoovDS].[sys...</td><td class="metric-value">0</td><td class="metric-value">0.07</td><td>1</td><td>0</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_Multipurpose</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,228</td><td class="metric-value">1,902.70</td><td>6</td><td>224,842</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,910</td><td class="metric-value">1,489.31</td><td>4</td><td>96,215</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,817</td><td class="metric-value">593.98</td><td>6</td><td>165,728</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,195</td><td class="metric-value">852.63</td><td>6</td><td>1,378</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,185</td><td class="metric-value">467.50</td><td>6</td><td>52,796</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">997</td><td class="metric-value">425.45</td><td>3</td><td>15,931</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">947</td><td class="metric-value">184.20</td><td>6</td><td>2,221</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">805</td><td class="metric-value">181.27</td><td>6</td><td>40,193</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">755</td><td class="metric-value">146.87</td><td>6</td><td>649</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_Multipurpose</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">715</td><td class="metric-value">360.03</td><td>2</td><td>131,340</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_Panda</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,311</td><td class="metric-value">2,748.20</td><td>6</td><td>231,772</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,950</td><td class="metric-value">1,502.31</td><td>4</td><td>96,265</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,800</td><td class="metric-value">762.69</td><td>6</td><td>165,915</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,275</td><td class="metric-value">1,016.97</td><td>6</td><td>1,390</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,221</td><td class="metric-value">542.88</td><td>6</td><td>52,873</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">997</td><td class="metric-value">431.05</td><td>3</td><td>15,967</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">936</td><td class="metric-value">207.50</td><td>6</td><td>2,225</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">779</td><td class="metric-value">258.45</td><td>6</td><td>40,203</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">763</td><td class="metric-value">166.81</td><td>6</td><td>652</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_Panda</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">711</td><td class="metric-value">357.83</td><td>2</td><td>131,782</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_RightLane</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT AT.AccountTransactionID,  
       WTT.WalletTokenTypeID AS WalletTokenTypeID,  
       WT.Name AS WalletTokenName,  
       AT.Amount,  
       AP.PersonID, 
       @TicketSalonID AS SalonID,  
       AT.POSProductGlobalKey AS ProductGlobalKey,  
       AT.CommittedDateTime AS TransactionDate,  
       1 AS TerminalID,  
       AT.InProcessDateTime,  
       AT.ProcessedDateTime,  
       AT.POSTransactionID,
	   AT.WalletTokenTypeID_AdminTransaction,
	   AT.EmployeeID
INTO #tmpTrans  
FROM AccountTransaction AS AT  --this is the part from ECommerce_UpdateSyncPOSQueue on svdb_ahec  
  
LEFT OUTER JOIN AccountTransaction AS ATPay  
          ON AT.AccountTransactionID_Payment=ATPay.AccountTransactionID  
INNER JOIN AccountPerson AS AP  
          ON AP.AccountID=AT.AccountID  
INNER JOIN AccountTransactionType AS ATT  
          ON ATT.AccountTransactionTypeID=AT.AccountTransactionTypeID  
INNER JOIN Wallet AS W  
          ON W.PersonID=AP.PersonID --***  
LEFT OUTER JOIN WalletToken AS WT  
          ON WT.WalletTokenID=ATPay.WalletTokenID  
LEFT OUTER JOIN WalletTokenType AS WTT  
          ON WTT.WalletTokenTypeID=WT.WalletTokenTypeID  
LEFT OUTER JOIN Institution AS I  
          ON I.InstitutionID=W.InstitutionID  
WHERE (ATT.AccountTransactionTypeID=@AccountTransactionTypeID_AdminTransaction 
			OR Att.AccountTransactionTypeID=@AccountTransactionTypeID_ProductSale 
			OR Att.AccountTransactionTypeID=@AccountTransactionTypeID_Refund )
      AND AT.CommittedDateTime IS NOT NULL  
      AND (AT.InProcessDateTime IS NULL OR AT.InProcessDateTime&lt;DATEADD(hh, -1, GETDATE())) 
      AND AT.ProcessedDateTime IS NULL  
      AND AT.POSTransactionID IS NULL">SELECT AT.AccountTransactionID,  
       WTT.WalletTokenTypeID AS WalletTokenTypeID,  
       WT.N...</td><td class="metric-value">913</td><td class="metric-value">18.54</td><td>93</td><td>1,334</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT top 1 @GuestID = GuestID  
    FROM Guest WHERE EmployeeID=@PersonID">SELECT top 1 @GuestID = GuestID  
    FROM Guest WHERE EmployeeID=@PersonID</td><td class="metric-value">617</td><td class="metric-value">0.08</td><td>15,810</td><td>6</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="FETCH NEXT FROM cTrans INTO @AccountTransactionID,  
     @WalletTokenTypeID,  
     @WalletTokenName,  
     @ItemPrice,  
     @PersonID,  
     @SalonID,  
     @ProductGlobalKey,  
     @TransactionDate,  
     @TerminalID,  
     @InProcessDateTime,
	 @WalletTokenTypeID_AdminTransaction,
	 @EmployeeID;  

 ">FETCH NEXT FROM cTrans INTO @AccountTransactionID,  
     @WalletTokenTypeID,  
     @WalletTokenN...</td><td class="metric-value">398</td><td class="metric-value">0.05</td><td>15,810</td><td>5</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT @ItemCode = HandCode_Default
    FROM Product  
    WHERE ProductGlobalKey=@ProductGlobalKey">SELECT @ItemCode = HandCode_Default
    FROM Product  
    WHERE ProductGlobalKey=@ProductGlobalKe...</td><td class="metric-value">273</td><td class="metric-value">0.03</td><td>15,810</td><td>1</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SET @TicketPaymentItemTypeID_FromTokenType = (SELECT TicketPaymentItemTypeID from WalletTokenType WHERE WalletTokenTypeID = @WalletTokenTypeID_AdminTransaction)">SET @TicketPaymentItemTypeID_FromTokenType = (SELECT TicketPaymentItemTypeID from WalletTokenType WH...</td><td class="metric-value">134</td><td class="metric-value">0.02</td><td>15,810</td><td>0</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="UPDATE AccountTransaction SET InProcessDateTime = @InProcessDateTime  
WHERE AccountTransactionID IN(SELECT AccountTransactionID  
                              FROM #tmpTrans  
                              WHERE AccountTransactionID IS NOT NULL)  
      AND InProcessDateTime IS NULL  
      AND ProcessedDateTime IS NULL">UPDATE AccountTransaction SET InProcessDateTime = @InProcessDateTime  
WHERE AccountTransactionID I...</td><td class="metric-value">120</td><td class="metric-value">2.68</td><td>93</td><td>26</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SET @TicketPaymentItemTypeID_FromTokenType = (SELECT TicketPaymentItemTypeID from WalletTokenType WHERE WalletTokenTypeID=@WalletTokenTypeID)">SET @TicketPaymentItemTypeID_FromTokenType = (SELECT TicketPaymentItemTypeID from WalletTokenType WH...</td><td class="metric-value">100</td><td class="metric-value">0.01</td><td>15,810</td><td>0</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @threshold_time">DELETE TOP (@top_count) sys.plan_persist_runtime_stats          	WHERE last_execution_time &lt; @thr...</td><td class="metric-value">83</td><td class="metric-value">426.02</td><td>1</td><td>2,917</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT DISTINCT
       I.StudentID,
       I.FirstName,
       I.LastName,
       I.EmailAddress,
       I.PhoneNumber_Mobile,
       I.MobileCarrierID,
       I.StudentTypeID,
       I.IsActive,
       I.UserName,
       I.PasswordText,
       I.EnteredDate,
       I.EditedDate,
       I.EditVersion,
       I.RecordID_Source,
       I.LocationID_Source,
       I.Source,
       I.Code,
       I.DisplayName,
       I.PreferredFirstName,
       I.Salutation,
       I.LocationID_Default
FROM Student AS I
LEFT OUTER JOIN Student_Location AS IL
          ON IL.StudentID=I.StudentID
WHERE (@LocationID=LocationID
        OR @LocationID&lt;0
        OR @LocationID IS NULL)
ORDER BY DisplayName, LastName, FirstName">SELECT DISTINCT
       I.StudentID,
       I.FirstName,
       I.LastName,
       I.EmailAddress...</td><td class="metric-value">44</td><td class="metric-value">1.67</td><td>27</td><td>439</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_RightLane</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="Set @AccountTransactionTypeID_ProductSale = (Select AccountTransactionTypeID from AccountTransactionType where Name='ProductSale')">Set @AccountTransactionTypeID_ProductSale = (Select AccountTransactionTypeID from AccountTransaction...</td><td class="metric-value">23</td><td class="metric-value">0.35</td><td>93</td><td>31</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_RJDevereaux</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">5,923</td><td class="metric-value">1,769.15</td><td>6</td><td>97,173</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,287</td><td class="metric-value">1,937.40</td><td>6</td><td>225,208</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,873</td><td class="metric-value">757.50</td><td>6</td><td>165,634</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,220</td><td class="metric-value">853.92</td><td>6</td><td>1,394</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,185</td><td class="metric-value">477.12</td><td>6</td><td>52,783</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,005</td><td class="metric-value">506.94</td><td>6</td><td>18,539</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">953</td><td class="metric-value">185.27</td><td>6</td><td>2,227</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">833</td><td class="metric-value">292.68</td><td>6</td><td>39,665</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">762</td><td class="metric-value">147.20</td><td>6</td><td>653</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_RJDevereaux</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">727</td><td class="metric-value">365.86</td><td>2</td><td>131,210</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_SBL</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,415</td><td class="metric-value">1,933.38</td><td>6</td><td>237,387</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,869</td><td class="metric-value">1,498.16</td><td>4</td><td>141,576</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">3,650</td><td class="metric-value">1,825.84</td><td>2</td><td>2,097,005</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,821</td><td class="metric-value">595.29</td><td>6</td><td>165,701</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,281</td><td class="metric-value">867.12</td><td>6</td><td>1,389</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,190</td><td class="metric-value">468.04</td><td>6</td><td>52,821</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,053</td><td class="metric-value">518.62</td><td>6</td><td>18,305</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">965</td><td class="metric-value">186.53</td><td>6</td><td>2,213</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">774</td><td class="metric-value">174.88</td><td>6</td><td>40,181</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_SBL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">755</td><td class="metric-value">146.38</td><td>6</td><td>647</td></tr><tr class="db-group-header"><td colspan="7" style="padding: 8px 10px;">?? Database: TruckTrack_UniqueSL</td></tr><tr><td>1</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_id, N'IsReplProc')&lt;&gt;0 OR so.type = 'P' THEN 1 ELSE 0 END) AS number, 
CAST(CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END AS bit)  AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms175081.aspx 
CONVERT(bit, CASE WHEN so.type = 'D' AND so.parent_object_id != 0 THEN 1 ELSE 0 END) AS IsDefault,
ISNULL(sm.uses_quoted_identifier, 0) AS QuotedIdentifier,
NULL AS ctext
FROM sys.sql_modules sm WITH (NOLOCK)
LEFT JOIN sys.objects so WITH (NOLOCK) ON so.object_id = sm.object_id
WHERE (so.type in ('P', 'V', 'TR', 'TA', 'IF', 'FN', 'TF', 'FS', 'FT')
OR (so.type = 'D' AND so.parent_object_id != 0)
OR sm.object_id IN (SELECT object_id FROM sys.triggers WITH (NOLOCK) WHERE parent_class=0))
UNION ALL
SELECT d.object_id AS id,
d.definition AS text,
parent_column_id AS colid,
0 AS number, 
CAST(0 AS BIT) AS Encrypted, -- Not encryptable https://msdn.microsoft.com/en-us/library/ms173758.aspx
CAST(1 AS BIT) AS IsDefault,
CAST(0 AS BIT) AS QuotedIdentifier,
NULL AS ctext
FROM sys.default_constraints d WITH (NOLOCK)
UNION ALL
SELECT
p.object_id AS id,
p.definition AS text, 
CAST(1 as int) AS colid, 
procedure_number AS number, 
CAST(CASE WHEN p.definition IS NULL THEN 1 ELSE 0 END AS bit) AS Encrypted, -- https://msdn.microsoft.com/en-us/library/ms179865.aspx
CAST(0 as bit) AS IsDefault,
m.uses_quoted_identifier AS QuotedIdentifier,
NULL AS ctext
FROM sys.numbered_procedures p WITH (NOLOCK)
LEFT JOIN sys.sql_modules m WITH (NOLOCK) ON p.object_id = m.object_id

ORDER BY id, colid, number">SELECT sm.object_id AS id,
definition AS text,
1 AS colid, 
(CASE WHEN OBJECTPROPERTY(so.object_i...</td><td class="metric-value">5,320</td><td class="metric-value">1,934.11</td><td>6</td><td>231,296</td></tr><tr><td>2</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS ColumnName,
c.column_id AS ColumnID,
c.precision AS [Precision],
types.name AS TypeName,
basetypes.name AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN c.max_length&gt;=0 AND basetypes.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
CONVERT(bit, c.is_identity) AS [Identity],
CONVERT(bit, c.is_computed) AS [IsComputed],
CONVERT(bit, ISNULL(ic.is_not_for_replication,0)) AS NotForReplication,
CAST(ISNULL(ic.seed_value,0) AS DECIMAL(38)) AS IdentitySeed,
CAST(ISNULL(ic.last_value,0) AS DECIMAL(38)) AS IdentityCurrent,
ISNULL(ic.increment_value,0) AS IdentityIncrement,
CONVERT(bit, c.is_nullable) AS AllowNulls,
c.default_object_id AS DefaultTextID,
ds.name AS DefaultName,
c.default_object_id AS defaultid,
dsc.name AS DefaultSchemaName,
CONVERT(bit, CASE ds.parent_object_id WHEN 0 THEN 1 ELSE 0 END) AS IsBoundDefault,
CONVERT(bit, CASE dc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
rs.name AS RuleName,
rsc.name AS RuleSchemaName,
CONVERT(bit, CASE WHEN fi.language_id IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
                cc.definition AS ComputedText,
c.is_rowguidcol AS IsRowGuidCol,
c.collation_name AS Collation,
fi.language_id AS FullTextLanguage,
fisc.name AS FullTextTypeColumn,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
t.type AS type,
mc.masking_function AS MaskingFunction,
CONVERT(bit, ISNULL(cc.is_persisted, 0)) AS [IsPersisted],
CONVERT(bit, c.is_filestream) AS [Filestream],
CONVERT(bit, c.is_sparse) AS [Sparse],
CONVERT(bit, c.is_column_set) AS [ColumnSet],
c.generated_always_type AS GeneratedAlwaysType,
CONVERT(bit, c.is_hidden) AS IsHidden
FROM sys.columns c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.default_constraints dc ON c.default_object_id = dc.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.identity_columns ic WITH (NOLOCK) ON ic.object_id=c.object_id AND ic.column_id=c.column_id
LEFT JOIN sys.objects ds WITH (NOLOCK) ON ds.object_id=c.default_object_id
LEFT JOIN sys.objects rs WITH (NOLOCK) ON rs.object_id=c.rule_object_id
LEFT JOIN sys.fulltext_index_columns fi WITH (NOLOCK) ON fi.object_id=c.object_id AND fi.column_id=c.column_id
LEFT JOIN sys.columns fisc WITH (NOLOCK) ON fi.type_column_id = fisc.column_id AND fisc.object_id=c.object_id
LEFT JOIN sys.computed_columns cc WITH (NOLOCK) ON cc.object_id=c.object_id AND cc.column_id=c.column_id
LEFT JOIN sys.schemas dsc WITH (NOLOCK) ON dsc.schema_id=ds.schema_id
LEFT JOIN sys.schemas rsc WITH (NOLOCK) ON rsc.schema_id=rs.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id
LEFT JOIN sys.masked_columns mc WITH (NOLOCK) ON mc.object_id=c.object_id AND mc.column_id=c.column_id
WHERE t.type IN ('U', 'FT', 'TF', 'IF', 'TT')AND sc.name IS NOT NULL
ORDER BY c.object_id, c.column_id">SELECT t.name AS TableName,
t.object_id AS ParentObjectId,
sc.name AS SchemaName,
c.name AS Colum...</td><td class="metric-value">3,834</td><td class="metric-value">1,503.87</td><td>4</td><td>139,289</td></tr><tr><td>3</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS id,
CONVERT(bit, ISNULL(sm.is_schema_bound,0)) AS SchemaBound,
CONVERT(bit, ISNULL(sm.uses_ansi_nulls, 0)) AS AnsiNulls,
CONVERT(bit, ISNULL(sm.uses_quoted_identifier,0)) AS QuotedIdentifier,
CONVERT(bit, ISNULL(sm.uses_native_compilation,0)) AS NativelyCompiled,
s.type AS ProcedureType,
s.modify_date AS LastModified,
am.assembly_class,
am.assembly_method,
CASE WHEN am.null_on_null_input IS NULL THEN sm.null_on_null_input ELSE am.null_on_null_input END AS null_on_null_input,
COALESCE(p2.name,p3.name) AS execute_as,
CONVERT(bit, COALESCE(
	CASE WHEN am.execute_as_principal_id = -2 THEN 1 ELSE 0 END,
	CASE WHEN sm.execute_as_principal_id = -2 THEN 1 ELSE 0 END)) AS execute_as_owner,
a.name AS assembly,
case when sm.definition is null THEN CONVERT(bit, 1) else CONVERT(bit, 0) END AS encrypted

FROM sys.objects s WITH (NOLOCK)
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.schemas ss WITH (NOLOCK) ON ss.schema_id=s.schema_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
LEFT JOIN sys.assembly_modules am WITH (NOLOCK) ON am.object_id=s.object_id
LEFT JOIN sys.assemblies a WITH (NOLOCK) ON a.assembly_id=am.assembly_id
LEFT JOIN sys.database_principals p2 WITH (NOLOCK) ON p2.principal_id=am.execute_as_principal_id
LEFT JOIN sys.database_principals p3 WITH (NOLOCK) ON p3.principal_id=sm.execute_as_principal_id
WHERE s.type IN (N'P', N'PC')AND 
(CAST(CASE  WHEN s.is_ms_shipped = 1 then 1
            WHEN (SELECT major_id FROM sys.extended_properties WHERE 
                  major_id = s.object_id AND minor_id = 0 AND class = 1 AND 
                  name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
            ELSE 0
END AS bit)=0)
ORDER BY s.object_id">SELECT s.name AS ProcedureName, 
p.name AS ProcedureOwner,
ss.name AS SchemaName,
s.object_id AS ...</td><td class="metric-value">2,771</td><td class="metric-value">709.71</td><td>6</td><td>165,738</td></tr><tr><td>4</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS ParameterID, 
c.precision AS Precision,
types.name AS TypeName,
case when c.system_type_id = 243 then N'tabletype' else 
basetypes.name end  AS BaseTypeName,
st.name AS TypeSchemaName,
CASE WHEN types.name IN (N'nchar', N'nvarchar') THEN c.max_length/2 ELSE c.max_length END AS Length,
c.scale AS Scale,
c.is_xml_document AS XMLDocument,
xscs.name AS XMLCollection,
xsc.name AS XMLCollectionSchemaName,
is_output,
is_cursor_ref,
has_default_value,
default_value,
t.type AS ObjectType
FROM sys.parameters c INNER JOIN sys.objects t WITH (NOLOCK) ON c.object_id=t.object_id
LEFT JOIN sys.schemas sc WITH (NOLOCK) ON t.schema_id=sc.schema_id
LEFT JOIN sys.types basetypes WITH (NOLOCK) ON c.system_type_id=basetypes.system_type_id AND basetypes.system_type_id=basetypes.user_type_id
LEFT JOIN sys.types types WITH (NOLOCK) ON c.user_type_id=types.user_type_id
LEFT JOIN sys.schemas st WITH (NOLOCK) ON st.schema_id=types.schema_id
LEFT JOIN sys.xml_schema_collections xscs WITH (NOLOCK) ON xscs.xml_collection_id=c.xml_collection_id
LEFT JOIN sys.schemas xsc WITH (NOLOCK) ON xsc.schema_id=xscs.schema_id

WHERE t.type IN (N'FT', N'TF', N'FS', N'FN', N'AF', N'PC', N'P', N'IF')
ORDER BY c.object_id, c.parameter_id">SELECT t.name AS ObjectName, 
sc.name AS SchemaName, 
c.name AS ParameterName, 
c.parameter_id AS...</td><td class="metric-value">2,304</td><td class="metric-value">889.42</td><td>6</td><td>1,399</td></tr><tr><td>5</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
ftc.name AS FullTextCatalogName,
CONVERT (bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
ds.name AS FileGroup,
dsx.name AS TextFileGroup,
fs.name AS FilestreamFileGroup,
ds.type AS dataspacetype,
ps.data_compression AS data_compression,
ps.partition_number AS data_compression_partition_number,
CONVERT(bit, CASE WHEN ct.is_track_columns_updated_on IS NULL THEN 0 ELSE 1 END) AS TableChangeTrackingEnabled,
ct.is_track_columns_updated_on AS TableChangeTrackingTracksColumns,
o.is_filetable AS IsFiletable,
ft.directory_name AS DirectoryName,
ft.filename_collation_name AS FilenameCollationName,
o.is_memory_optimized AS MemoryOptimized,
o.durability AS Durability,
o.modify_date AS LastModified,
o.is_remote_data_archive_enabled AS IsRemoteDataArchiveEnabled,
rt.is_migration_paused AS IsRemoteDataArchivePaused,
o.temporal_type AS TemporalType,
os2.name AS HistoryTableSchema,
o2.name AS HistoryTableName
FROM
sys.tables o WITH (NOLOCK)
LEFT JOIN sys.tables o2 with (NOLOCK) ON o2.object_id=o.history_table_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.schemas os2 WITH (NOLOCK) ON os2.schema_id=o2.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=o.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=o.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.indexes ix WITH (NOLOCK) ON ix.object_id=o.object_id
LEFT JOIN sys.data_spaces ds WITH (NOLOCK) ON ds.data_space_id=ix.data_space_id
LEFT JOIN sys.data_spaces dsx WITH (NOLOCK) ON dsx.data_space_id=o.lob_data_space_id
LEFT JOIN sys.data_spaces fs WITH (NOLOCK) ON fs.data_space_id=o.filestream_data_space_id
LEFT JOIN sys.partitions ps WITH (NOLOCK) ON ps.object_id=o.object_id AND ps.index_id &lt;=1
LEFT JOIN sys.change_tracking_tables ct WITH (NOLOCK) ON ct.object_id = o.object_id
LEFT JOIN sys.filetables ft WITH (NOLOCK) ON ft.object_id = o.object_id
LEFT JOIN sys.remote_data_archive_tables rt WITH (NOLOCK) ON rt.object_id = o.object_id

WHERE ((o.is_memory_optimized = 0 AND ix.index_id&lt;2) OR (o.is_memory_optimized = 1 AND ix.index_id = 2))
AND (CAST(CASE WHEN o.is_ms_shipped = 1 THEN 1
WHEN (SELECT major_id FROM sys.extended_properties
WHERE major_id = o.object_id AND minor_id = 0 AND class = 1 AND
name = N'microsoft_database_tools_support') IS NOT NULL THEN 1
ELSE 0
END AS bit)=0)
ORDER BY os.name, o.name, ps.partition_number">SELECT
o.name,
os.name AS schemaname,
o.object_id AS id,
o.lock_escalation,
p.name AS owner,
f...</td><td class="metric-value">2,183</td><td class="metric-value">474.06</td><td>6</td><td>52,945</td></tr><tr><td>6</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.object_id 
	  FROM sys.objects o
	  WHERE o.schema_id = 1 AND o.name = e.referenced_entity_name)
END AS referenced_id,
referenced_class,
referenced_server_name,
referenced_database_name,
referenced_schema_name,
referenced_entity_name,
is_schema_bound_reference
FROM sys.sql_expression_dependencies e
WHERE referencing_class = 1
ORDER BY referencing_id">SELECT
referencing_id,
CASE WHEN is_caller_dependent = 0 THEN referenced_id 
ELSE (SELECT o.objec...</td><td class="metric-value">2,168</td><td class="metric-value">550.64</td><td>6</td><td>22,044</td></tr><tr><td>7</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.remote_data_archive_tables WHERE filter_predicate IS NOT NULL) AS filtered_remote_data_archive_tables
, (SELECT COUNT(*) FROM sys.tables WHERE is_memory_optimized = '1') AS memory_optimized_tables
, (SELECT COUNT(*) FROM sys.tables WHERE temporal_type = '2') AS temporal_tables
, (SELECT COUNT(*) FROM sys.column_master_keys) AS column_master_keys
, (SELECT COUNT(*) FROM sys.column_encryption_keys) AS column_encryption_keys
, (SELECT COUNT(*) FROM sys.objects AS so LEFT JOIN sys.sql_modules AS sm ON so.object_id = sm.object_id
    WHERE type='FN' AND uses_native_compilation=1) AS natively_compiled_udfs
, (SELECT COUNT(*) from sys.columns WHERE encryption_type IS NOT NULL) AS always_encrypted_columns">SELECT
  (SELECT COUNT(*) FROM sys.remote_data_archive_tables) AS remote_data_archive_tables
, (SE...</td><td class="metric-value">947</td><td class="metric-value">187.04</td><td>6</td><td>2,217</td></tr><tr><td>8</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc.name AS FullTextCatalogName,
s.modify_date as LastModified,
CONVERT(bit, CASE WHEN ftc.name IS NULL THEN 0 ELSE 1 END) AS FullTextIndexed,
fti.change_tracking_state AS FullTextChangeTracking,
fti.stoplist_id AS FullTextStoplistId,
fts.name AS FullTextStoplistName,
sm.uses_quoted_identifier AS QuotedIdentifier,
CAST(ISNULL(OBJECTPROPERTY(s.object_id,N'ExecIsAnsiNullsOn'),0) AS bit) AS AnsiNulls,
ISNULL(sm.is_schema_bound, 0) AS SchemaBound,
CONVERT(bit, CASE WHEN sm.definition IS NULL THEN 1 ELSE 0 END) AS encrypted
FROM sys.objects s WITH (NOLOCK) 
LEFT JOIN sys.schemas sch WITH (NOLOCK)  ON sch.schema_id=s.schema_id
LEFT JOIN sys.database_principals p WITH (NOLOCK) ON p.principal_id=s.principal_id
LEFT JOIN sys.fulltext_indexes fti WITH (NOLOCK) ON fti.object_id=s.object_id
LEFT JOIN sys.fulltext_catalogs ftc WITH (NOLOCK) ON ftc.fulltext_catalog_id=fti.fulltext_catalog_id
LEFT JOIN sys.fulltext_stoplists fts WITH (NOLOCK) ON fts.stoplist_id=fti.stoplist_id
LEFT JOIN sys.sql_modules sm WITH (NOLOCK) ON sm.object_id=s.object_id
WHERE s.type = 'V'
AND s.is_ms_shipped = 0
ORDER BY s.name">SELECT s.name AS ViewName, 
s.object_id as id,
sch.name AS ViewSchema,
p.name AS ViewOwner,
ftc....</td><td class="metric-value">802</td><td class="metric-value">261.38</td><td>6</td><td>40,217</td></tr><tr><td>9</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.name AS SecurityPolicyName ,
        p.name AS SecurityPolicyOwner ,
        sp.is_enabled AS State ,
        sp.is_not_for_replication AS NotForReplication ,
        st.name AS SecurityPredicateTableOrViewSchema ,
        o.name AS SecurityPredicateTableOrViewName ,
        spr.predicate_definition AS SecurityPredicateFunctionDefinition
FROM    sys.security_policies sp
        LEFT JOIN sys.security_predicates spr ON spr.object_id = sp.object_id
        LEFT JOIN sys.database_principals p ON p.principal_id = sp.principal_id
        LEFT JOIN sys.objects o ON spr.target_object_id = o.object_id
        LEFT JOIN sys.schemas st ON st.schema_id = o.schema_id
        LEFT JOIN sys.schemas ssp ON ssp.schema_id = sp.schema_id">SELECT  sp.object_id AS SecurityPolicyId ,
        ssp.name AS SecurityPolicySchema ,
        sp.n...</td><td class="metric-value">771</td><td class="metric-value">149.61</td><td>6</td><td>650</td></tr><tr><td>10</td><td style="font-weight: bold;">TruckTrack_UniqueSL</td><td style="font-family: monospace; font-size: 11px; max-width: 400px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;" title="SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(bit, CASE i.type WHEN 3 THEN 1 ELSE 0 END) AS Xml,
CONVERT(bit, CASE i.type WHEN 5 THEN 1 WHEN 6 THEN 1 ELSE 0 END) AS Columnstore,
CONVERT(bit, CASE i.type WHEN 7 THEN 1 ELSE 0 END) AS Hash,
i.is_unique AS [Unique],
ic.is_included_column AS [Included],
i.is_unique_constraint AS UniqueConstraint,
i.is_primary_key AS [Primary],
i.ignore_dup_key AS IgnoreDupKey,
i.is_padded AS IsPadIndex,
CONVERT(bit, CASE WHEN o.type='U' THEN 1 ELSE 0 END) AS IsTable,
CONVERT(bit, CASE WHEN o.type='V' THEN 1 ELSE 0 END) AS IsView,
CONVERT(bit, CASE WHEN fi.object_id IS NOT NULL THEN 1 ELSE 0 END) AS FullTextKey,
fg.name AS FileGroup,
o.name AS ParentName,
os.name AS SchemaName,
i.name AS IndexName,
i.fill_factor AS [FillFactor],
c.name AS ColumnName,
ic.is_descending_key AS Descending,
CONVERT (bit, 0) AS [Statistics],
CASE WHEN i.type IN (3, 4) THEN i.no_recompute ELSE s.no_recompute END AS NoRecompute,
CASE WHEN i.type IN (3, 4) THEN i.is_incremental ELSE s.is_incremental END AS IsIncremental,
i.data_space_id,
fg.type AS dataspacetype,
i.index_id AS indexid,
x.using_xml_index_id AS [UsingIndex],
xi.name AS [UsingIndexName],
x.secondary_type AS [SecondaryXmlType],
ic.key_ordinal AS key_ordinal,
ic.partition_ordinal,
i.allow_row_locks,
i.allow_page_locks,
i.is_disabled,
i.filter_definition,
si.spatial_index_type,
si.tessellation_scheme,
sit.bounding_box_xmin,
sit.bounding_box_ymin,
sit.bounding_box_xmax,
sit.bounding_box_ymax,
sit.level_1_grid,
sit.level_2_grid,
sit.level_3_grid,
sit.level_4_grid,
sit.cells_per_object,
CONVERT(bit, CASE kc.is_system_named WHEN 1 THEN 1 ELSE 0 END) As is_system_named,
kc.object_id AS ObjectID,
i.object_id AS ParentObjectId,
fi.property_list_id,
x.xml_index_type,
sxip.name AS primary_index_path_name,
hi.bucket_count AS BucketCount

INTO #RG_TMP_indexes

FROM (SELECT * ,
    (SELECT nrp.no_recompute from sys.objects nro 
        JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
        WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS no_recompute,
    (SELECT nrp.is_incremental from sys.objects nro 
			JOIN sys.stats nrp ON nro.object_id = nrp.object_id 
			WHERE nro.parent_object_id = i.object_id AND nrp.name = i.NAME AND i.type IN (3, 4) ) AS is_incremental 
    FROM sys.indexes i WITH (NOLOCK))i 
LEFT JOIN sys.key_constraints kc WITH (NOLOCK) ON kc.parent_object_id = i.object_id AND kc.unique_index_id = i.index_id
LEFT JOIN sys.data_spaces fg WITH (NOLOCK) ON fg.data_space_id=i.data_space_id
LEFT JOIN sys.objects o WITH (NOLOCK) ON o.object_id=i.object_id
LEFT JOIN sys.schemas os WITH (NOLOCK) ON os.schema_id=o.schema_id
LEFT JOIN sys.index_columns ic WITH (NOLOCK) ON ic.object_id=i.object_id AND ic.index_id=i.index_id
LEFT JOIN sys.columns c WITH (NOLOCK) on c.object_id=ic.object_id AND c.column_id=ic.column_id
LEFT JOIN sys.stats s WITH (NOLOCK) on s.object_id=i.object_id AND s.name=i.name
LEFT JOIN sys.xml_indexes x WITH (NOLOCK) on i.object_id=x.object_id AND i.index_id=x.index_id
LEFT JOIN sys.xml_indexes xi WITH (NOLOCK) on i.object_id=xi.object_id AND x.using_xml_index_id = xi.index_id
LEFT JOIN sys.spatial_indexes AS si WITH (NOLOCK) ON i.object_id=si.object_id AND i.index_id=si.index_id
LEFT JOIN sys.spatial_index_tessellations AS sit WITH (NOLOCK) ON i.object_id = sit.object_id AND i.index_id = sit.index_id
LEFT JOIN sys.fulltext_indexes fi WITH (NOLOCK) on fi.object_id = i.object_id AND fi.unique_index_id = i.index_id
LEFT JOIN sys.hash_indexes hi WITH (NOLOCK) on hi.object_id = i.object_id AND hi.index_id = i.index_id
LEFT JOIN sys.selective_xml_index_paths sxip WITH (NOLOCK) on sxip.object_id = x.object_id AND sxip.path_id = x.path_id

WHERE 
o.type IN ('U', 'V', 'TF', 'TT')
AND i.is_hypothetical = 0
ORDER BY ParentObjectId, SecondaryXmlType, indexid, key_ordinal">SELECT 
CONVERT(bit, CASE i.type WHEN 1 THEN 1 WHEN 5 THEN 1 ELSE 0 END) AS [Clustered],
CONVERT(b...</td><td class="metric-value">744</td><td class="metric-value">373.07</td><td>2</td><td>131,581</td></tr></table></div><div class="section">
        <div class="section-header">Top 20 Missing Indexes</div>
        <table>
            <tr>
                <th>#</th>
                <th>Database</th>
                <th>Table</th>
                <th>Equality Columns</th>
                <th>Inequality Columns</th>
                <th>Included Columns</th>
                <th>Avg Impact</th>
                <th>User Seeks</th>
                <th>Impact Score</th>
            </tr><tr><td>1</td><td>SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px;">dbo.AccountTransaction</td><td style="font-family: monospace; font-size: 11px;">[AccountID], [AccountTransactionTypeID], [VoidedDateTime], [ArchivedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[CommittedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[Amount], [AccountAmount]</td><td class="metric-value">99.60%</td><td>319,680</td><td class="metric-value">65,327,152</td></tr><tr><td>2</td><td>SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px;">dbo.AccountTransaction</td><td style="font-family: monospace; font-size: 11px;">[AccountID], [VoidedDateTime], [ArchivedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[CommittedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[AccountTransactionTypeID], [Amount], [AccountAmount]</td><td class="metric-value">98.47%</td><td>319,680</td><td class="metric-value">64,585,991</td></tr><tr><td>3</td><td>SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px;">dbo.AccountTransaction</td><td style="font-family: monospace; font-size: 11px;">[AccountID], [AccountTransactionTypeID], [VoidedDateTime], [ArchivedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[CommittedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[Amount], [AccountAmount]</td><td class="metric-value">99.31%</td><td>174,851</td><td class="metric-value">22,389,268</td></tr><tr><td>4</td><td>SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px;">dbo.AccountTransaction</td><td style="font-family: monospace; font-size: 11px;">[AccountID], [VoidedDateTime], [ArchivedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[CommittedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[AccountTransactionTypeID], [Amount], [AccountAmount]</td><td class="metric-value">97.68%</td><td>174,851</td><td class="metric-value">22,021,787</td></tr><tr><td>5</td><td>SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px;">dbo.Ticket</td><td style="font-family: monospace; font-size: 11px;">[GuestID], [TicketStatusID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[SalonID], [EndDateTime]</td><td class="metric-value">28.76%</td><td>24,184</td><td class="metric-value">3,904,040</td></tr><tr><td>6</td><td>SVDB_Copiague</td><td style="font-family: monospace; font-size: 11px;">dbo.EmployeePeriodSchedule</td><td style="font-family: monospace; font-size: 11px;">[EmployeeID], [PeriodFrom], [PeriodTo], [DayPattern]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td class="metric-value">99.22%</td><td>65,181</td><td class="metric-value">3,219,902</td></tr><tr><td>7</td><td>SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px;">dbo.Ticket</td><td style="font-family: monospace; font-size: 11px;">[GuestID], [TicketStatusID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[NetProductAmount]</td><td class="metric-value">28.82%</td><td>21,750</td><td class="metric-value">3,177,742</td></tr><tr><td>8</td><td>SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px;">dbo.Ticket</td><td style="font-family: monospace; font-size: 11px;">[GuestID], [TicketStatusID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[NetServiceAmount]</td><td class="metric-value">28.82%</td><td>21,750</td><td class="metric-value">3,177,742</td></tr><tr><td>9</td><td>TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px;">dbo.Employee</td><td style="font-family: monospace; font-size: 11px;">[SalonID_Primary]</td><td style="font-family: monospace; font-size: 11px;">[HireDate]</td><td style="font-family: monospace; font-size: 11px;">[DisplayName], [Sponsor], [StudentGroupID]</td><td class="metric-value">19.62%</td><td>30,657</td><td class="metric-value">1,320,682</td></tr><tr><td>10</td><td>SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px;">dbo.TicketLineItem</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[EmployeeID]</td><td style="font-family: monospace; font-size: 11px;">[TicketID], [ServiceID], [EmployeeID_WaitingPool]</td><td class="metric-value">83.13%</td><td>649</td><td class="metric-value">613,434</td></tr><tr><td>11</td><td>SVDB_Wiley</td><td style="font-family: monospace; font-size: 11px;">dbo.TicketLineItem</td><td style="font-family: monospace; font-size: 11px;">[ServiceID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[TicketID], [EmployeeID], [EmployeeID_WaitingPool]</td><td class="metric-value">80.39%</td><td>649</td><td class="metric-value">593,215</td></tr><tr><td>12</td><td>TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px;">dbo.ProcedureInstanceStepComponent_Instructor</td><td style="font-family: monospace; font-size: 11px;">[StudentID]</td><td style="font-family: monospace; font-size: 11px;">[Grade], [EnteredDate]</td><td style="font-family: monospace; font-size: 11px;">[ProcedureInstanceStepComponentID], [InstructorID], [EmployeeJobID]</td><td class="metric-value">71.71%</td><td>113</td><td class="metric-value">397,791</td></tr><tr><td>13</td><td>TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px;">dbo.ProcedureInstanceStepComponent_Instructor</td><td style="font-family: monospace; font-size: 11px;">[InstructorID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[ProcedureInstanceStepComponentID], [Grade], [EnteredDate], [StudentID], [EmployeeJobID]</td><td class="metric-value">61.79%</td><td>113</td><td class="metric-value">369,885</td></tr><tr><td>14</td><td>TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px;">dbo.ProcedureInstanceStepComponent_Instructor</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[Grade], [EnteredDate]</td><td style="font-family: monospace; font-size: 11px;">[ProcedureInstanceStepComponentID], [InstructorID], [StudentID], [EmployeeJobID]</td><td class="metric-value">60.69%</td><td>113</td><td class="metric-value">336,660</td></tr><tr><td>15</td><td>TruckTrack_Fleet001</td><td style="font-family: monospace; font-size: 11px;">dbo.LoginToken</td><td style="font-family: monospace; font-size: 11px;">[Token], [VoidedDateTime]</td><td style="font-family: monospace; font-size: 11px;">[EffectiveDateTime], [ExpirationDateTime]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td class="metric-value">99.55%</td><td>3,582</td><td class="metric-value">304,836</td></tr><tr><td>16</td><td>SVDB_Hope</td><td style="font-family: monospace; font-size: 11px;">dbo.Ticket</td><td style="font-family: monospace; font-size: 11px;">[GuestID], [TicketStatusID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[SalonID], [EndDateTime]</td><td class="metric-value">25.05%</td><td>2,852</td><td class="metric-value">262,506</td></tr><tr><td>17</td><td>SVDB_Hope</td><td style="font-family: monospace; font-size: 11px;">dbo.Ticket</td><td style="font-family: monospace; font-size: 11px;">[GuestID], [TicketStatusID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[NetProductAmount]</td><td class="metric-value">24.65%</td><td>2,852</td><td class="metric-value">258,314</td></tr><tr><td>18</td><td>SVDB_Hope</td><td style="font-family: monospace; font-size: 11px;">dbo.Ticket</td><td style="font-family: monospace; font-size: 11px;">[GuestID], [TicketStatusID]</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[NetServiceAmount]</td><td class="metric-value">24.65%</td><td>2,852</td><td class="metric-value">258,314</td></tr><tr><td>19</td><td>SVDB_Windermere</td><td style="font-family: monospace; font-size: 11px;">dbo.SalonBusinessDayTerminal</td><td style="font-family: monospace; font-size: 11px;">[TerminalID]</td><td style="font-family: monospace; font-size: 11px;">[CloseDateTime]</td><td style="font-family: monospace; font-size: 11px;">[SalonBusinessDayID], [TotalSales_ToDate_Terminal]</td><td class="metric-value">37.56%</td><td>11,524</td><td class="metric-value">215,704</td></tr><tr><td>20</td><td>SVDB_Merced</td><td style="font-family: monospace; font-size: 11px;">dbo.Employee</td><td style="font-family: monospace; font-size: 11px;"><span class="null-value">-</span></td><td style="font-family: monospace; font-size: 11px;">[SSN]</td><td style="font-family: monospace; font-size: 11px;">[IsActive_Person]</td><td class="metric-value">17.17%</td><td>1,474</td><td class="metric-value">210,739</td></tr></table></div><div class="section">
    <div class="section-header">Database Sizes</div>
    <table>
        <tr>
            <th>Database</th>
            <th>State</th>
            <th>Recovery Model</th>
            <th>Data Size (MB)</th>
            <th>Log Size (MB)</th>
            <th>Total Size (MB)</th>
            <th>Log Reuse Wait</th>
        </tr><tr><td>LogDB</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">36,102</td><td class="metric-value">58</td><td class="metric-value">36,160</td><td style="font-size: 11px;">ACTIVE_TRANSACTION</td></tr><tr><td>SVDB_Merced</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">8,966</td><td class="metric-value">116</td><td class="metric-value">9,082</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_Windermere</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">6,024</td><td class="metric-value">51</td><td class="metric-value">6,075</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_WindermerePreImport07232025DONOTMOVE</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">6,024</td><td class="metric-value">51</td><td class="metric-value">6,075</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_AHEC_Conversion090825TEST</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">5,822</td><td class="metric-value">50</td><td class="metric-value">5,872</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TEST_SVDB_AHEC_20250903</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">5,822</td><td class="metric-value">50</td><td class="metric-value">5,872</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_AHEC_Conversion</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">5,822</td><td class="metric-value">50</td><td class="metric-value">5,872</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>SVDB_Hope</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">2,379</td><td class="metric-value">50</td><td class="metric-value">2,429</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_Hope_20250901</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">2,379</td><td class="metric-value">50</td><td class="metric-value">2,429</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_Fleet001</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">1,473</td><td class="metric-value">50</td><td class="metric-value">1,523</td><td style="font-size: 11px;">ACTIVE_TRANSACTION</td></tr><tr><td>SVDB_Wiley</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">1,259</td><td class="metric-value">50</td><td class="metric-value">1,309</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>SVDB_Copiague</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">942</td><td class="metric-value">63</td><td class="metric-value">1,005</td><td style="font-size: 11px;">ACTIVE_TRANSACTION</td></tr><tr><td>xSVDB_POS_DEV</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">886</td><td class="metric-value">29</td><td class="metric-value">915</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_Westmoreland</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">717</td><td class="metric-value">114</td><td class="metric-value">831</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>SVDB_Westmoreland08112025KEEP</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">717</td><td class="metric-value">50</td><td class="metric-value">767</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">639</td><td class="metric-value">58</td><td class="metric-value">697</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_Coastal</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">558</td><td class="metric-value">50</td><td class="metric-value">609</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>SVDB_CoastalAB</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">558</td><td class="metric-value">50</td><td class="metric-value">609</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>TruckTrack_SBL</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">518</td><td class="metric-value">63</td><td class="metric-value">581</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_SageOak</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">518</td><td class="metric-value">52</td><td class="metric-value">570</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_MoovDS</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">518</td><td class="metric-value">51</td><td class="metric-value">569</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_AffordableCDL</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">518</td><td class="metric-value">50</td><td class="metric-value">568</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>TruckTrack_CMVT</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">518</td><td class="metric-value">50</td><td class="metric-value">568</td><td style="font-size: 11px;">OLDEST_PAGE</td></tr><tr><td>xTruckTrack_SchoolVision</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">320</td><td class="metric-value">26</td><td class="metric-value">346</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_Mellevet</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">62</td><td class="metric-value">324</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_Panda</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">59</td><td class="metric-value">321</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_CheckIn_SchoolVision</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">57</td><td class="metric-value">319</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_RightLane</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">51</td><td class="metric-value">313</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_Moov</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">51</td><td class="metric-value">313</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_Lonestar</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">51</td><td class="metric-value">313</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_Multipurpose</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">31</td><td class="metric-value">293</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_UniqueSL</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">30</td><td class="metric-value">292</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_HammerDown</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">27</td><td class="metric-value">289</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>TruckTrack_RJDevereaux</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">262</td><td class="metric-value">11</td><td class="metric-value">273</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>xTruckTrack_DEV</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">266</td><td class="metric-value">3</td><td class="metric-value">269</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_Badge_Multicard</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">207</td><td class="metric-value">59</td><td class="metric-value">266</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_BadgeDemo</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">207</td><td class="metric-value">11</td><td class="metric-value">218</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>SVDB_Demo_Multicard</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">207</td><td class="metric-value">10</td><td class="metric-value">217</td><td style="font-size: 11px;">NOTHING</td></tr><tr><td>MonitoringDB</td><td>ONLINE</td><td>SIMPLE</td><td class="metric-value">8</td><td class="metric-value">51</td><td class="metric-value">59</td><td style="font-size: 11px;">NOTHING</td></tr></table></div><div class="section">
        <div class="section-header">Recent Error Log Entries (Last 20)</div>
        <table>
            <tr>
                <th>Date/Time (UTC)</th>
                <th>Process</th>
                <th>Message</th>
            </tr><tr><td style="white-space: nowrap;">2025-10-27 20:03:36</td><td>Logon</td><td style="font-size: 11px;">Error: 18456, Severity: 14, State: 8.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 20:03:36</td><td>Logon</td><td style="font-size: 11px;">Login failed for user 'sv'. Reason: Password did not match that for the login provided. [CLIENT: 10.241.128.75]
</td></tr><tr><td style="white-space: nowrap;">2025-10-27 20:00:00</td><td>spid89</td><td style="font-size: 11px;">DBCC TRACEON 1204, server process ID (SPID) 89. This is an informational message only; no user action is required.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 20:00:00</td><td>spid89</td><td style="font-size: 11px;">DBCC TRACEON 1222, server process ID (SPID) 89. This is an informational message only; no user action is required.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:56:03</td><td>Logon</td><td style="font-size: 11px;">Error: 18456, Severity: 14, State: 38.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:56:03</td><td>Logon</td><td style="font-size: 11px;">Login failed for user 'sv'. Reason: Failed to open the explicitly specified database 'dev_svdb_pos'. [CLIENT: 13.64.173.121]</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:56:03</td><td>Logon</td><td style="font-size: 11px;">Error: 18456, Severity: 14, State: 38.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:56:03</td><td>Logon</td><td style="font-size: 11px;">Login failed for user 'sv'. Reason: Failed to open the explicitly specified database 'dev_svdb_pos'. [CLIENT: 13.64.173.121]</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:56:03</td><td>Logon</td><td style="font-size: 11px;">Error: 18456, Severity: 14, State: 38.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:56:03</td><td>Logon</td><td style="font-size: 11px;">Login failed for user 'sv'. Reason: Failed to open the explicitly specified database 'dev_svdb_pos'. [CLIENT: 13.64.173.121]</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:37:10</td><td>Logon</td><td style="font-size: 11px;">Error: 17832, Severity: 20, State: 2.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:37:10</td><td>Logon</td><td style="font-size: 11px;">The login packet used to open the connection is structurally invalid; the connection has been closed. Please contact the vendor of the client library. [CLIENT: 85.208.84.168]</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:02:49</td><td>Logon</td><td style="font-size: 11px;">Error: 18456, Severity: 14, State: 8.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:02:49</td><td>Logon</td><td style="font-size: 11px;">Login failed for user 'sv'. Reason: Password did not match that for the login provided. [CLIENT: 10.241.128.75]</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:02:33</td><td>Logon</td><td style="font-size: 11px;">Error: 18456, Severity: 14, State: 8.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:02:33</td><td>Logon</td><td style="font-size: 11px;">Login failed for user 'sv'. Reason: Password did not match that for the login provided. [CLIENT: 10.241.128.75]</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:00:01</td><td>Backup</td><td style="font-size: 11px;">Error: 3041, Severity: 16, State: 1.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:00:01</td><td>Backup</td><td style="font-size: 11px;">BACKUP failed to complete the command BACKUP DATABASE TruckTrack_SchoolVision. Check the backup application log for detailed messages.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:00:00</td><td>spid80</td><td style="font-size: 11px;">DBCC TRACEON 1204, server process ID (SPID) 80. This is an informational message only; no user action is required.</td></tr><tr><td style="white-space: nowrap;">2025-10-27 19:00:00</td><td>spid80</td><td style="font-size: 11px;">DBCC TRACEON 1222, server process ID (SPID) 80. This is an informational message only; no user action is required.</td></tr></table></div>
    <div class="footer">
        <p>Generated by DBATools.dbo.DBA_DailyHealthOverview_HTML</p>
        <p>SQL Server Health Monitoring System</p>
    </div>
</body>
</html>